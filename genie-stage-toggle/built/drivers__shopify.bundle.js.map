{"version":3,"sources":["webpack:///./src/inject/drivers/base.js","webpack:///./src/inject/drivers/shopify/_base.js","webpack:///./src/inject/drivers/shopify/activerideshop.com.js","webpack:///./src/inject/drivers/shopify/bebe.com.js","webpack:///./src/inject/drivers/shopify/bellamihair.com.js","webpack:///./src/inject/drivers/shopify/bestchoiceproducts.com.js","webpack:///./src/inject/drivers/shopify/bhcosmetics.com.js","webpack:///./src/inject/drivers/shopify/bluemercury.com.js","webpack:///./src/inject/drivers/shopify/bodycandy.com.js","webpack:///./src/inject/drivers/shopify/bombas.com.js","webpack:///./src/inject/drivers/shopify/bpisports.com.js","webpack:///./src/inject/drivers/shopify/brayola.com.js","webpack:///./src/inject/drivers/shopify/bulletproof.com.js","webpack:///./src/inject/drivers/shopify/chubbiesshorts.com.js","webpack:///./src/inject/drivers/shopify/cotopaxi.com.js","webpack:///./src/inject/drivers/shopify/cuddlduds.com.js","webpack:///./src/inject/drivers/shopify/dressbarn.com.js","webpack:///./src/inject/drivers/shopify/edensgarden.com.js","webpack:///./src/inject/drivers/shopify/efavormart.com.js","webpack:///./src/inject/drivers/shopify/eluxury.com.js","webpack:///./src/inject/drivers/shopify/enfamil.com.js","webpack:///./src/inject/drivers/shopify/entertainment.com.js","webpack:///./src/inject/drivers/shopify/fashionnova.com.js","webpack:///./src/inject/drivers/shopify/fit-fresh.com.js","webpack:///./src/inject/drivers/shopify/flattummyco.com.js","webpack:///./src/inject/drivers/shopify/florists.com.js","webpack:///./src/inject/drivers/shopify/gammalabs.net.js","webpack:///./src/inject/drivers/shopify/genuine-people.com.js","webpack:///./src/inject/drivers/shopify/globein.com.js","webpack:///./src/inject/drivers/shopify/inchbug.com.js","webpack:///./src/inject/drivers/shopify/index.js","webpack:///./src/inject/drivers/shopify/juicebeauty.com.js","webpack:///./src/inject/drivers/shopify/lavishalice.com.js","webpack:///./src/inject/drivers/shopify/lillap.com.js","webpack:///./src/inject/drivers/shopify/lootcrate.com.js","webpack:///./src/inject/drivers/shopify/magnolia.com.js","webpack:///./src/inject/drivers/shopify/marika.com.js","webpack:///./src/inject/drivers/shopify/measurabledifference.com.js","webpack:///./src/inject/drivers/shopify/milanicosmetics.com.js","webpack:///./src/inject/drivers/shopify/morphebrushes.com.js","webpack:///./src/inject/drivers/shopify/mvmtwatches.com.js","webpack:///./src/inject/drivers/shopify/myrume.com.js","webpack:///./src/inject/drivers/shopify/outdoorvoices.com.js","webpack:///./src/inject/drivers/shopify/qalo.com.js","webpack:///./src/inject/drivers/shopify/radioshack.com.js","webpack:///./src/inject/drivers/shopify/rebeccaminkoff.com.js","webpack:///./src/inject/drivers/shopify/renskincare.com.js","webpack:///./src/inject/drivers/shopify/roadid.com.js","webpack:///./src/inject/drivers/shopify/shethinx.com.js","webpack:///./src/inject/drivers/shopify/silkn.com.js","webpack:///./src/inject/drivers/shopify/soylent.com.js","webpack:///./src/inject/drivers/shopify/stevemadden.com.js","webpack:///./src/inject/drivers/shopify/tableclothsfactory.com.js","webpack:///./src/inject/drivers/shopify/teefury.com.js","webpack:///./src/inject/drivers/shopify/thecolorrun.com.js","webpack:///./src/inject/drivers/shopify/thefryecompany.com.js","webpack:///./src/inject/drivers/shopify/tonyrobbins.com.js","webpack:///./src/inject/drivers/shopify/untuckit.com.js","webpack:///./src/inject/drivers/shopify/usa.1more.com.js","webpack:///./src/inject/drivers/shopify/uspoloassn.com.js","webpack:///./src/inject/drivers/shopify/vanityplanet.com.js","webpack:///./src/inject/drivers/shopify/violife.com.js","webpack:///./src/inject/drivers/shopify/volcom.com.js","webpack:///./src/inject/drivers/shopify/wetseal.com.js","webpack:///./src/inject/drivers/shopify/wildfox.com.js","webpack:///./src/inject/drivers/shopify/windsorstore.com.js"],"names":["toFloat","format","BaseDriver","watchForRestoreUserData","time","pauseInterval","interval","setInterval","currentState","checkRestoreDataCondition","clearInterval","bus","$emit","e","handleDriverError","source","storeUserData","domain","userData","getUserData","Promise","resolve","userDataKey","getUserDataStorageKey","storageRecord","storedTime","Date","now","backgroundMessaging","setDriverStorage","log","restoreUserData","maxStorageLifetime","driverStorage","getDriverStorage","deleteDriverStorage","setUserData","getStartPrice","startPrice","Number","MAX_SAFE_INTEGER","totalElementConfig","TOTAL_ELEMENT_CONFIG","selector","attribute","regex","totalElement","Array","isArray","forEach","elemSelector","document","querySelector","Error","value","getAttribute","textContent","pattern","group","match","beforeTestCodes","beforeCheckCodes","beforeApplyCodes","checkCodes","applyCodes","stackCodes","removeCodes","getMerchantCodes","getExistingCodes","codes","codeCount","getPreTaxShippingTotal","watchForCartUrl","previousState","checkCondition","completeExperience","completeExperiencePromisified","args","_promisify","beforeTestCodesPromisified","getStartPricePromisified","getMerchantCodesPromisified","getExistingCodesPromisified","removeCodesPromisified","beforeApplyCodesPromisified","applyCodesPromisified","beforeCheckCodesPromisified","checkCodesPromisified","stackCodesPromisified","method","then","apply","extractFormValues","extractFromHTML","extractElement","DOM","ShopifyDriver","constructor","APPLIED_CODE_SELECTOR","TOTAL_SELECTOR","CHECKOUT_TOTAL_SELECTOR_ATTRIBUTE","loadPageDynamic","APPLY_CODE_PARAMETER","REMOVE_CODE_PARAMETER","CODES_INPUT_SELECTOR","FORM_SELECTOR","bodyData","ALL_SHIPPINGS_SELECTOR","SHIPPING_SELECTOR","TAX_SELECTOR","SHIPPING_SECTION_SELECTOR","SHIPPING_METHOD_SELECTOR","getPureTotal","restoreShippingMethod","CHECKOUT_STEP","IS_ON_SHIPPING","_getShippingSelectorIndex","filter","Boolean","map","el","length","_removeCode","responseHTML","_getCartSummary","_parseTotal","originalPrice","each","code","delay","_applyCode","responseText","result","finalPrice","finalDiscount","isValid","_isShippingOptionsElement","checkedShippingElement","querySelectorAll","find","element","checked","shippingSelector","checkedShippingOption","click","total","shipping","tax","extractData","calculatedShipping","toLowerCase","includes","params","set","delete","_manageCode","allShippings","shippingPrices","shippingPriceIndex","indexOf","fetch","window","location","href","credentials","headers","response","text","action","body","data","totalSumm","shippingRateSelector","elemToFloat","Driver","SPINNER_SELECTOR","INPUT_FIELD_SELECTOR","isOnCartUrl","startsWith","inputCodeField","spinnerIsPresent","sessionTimer","initialize","actionInterval","timeout","sendXhr","name","isSinglePageApp","maxCoupons","BASE_URL","isOnRightURL","isCodeInput","resText","TAXES_SELECTOR","LOGGED_IN_USER_SELECTOR","TAXES","checkoutURL","APPLIED_CODES_ARRAY_LENGTH","_getTaxesFromPage","DOMAIN","DISABLE_TIME_MS","isNotMaxCodeTesting","dataExpired","lastTestTimestamp","codeTestingCount","isInput","isOnCheckoutPage","PROMO_PAGE_URL","MERCHANT_CODE_SELECTOR","SPINER","SHIPPING_ERROR_MSG_SELECTOR","totalElem","istotalPrice","isSpiner","shippingErrorMsg","offsetParent","shipppingId","slice","shipppingSelectorBeginning","replace","_getPromoPage","res","isFirefox","browserUtils","TAX_VALUE_SELECTOR","SHIPPING_VALUE_SELECTOR","LOGGED_IN_SELECTOR","INPUT_SELECTOR","appliedCode","loggedInUser","taxValue","isTaxValue","isNaN","shippingValue","isShippingValue","totalValue","setValue","wait","checkoutStep","isOnShipping","isOnInformation","SUMMARY_SELECTOR","APPLY_BUTTON_SELECTOR","REMOVE_DISCOUNT_SELECTOR","CURRENT_STEP_SELECTOR","shippingURL","inputField","html","elem","_applyCodeManually","isCodeApplied","completionAction","completionActions","none","default","DOMAIN_URL","MERCHANT_CODES_SELECTOR","PROMO_CODES_SELECTOR","MERCHANT_CODES_REGEXP","CODE_INPUT_SELECTORS","isTotal","mainPageCode","Set","add","_manuallyApplyCode","status","showDifferentDiscountMessage","PROMO_INPUT","USER_ADDRESS_SELECTOR","CODE_INPUT_SELECTOR","STEP_SELECTOR","isCodeInputEl","contactInfoStep","CONTACT_INFO_FORM_SELECTOR","isRightUrl","codeInput","totalEl","step","dataset","contactForm","toString","SHIPPING_ELEMENT_SELECTOR","SHIPPING_PRICE_SELECTOR","SHIPPING_PRICE","checkouStepElement","requestUrl","split","isShippingMethod","setCookie","getCookie","APPLIED_CODE_REGEX","correctUrl","merchantCode","trim","NEW_URL_FORM_SELECTOR","CHECKOUT_EMAIL_PARAM_SELECTOR","INPUT_DIV_SELECTOR","IS_ON_CONTACT_PAGE","userIsLoggedIn","newStringURLCondition","newStringURL","encodeURI","_newURLForming","_getInputFromDiv","reduce","acc","obj","newObj","append","divElement","Object","keys","key","entries","stringURL","IS_CHECKOUT_PAGE","pathname","DriverShopifyBase","DriverNotBase","URLSearchParams","sessionStorage","ProductInfo","has","getItem","info","JSON","parse","_calculateTotal","error","discountAmount","discount","amount","json","products","item","price","qty","ShippingInfo","SPINNER","setFlag","flag","RegExp","isOnCheckout","isSpinner","_getPage","innerText","size","url","retry","NotTemplateDriver","REQUEST_HEADERS","XPID_REGEX","XPID_REGEX_SELECTOR","COUNTRY_SELECTOR","REQUEST_URL","URL","giftbox_type","searchParams","get","coupon_code","country","is_recurrent","codeElement","responseJSON","_codeAppliedCheck","applyButton","codesInput","message","activerideshop","bebe","bellamihair","bestchoiceproducts","bhcosmetics","bluemercury","bodycandy","bombas","bpisports","brayola","bulletproof","chubbiesshorts","cotopaxi","cuddlduds","dressbarn","edensgarden","efavormart","eluxury","enfamil","entertainment","fashionnova","fitFresh","flattummyco","florists","genuinePeople","gammalabs","globein","inchbug","juicebeauty","lavishalice","lillap","lootcrate","magnolia","marika","measurabledifference","milanicosmetics","morphebrushes","mvmtwatches","myrume","outdoorvoices","qalo","radioshack","rebeccaminkoff","renskincare","roadid","shethinx","silkn","soylent","stevemadden","thecolorrun","tableclothsfactory","teefury","thefryecompany","tonyrobbins","untuckit","uspoloassn","usa1more","vanityplanet","violife","volcom","wetseal","wildfox","windsorstore","origin","_myToFloat","moneyString","cleanString","parseFloat","isOnGiftPage","isOnSecondMerchantVersion","isOnShopifyDriver","API_URL","checkoutDriver","BaseDriverRegular","TOTAL_PRICE_SELECTOR","INPUT_FIELD","APPLY_BTN_SELECTOR","APPLY_CODE_BLOCK","CSRF_TOKEN_REGEX","SESSION_ID_SELECTOR","CART_ID_SELECTOR","GET_TOKEN_REQUEST_URL","SHIPPING_PAGE_SELECTOR","BILLING_PAGE_SELECTOR","BILLING_FORM_ACTIVE_SELECTOR","SHIP_COUNTRY_SELECTOR","SHIP_CITY_SELECTOR","SHIP_STATE_SELECTOR","SHIP_ZIP_SELECTOR","SHIP_ADDRESS_1_SELECTOR","SHIP_ADDRESS_2_SELECTOR","BILLING_COUNTRY_SELECTOR","BILLING_ZIP_SELECTOR","BILLING_VISITED_SELECTOR","FLOW_COUNT","request","setType","requestTypes","embedded","_setSesionStorageItems","setItem","cookieEnabled","navigator","selectedCountry","isUS","CSRF_TOKEN","shippingInfo","_getShippingInfo","CART_ID","session_id","id","_setupAccessToken","scripts","options","plan","addons","currency","expand","plan_name","option_values","codeMatch","requestOptions","accept","authorization","ACCESS_TOKEN","post","stringify","_getAccessToken","token","isBillingPageVisited","billing_address_country","billing_address_zip","shipping_address_country","shipping_address_city","shipping_address_state","shipping_address_zip","shipping_address_line_1","shipping_address_line_2","itemSelectors","total_amount","giftDriver","ZIP_CODE_INPUT_SELECTOR","CODE_INPUT_BTN_SELECTOR","CODE_INPUT_BLOCK","SECTION_PLAN_SELECTOR","CODE_VALIDATION_INFO","codeInputDisplayed","showPopup","PLAN_ID","SHIPPING","plan_id","codeButton","dispatchEvent","Event","disabled","shopifyDriver","BaseDriverShopify","TAX_HIDDEN_SELECTOR","isTaxHidden","IS_SOLD_OUT_SELECTOR","SHIPPING_EL_SELECTOR","stepElement","isSoldOut","isRightStep","currentStorageState","currentTestingCount","totalIsPresent","readyState","currentShippingQuantity","responseShippingQuantity","completeBtn","_checkShipping","MERCHANT_CODE_REGEX","CODE_APPLY_SELECTOR","SHIPPING_EMPTY_SELECTOR","IS_CODE_APPLIED_SELECTOR","pageIsLoaded","toShippingButton","isShippingEmpty","isItemOutOfStock","_manuallyCodeApply","FIELD_SELECTOR","isContact","isFilled","_isFilled","originalInputLength","filledInputLength","promise","validationSupport","OUT_OF_STOCK_SELECTOR","INPUT_CODE_SELECTOR","SHIPPING_RADIO_SELECTOR","SHIPPING_RATE_ATTRIBUTE","addEventListener","reload","capturedShippingPrice","documentLoaded","isOnRightUrl","outOfStockElement","inputCodeElement","selectedShipping","totalWithoutShipping","IS_MANUAL_APPLY","SELECTED_SHIPPING_SELECTOR","ADDRESS_BLOCK","SHIPPING_BLOCK","BILLING_BLOCK","TAX_FIELD","SELECTED_SHIPPING_ID","onRightStep","isTaxOnShipping","classList","contains","usSelected","resHtml","SOLD_OUT_PRODUCT_SELECTOR","STOCK_PRODUCT_SELECTOR","DISCOUNT_REGEX","history","pushState","state","title","MERACHANT_CODE_SELECTOR","RESPONSE_SHIPPING_SELECTOR","MAX_TRY_NUMBER","isOnFirstStep","isOnShippingStep","isOnPaymentStep","isStockProblem","tryNumber","shipSel","SOLD_OUT_SELECTOR","INFORMATION_STEP_SELECTOR","completedOrder","isInformationStep","isShippingStep","isChoosingShipping","isCartEmpty","URL_REGEX","SHIPPING_OPRIONS_ELEMENT_SELECTOR","SHIPPING_OPTIONS_REGEX","isShippingOptions","some","test","replaceState","nextElementSibling","shippingRateElement","isDynamic","FREE_SHIPPING_RESPONSE_SELECTOR","FREE_SHIPPING_PAGE_SELECTOR","freeShippingEl","isFreeShippingInResponse","isFreeShippingOnPage","APPLY_CODE_SELECTOR"],"mappings":"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","file":"drivers__shopify.bundle.js","sourcesContent":["import bus from '../bus';\nimport { log, format } from '../../utils';\nimport { backgroundMessaging, handleDriverError } from '../lib';\n\nconst { toFloat } = format;\n\nexport default class BaseDriver {\n\t/**\n\t * @function watchForRestoreUserData - set up a listener to check user data restorement\n\t * @emits bus#RestoreUserData - the event that indicates to the app\tthat user data could be restored\n\t */\n\twatchForRestoreUserData(time = 500) {\n\t\tlet pauseInterval = false;\n\t\tconst interval = setInterval(async () => {\n\t\t\tif (!pauseInterval) {\n\t\t\t\ttry {\n\t\t\t\t\t// Pause interval to avoid triggering multiple times `checkCondition`\n\t\t\t\t\t// before the response will be received\n\t\t\t\t\tpauseInterval = true;\n\t\t\t\t\tconst currentState = await this.checkRestoreDataCondition();\n\t\t\t\t\tpauseInterval = false;\n\t\t\t\t\tif (currentState) {\n\t\t\t\t\t\tclearInterval(interval);\n\t\t\t\t\t\tbus.$emit('restore-user-data');\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\thandleDriverError(e, { source: 'checkRestoreDataCondition' });\n\t\t\t\t\tclearInterval(interval);\n\t\t\t\t}\n\t\t\t}\n\t\t}, time);\n\n\t\treturn interval;\n\t}\n\n\tcheckRestoreDataCondition() {\n\t\treturn false;\n\t}\n\n\t/**\n\t * @function storeUserData\n\t * @param {String} domain - domain to set the driver storage\n\t * @returns {Promise}\n\t */\n\tasync storeUserData(domain) {\n\t\tconst userData = await this.getUserData();\n\n\t\tif (userData === null) {\n\t\t\t// Nothing to store\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tconst userDataKey = this.getUserDataStorageKey(domain);\n\t\tconst storageRecord = {\n\t\t\tuserData,\n\t\t\tstoredTime: Date.now(),\n\t\t};\n\t\tbackgroundMessaging.setDriverStorage(userDataKey, storageRecord);\n\t\tlog('Stored user data: %O', storageRecord);\n\t\treturn Promise.resolve();\n\t}\n\n\t/**\n\t * @function restoreUserData\n\t * @param {String} domain - domain to access the driver storage\n\t * @param {Number} [maxStorageLifetime] - optional, the lifetime of the stored data (default 10 mins)\n\t * @returns {Promise}\n\t */\n\tasync restoreUserData(domain, maxStorageLifetime = 600000) {\n\t\tconst userDataKey = this.getUserDataStorageKey(domain);\n\t\tconst driverStorage = await backgroundMessaging.getDriverStorage(userDataKey);\n\n\t\tif (driverStorage) {\n\t\t\tconst { storedTime, userData } = driverStorage;\n\t\t\t// Clear stored user data\n\t\t\tbackgroundMessaging.deleteDriverStorage(userDataKey);\n\n\t\t\tif (Date.now() - storedTime <= maxStorageLifetime) {\n\t\t\t\tlog('Restore user data: %O', userData);\n\t\t\t\treturn this.setUserData(userData);\n\t\t\t}\n\t\t\tlog('User data is outdated, skip restoring');\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n\n\t/**\n\t * @function getUserData - get user data which should be stored\n\t * @returns {Object} - object with required user data which should be restored\n\t */\n\tgetUserData() {\n\t\treturn null;\n\t}\n\n\t/**\n\t * @function setUserData - restore user data on page\n\t * @param {Object} userData - data which was saved and should be restored\n\t * @returns {Promise}\n\t */\n\tsetUserData() {\n\t\treturn Promise.resolve();\n\t}\n\n\t/**\n\t * @function getUserDataStorageKey - unique key for storing user data per merchant\n\t * @returns {String}\n\t */\n\tgetUserDataStorageKey(domain) {\n\t\t// Append `_userData` to avoid possible conflicts with created storage from driver\n\t\treturn `${domain}_userData`;\n\t}\n\n\t/**\n\t * Parses start price from page\n\t *\n\t * @function getStartPrice\n\t * @returns {Promise<Number>|Number} - the total from the page\n\t */\n\tgetStartPrice() {\n\t\tlet startPrice = Number.MAX_SAFE_INTEGER;\n\t\tconst totalElementConfig = this.TOTAL_ELEMENT_CONFIG;\n\t\tif (totalElementConfig) {\n\t\t\tconst { selector, attribute, regex } = totalElementConfig;\n\t\t\tlet totalElement;\n\t\t\t// handle case, when there is array of selectors and we try to take totalElement using these selectors in turn\n\t\t\t// for example dell.com, hertz.com\n\t\t\tif (Array.isArray(selector)) {\n\t\t\t\tselector.forEach(elemSelector => {\n\t\t\t\t\tif (!totalElement) {\n\t\t\t\t\t\ttotalElement = document.querySelector(elemSelector);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else if (typeof selector === 'string') {\n\t\t\t\ttotalElement = document.querySelector(selector);\n\t\t\t} else {\n\t\t\t\thandleDriverError(\n\t\t\t\t\tnew Error(`Total selector type mismatch. Expected string | array, got ${typeof selector}`),\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (totalElement) {\n\t\t\t\tlet value = attribute ? totalElement.getAttribute(attribute) : totalElement.textContent;\n\n\t\t\t\tif (value && regex) {\n\t\t\t\t\t// Set pattern to null to receive error in case pattern was not defined\n\t\t\t\t\t// otherwise we may silently return undefined or empty string\n\t\t\t\t\tconst { pattern = null, group = 0 } = regex;\n\t\t\t\t\tvalue = value.match(pattern)[group];\n\t\t\t\t}\n\t\t\t\tstartPrice = toFloat(value);\n\t\t\t}\n\t\t}\n\t\treturn startPrice;\n\t}\n\n\t/**\n\t * Perform any needed actions and setup to start codes testing\n\t *\n\t * @function beforeTestCodes\n\t *\n\t * @returns {Promise}\n\t */\n\tbeforeTestCodes() {\n\t\treturn Promise.resolve();\n\t}\n\n\t/**\n\t * @typedef {Object} OriginalData\n\t * @property {Number} originalPrice the starting price for the cart\n\t * @property {Number} originalItemsCount the starting items count of the cart\n\t */\n\t/**\n\t * Perform any needed actions and setup before `checkCodes()` will be executed\n\t *\n\t * @function beforeCheckCodes\n\t * @param {Number} [originalPrice] - optional, the starting price for the cart\n\t * @param {Number} [originalItemsCount] - optional, the starting items count of the cart\n\t * @returns {Promise.<Number>|Promise.<OriginalData>} - optional, a promise which resolves to the original price of the cart\n\t * \t\t\t\t\t\t\t\t\t\t\t\t\t\tor original data which includes originalItemsCount as well\n\t */\n\tbeforeCheckCodes() {\n\t\treturn Promise.resolve();\n\t}\n\n\t/**\n\t * Perform any needed actions and setup before `applyCodes()` will be executed\n\t *\n\t * @function beforeApplyCodes\n\t * @param {String[]} codes\n\t * @returns {Promise}\n\t */\n\tbeforeApplyCodes() {\n\t\treturn Promise.resolve();\n\t}\n\n\t/**\n\t * @function checkCodes\n\t *\n\t * @param {String[]} codes\n\t * @param {Number} [originalPrice] - optional, the starting price for the cart\n\t * @param {Number} [originalItemsCount] - optional, the starting items count of the cart\n\t * @returns {Promise}\n\t */\n\tcheckCodes() {\n\t\treturn Promise.resolve();\n\t}\n\n\t/**\n\t * Takes each code in @param codes and actually applies it to the cart,\n\t * typically through a fetch(...) call.\n\t *\n\t * @function applyCodes\n\t *\n\t * @param {String[]} codes\n\t * @returns {Promise}\n\t */\n\tapplyCodes() {\n\t\treturn Promise.resolve();\n\t}\n\n\t/**\n\t * @function stackCodes\n\t *\n\t * @param {Object} validationInfo - contains all required info passed by `checkCodes()` for codes stacking\n\t * @param {String[]} validationInfo.codes\n\t * @param {Float} [validationInfo.originalPrice]\n\t * @param {Object[]} [validationInfo.discounts] - contains all codes mapped with their discounts\n\t * @returns {Promise}\n\t */\n\tstackCodes() {\n\t\treturn Promise.resolve();\n\t}\n\n\t/**\n\t * @function removeCodes\n\t *\n\t * @param {String[]} codes - passed in case the driver needs to know specific codes to do removal\n\t * @returns {Promise.<Number>|Promise.<OriginalData>} - optional, a promise which resolves to the original price of the cart\n\t * \t\t\t\t\t\t\t\t\t\t\t\t\t\tor original data which includes originalItemsCount as well\n\t */\n\tremoveCodes() {\n\t\treturn Promise.resolve();\n\t}\n\n\t/**\n\t * Takes codes from merchant page (or request response) which are available and were not applied by user\n\t *\n\t * @function getMerchantCodes\n\t * @returns {String[]} - codes from merhcant page (or request response if possible)\n\t */\n\tgetMerchantCodes() {\n\t\treturn [];\n\t}\n\n\t/**\n\t * Takes codes from merchant page (or request) which are available and were applied by user\n\t *\n\t * @typedef {Object} ExistingCodeInfo\n\t * @prop {String[]} codes - list of codes which had been applied, if discoverable\n\t * @prop {Number} codeCount - the number of codes that were applied to the cart\n\t */\n\t/**\n\t * @function getExistingCodes\n\t * @returns {ExistingCodeInfo}\n\t */\n\tgetExistingCodes() {\n\t\treturn {\n\t\t\tcodes: [],\n\t\t\tcodeCount: 0,\n\t\t};\n\t}\n\n\t/**\n\t * Parses pre tax and shipping total from page or request's response\n\t *\n\t * @function getPreTaxShippingTotal\n\t * @returns {Promise<Number>|Number} - the total without tax and shipping\n\t */\n\tgetPreTaxShippingTotal() {\n\t\treturn null;\n\t}\n\n\t/**\n\t * @function watchForCartUrl - optional function to set up a listener for url changes on SPAs\n\t * @emits bus#CartActive - the event (using the string 'cart-active') that indicates to the app that test codes button should be shown\n\t * @emits bus#CartInactive - the event (using the string 'cart-inactive') that indicates to the app that test codes button should be hidden\n\t */\n\twatchForCartUrl(time = 500) {\n\t\tlet previousState = null;\n\t\tlet pauseInterval = false;\n\n\t\tconst interval = setInterval(async () => {\n\t\t\tif (!pauseInterval) {\n\t\t\t\tlet currentState = null;\n\t\t\t\ttry {\n\t\t\t\t\t// Pause interval to avoid triggering multiple times `checkCondition`\n\t\t\t\t\t// before the response will be received\n\t\t\t\t\tpauseInterval = true;\n\t\t\t\t\tcurrentState = await this.checkCondition();\n\t\t\t\t\tpauseInterval = false;\n\t\t\t\t} catch (e) {\n\t\t\t\t\thandleDriverError(e, { source: 'checkCondition' });\n\t\t\t\t\tclearInterval(interval);\n\t\t\t\t}\n\t\t\t\tif (currentState !== previousState) {\n\t\t\t\t\tbus.$emit(currentState ? 'cart-active' : 'cart-inactive');\n\t\t\t\t}\n\t\t\t\tpreviousState = currentState;\n\t\t\t}\n\t\t}, time);\n\t\t// return the interval to stop it in `watchForCartUrl` if needed from outside\n\t\treturn interval;\n\t}\n\n\t/**\n\t * @function checkCondition - optional function to check for conditions on SPAs\n\t * @returns {Boolean}\n\t */\n\tcheckCondition() {\n\t\treturn false;\n\t}\n\n\t/**\n\t * Perform custom completion action on Continue to Checkout button\n\t * Takes best codes in @param codes\n\t *\n\t * @function completeExperience\n\t *\n\t * @param {String[]} codes\n\t * @returns {Promise}\n\t */\n\tcompleteExperience() {\n\t\treturn Promise.resolve();\n\t}\n\n\t/**\n\t * @function completeExperiencePromisified - promisified wrapper function to guarantee that Promise will be returned (or exception from Promise)\n\t * @returns {Promise}\n\t */\n\tcompleteExperiencePromisified(...args) {\n\t\treturn this._promisify(this.completeExperience, args);\n\t}\n\n\t/**\n\t * @function beforeCodesTestingPromisified - promisified wrapper function to guarantee that Promise will be returned (or exception from Promise)\n\t * @returns {Promise}\n\t */\n\tbeforeTestCodesPromisified(...args) {\n\t\treturn this._promisify(this.beforeTestCodes, args);\n\t}\n\n\t/**\n\t * @function getStartPricePromisified - promisified wrapper function to guarantee that Promise will be returned (or exception from Promise)\n\t * @returns {Promise}\n\t */\n\tgetStartPricePromisified() {\n\t\treturn this._promisify(this.getStartPrice);\n\t}\n\n\t/**\n\t * @function getMerchantCodesPromisified - promisified wrapper function to guarantee that Promise will be returned (or exception from Promise)\n\t * @returns {Promise}\n\t */\n\tgetMerchantCodesPromisified(...args) {\n\t\treturn this._promisify(this.getMerchantCodes, args);\n\t}\n\n\t/**\n\t * @function getExistingCodesPromisified - promisified wrapper function to guarantee that Promise will be returned (or exception from Promise)\n\t * @returns {Promise}\n\t */\n\tgetExistingCodesPromisified(...args) {\n\t\treturn this._promisify(this.getExistingCodes, args);\n\t}\n\n\t/**\n\t * @function removeCodesPromisified - promisified wrapper function to guarantee that Promise will be returned (or exception from Promise)\n\t * @returns {Promise}\n\t */\n\tremoveCodesPromisified(...args) {\n\t\treturn this._promisify(this.removeCodes, args);\n\t}\n\n\t/**\n\t * @function beforeApplyCodesPromisified - promisified wrapper function to guarantee that Promise will be returned (or exception from Promise)\n\t * @returns {Promise}\n\t */\n\tbeforeApplyCodesPromisified(...args) {\n\t\treturn this._promisify(this.beforeApplyCodes, args);\n\t}\n\n\t/**\n\t * @function applyCodesPromisified - promisified wrapper function to guarantee that Promise will be returned (or exception from Promise)\n\t * @returns {Promise}\n\t */\n\tapplyCodesPromisified(...args) {\n\t\treturn this._promisify(this.applyCodes, args);\n\t}\n\n\t/**\n\t * @function beforeCheckCodesPromisified - promisified wrapper function to guarantee that Promise will be returned (or exception from Promise)\n\t * @returns {Promise}\n\t */\n\tbeforeCheckCodesPromisified(...args) {\n\t\treturn this._promisify(this.beforeCheckCodes, args);\n\t}\n\n\t/**\n\t * @function checkCodesPromisified - promisified wrapper function to guarantee that Promise will be returned (or exception from Promise)\n\t * @returns {Promise}\n\t */\n\tcheckCodesPromisified(...args) {\n\t\treturn this._promisify(this.checkCodes, args);\n\t}\n\n\t/**\n\t * @function stackCodesPromisified - promisified wrapper function to guarantee that Promise will be returned (or exception from Promise)\n\t * @returns {Promise}\n\t */\n\tstackCodesPromisified(...args) {\n\t\treturn this._promisify(this.stackCodes, args);\n\t}\n\n\t/**\n\t * @function _promisify - promisifies given method and return it's result as a Promise\n\t * @returns {Promise}\n\t */\n\t_promisify(method, args) {\n\t\treturn Promise.resolve().then(() => method.apply(this, args));\n\t}\n}\n","import Promise from 'bluebird';\nimport BaseDriver from '../base';\nimport bus from '../../bus';\nimport { format, DOM, log } from '../../../utils';\nimport { extractData } from '../../../utils/DOM';\n\nconst { toFloat } = format;\nconst { extractFormValues, extractFromHTML, extractElement } = DOM;\n\n// Behavior description:\n// we can apply only one code\n// we can`t replace a valid code with invalid one\n// we can remove code or we can replace old code with new one\n\nexport default class ShopifyDriver extends BaseDriver {\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.APPLIED_CODE_SELECTOR = '.applied-reduction-code__information, .edit_checkout .reduction-code__text';\n\t\tthis.TOTAL_SELECTOR = '.payment-due__price';\n\t\tthis.CHECKOUT_TOTAL_SELECTOR_ATTRIBUTE = 'data-checkout-total-price';\n\n\t\t// some page elements like shipping or taxes may load dynamically after page loaded\n\t\tthis.loadPageDynamic = false;\n\n\t\t// form body parameters\n\t\tthis.APPLY_CODE_PARAMETER = 'checkout[reduction_code]';\n\t\tthis.REMOVE_CODE_PARAMETER = 'checkout[clear_discount]';\n\n\t\tthis.CODES_INPUT_SELECTOR = '.order-summary__section--discount #checkout_reduction_code';\n\n\t\tthis.FORM_SELECTOR =\n\t\t\t'.order-summary__section--discount form:first-child, .order-summary__section--discount form';\n\t\tthis.bodyData = null;\n\n\t\tthis.ALL_SHIPPINGS_SELECTOR = '.input-radio';\n\n\t\tthis.SHIPPING_SELECTOR = '.total-line--shipping span';\n\t\tthis.TAX_SELECTOR = '.total-line--taxes span';\n\n\t\tthis.SHIPPING_SECTION_SELECTOR = '.section--shipping-method';\n\t\tthis.SHIPPING_METHOD_SELECTOR = '.section--shipping-method .input-radio';\n\n\t\tthis.getPureTotal = false;\n\n\t\tthis.restoreShippingMethod = false;\n\t}\n\n\tcheckRestoreDataCondition() {\n\t\treturn this.restoreShippingMethod && document.querySelector(this.SHIPPING_METHOD_SELECTOR);\n\t}\n\n\t// Base Driver methods\n\tbeforeTestCodes() {\n\t\tif (!this.bodyData) {\n\t\t\tthis.bodyData = extractFormValues(this.FORM_SELECTOR);\n\t\t}\n\t\tthis.CHECKOUT_STEP = document.querySelector('.step');\n\t\tthis.IS_ON_SHIPPING = this.CHECKOUT_STEP\n\t\t\t? this.CHECKOUT_STEP.getAttribute('data-step') === 'shipping_method'\n\t\t\t: false;\n\t\tthis._getShippingSelectorIndex();\n\t\treturn Promise.resolve();\n\t}\n\n\tgetExistingCodes() {\n\t\tconst codes = [document.querySelector(this.APPLIED_CODE_SELECTOR)].filter(Boolean).map(el => el.textContent);\n\n\t\treturn {\n\t\t\tcodes,\n\t\t\tcodeCount: codes.length,\n\t\t};\n\t}\n\n\tremoveCodes() {\n\t\treturn this._removeCode()\n\t\t\t.then(responseHTML => (this.loadPageDynamic ? this._getCartSummary() : responseHTML))\n\t\t\t.then(responseHTML => this._parseTotal(responseHTML));\n\t}\n\n\tcheckCodes(codes, originalPrice = this._parseTotal()) {\n\t\tlog(`Original price: ${originalPrice}`);\n\t\treturn Promise.each(codes, code => {\n\t\t\t// we need to add this delay, sue to shopify API rate limits\n\t\t\treturn Promise.delay(4000).then(() => {\n\t\t\t\treturn this._applyCode(code)\n\t\t\t\t\t.then(responseHTML => (this.loadPageDynamic ? this._getCartSummary() : responseHTML))\n\t\t\t\t\t.then(responseText => {\n\t\t\t\t\t\tconst result = {\n\t\t\t\t\t\t\tcode,\n\t\t\t\t\t\t\tfinalPrice: originalPrice,\n\t\t\t\t\t\t\tfinalDiscount: 0,\n\t\t\t\t\t\t\tisValid: false,\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tif (extractElement(this.APPLIED_CODE_SELECTOR, responseText)) {\n\t\t\t\t\t\t\tresult.finalPrice = this._parseTotal(responseText);\n\t\t\t\t\t\t\tresult.finalDiscount = originalPrice - result.finalPrice;\n\t\t\t\t\t\t\tresult.isValid = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn this._removeCode().then(() => bus.$emit('code-checked', result));\n\t\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tapplyCodes(codes) {\n\t\treturn this._applyCode(codes[0]);\n\t}\n\n\tgetUserData() {\n\t\tif (this._isShippingOptionsElement() && this.restoreShippingMethod) {\n\t\t\tconst checkedShippingElement = [...document.querySelectorAll(this.SHIPPING_METHOD_SELECTOR)].find(\n\t\t\t\telement => element.checked,\n\t\t\t);\n\n\t\t\treturn {\n\t\t\t\tshippingSelector: checkedShippingElement.getAttribute('id'),\n\t\t\t};\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tsetUserData(userData) {\n\t\tconst checkedShippingOption = document.querySelector(`#${userData.shippingSelector}`);\n\t\tif (checkedShippingOption) {\n\t\t\tcheckedShippingOption.click();\n\t\t}\n\t}\n\n\tgetPreTaxShippingTotal() {\n\t\treturn this.getPureTotal\n\t\t\t? this._getCartSummary().then(responseHTML => {\n\t\t\t\t\tconst total = this._parseTotal(responseHTML);\n\t\t\t\t\t// we should take shipping from the page because after reloading page will be selected saved shipping\n\t\t\t\t\tconst shipping = document.querySelector(this.SHIPPING_SELECTOR) || 0;\n\t\t\t\t\t// if tax will not be a number - set tax as 0\n\t\t\t\t\tconst tax = toFloat(extractData(this.TAX_SELECTOR, responseHTML)) || 0;\n\t\t\t\t\tlet calculatedShipping = 0;\n\t\t\t\t\tif (shipping) {\n\t\t\t\t\t\tcalculatedShipping =\n\t\t\t\t\t\t\tshipping.textContent.toLowerCase().includes('free') ||\n\t\t\t\t\t\t\tshipping.textContent.toLowerCase().includes('calculated at next step')\n\t\t\t\t\t\t\t\t? 0\n\t\t\t\t\t\t\t\t: shipping.textContent;\n\t\t\t\t\t}\n\t\t\t\t\treturn total - toFloat(calculatedShipping) - tax;\n\t\t\t  })\n\t\t\t: null;\n\t}\n\n\t// Shopify Driver methods\n\t_applyCode(code) {\n\t\tthis.bodyData.params.set(this.APPLY_CODE_PARAMETER, code);\n\t\tthis.bodyData.params.delete(this.REMOVE_CODE_PARAMETER); // it is important, without it we can`t send right request\n\t\treturn this._manageCode();\n\t}\n\n\t_getShippingSelectorIndex() {\n\t\tconst allShippings = [...document.querySelectorAll(this.ALL_SHIPPINGS_SELECTOR)];\n\t\tconst shippingPrices = allShippings.map(shipping => shipping.checked);\n\t\tif (!this.shippingPriceIndex) {\n\t\t\t// when we reload page shipping becomes the default position, so we must save position that user choose\n\t\t\tthis.shippingPriceIndex = shippingPrices.indexOf(true);\n\t\t} else if (this.shippingPriceIndex !== shippingPrices.indexOf(true)) {\n\t\t\tthis.shippingPriceIndex = shippingPrices.indexOf(true);\n\t\t}\n\t\treturn this.shippingPriceIndex;\n\t}\n\n\t_isShippingOptionsElement() {\n\t\treturn document.querySelector(this.SHIPPING_SECTION_SELECTOR);\n\t}\n\n\t_getCartSummary() {\n\t\treturn fetch(window.location.href, {\n\t\t\tmethod: 'GET',\n\t\t\tcredentials: 'include',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\n\t\t\t},\n\t\t}).then(response => response.text());\n\t}\n\n\t_manageCode() {\n\t\treturn fetch(this.bodyData.action, {\n\t\t\tmethod: 'POST',\n\t\t\tcredentials: 'include',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\n\t\t\t},\n\t\t\tbody: this.bodyData.params,\n\t\t}).then(response => response.text());\n\t}\n\n\t_parseTotal(data) {\n\t\tlet totalSumm = null;\n\t\tif (this.IS_ON_SHIPPING) {\n\t\t\tconst shippingRateSelector = `.content-box__row:nth-of-type(${this.shippingPriceIndex + 1}) .input-radio`;\n\t\t\ttotalSumm = data\n\t\t\t\t? extractFromHTML(data, shippingRateSelector, null, this.CHECKOUT_TOTAL_SELECTOR_ATTRIBUTE)\n\t\t\t\t: document.querySelector(shippingRateSelector).getAttribute(this.CHECKOUT_TOTAL_SELECTOR_ATTRIBUTE);\n\t\t} else {\n\t\t\ttotalSumm = data\n\t\t\t\t? extractFromHTML(data, this.TOTAL_SELECTOR)\n\t\t\t\t: document.querySelector(this.TOTAL_SELECTOR).textContent;\n\t\t}\n\t\treturn toFloat(totalSumm);\n\t}\n\n\t_removeCode() {\n\t\tthis.bodyData.params.set(this.REMOVE_CODE_PARAMETER, '1');\n\t\tthis.bodyData.params.delete(this.APPLY_CODE_PARAMETER);\n\t\treturn this._manageCode();\n\t}\n}\n","import Promise from 'bluebird';\nimport ShopifyDriver from './_base';\nimport { DOM, sendXhr, format } from '../../../utils';\nimport { sessionTimer } from '../../lib';\n\nconst { extractFormValues, extractElement } = DOM;\nconst { elemToFloat } = format;\n\n// Driver behaviour description:\n// •    Existing code: yes\n// •    Remove code: yes\n// •    Stackable: no\n// •    Free gift support: no\n// •    'isValid' implemented: yes\n// •     Codes can be replaced by another code: yes\n// sessionTimer 15 min\n// maxCoupons: 4 due to `Total test time`\n\n// On the shipping page, we can not get the original price with the delivery price included.\n// Since the delivery block loads later and does not arrive in the response to a request.\n// On this site there are no discounts on delivery and the discount is always static\n// (regardless of the selected delivery, the amount of discounts does not change), so we will\n// take the original price with the delivery, which is chosen by default. The discount will be\n// calculated correctly, but the original price will be different from that on the page.\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\t// some page elements like shipping or taxes may load dynamically after page loaded\n\t\tthis.loadPageDynamic = true;\n\n\t\tthis.FORM_SELECTOR = '.order-summary__section--discount form:last-child';\n\t\tthis.SPINNER_SELECTOR = '.section--shipping-method .content-box svg';\n\t\tthis.INPUT_FIELD_SELECTOR = '#checkout_reduction_code';\n\t}\n\n\tcheckCondition() {\n\t\tconst { href } = window.location;\n\t\tconst isOnCartUrl = href.startsWith('https://www.activerideshop.com/') && href.includes('/checkouts/');\n\t\tconst inputCodeField = document.querySelector(this.INPUT_FIELD_SELECTOR);\n\t\tconst spinnerIsPresent = document.querySelector(this.SPINNER_SELECTOR);\n\t\tconst currentState = isOnCartUrl && inputCodeField && !spinnerIsPresent;\n\n\t\treturn currentState;\n\t}\n\n\twatchForCartUrl() {\n\t\tconst interval = super.watchForCartUrl();\n\n\t\tsessionTimer.initialize({\n\t\t\tactionInterval: interval,\n\t\t\ttimeout: 15,\n\t\t});\n\t}\n\n\tbeforeTestCodes() {\n\t\tif (!this.bodyData) {\n\t\t\tthis.bodyData = extractFormValues(this.FORM_SELECTOR);\n\t\t}\n\t\tthis.bodyData.params.delete('checkout[client_details][browser_height]');\n\t\tthis.bodyData.params.delete('checkout[client_details][browser_width]');\n\t\tthis.bodyData.params.delete('checkout[client_details][javascript_enabled]');\n\t\tthis.CHECKOUT_STEP = document.querySelector('.step');\n\t\tthis.IS_ON_SHIPPING = this.CHECKOUT_STEP\n\t\t\t? this.CHECKOUT_STEP.getAttribute('data-step') === 'shipping_method'\n\t\t\t: false;\n\t\tthis._getShippingSelectorIndex();\n\t\treturn Promise.resolve();\n\t}\n\n\tbeforeCheckCodes() {\n\t\treturn this._getCartSummary().then(responseHTML => this._parseTotal(responseHTML));\n\t}\n\n\t_manageCode() {\n\t\treturn sendXhr(this.bodyData.action, {\n\t\t\tmethod: 'POST',\n\t\t\tcredentials: 'include',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\n\t\t\t\t'x-requested-with': 'XMLHttpRequest',\n\t\t\t},\n\t\t\tbody: this.bodyData.params,\n\t\t}).then(response => response.text());\n\t}\n\n\t_parseTotal(data) {\n\t\treturn elemToFloat(extractElement(this.TOTAL_SELECTOR, data));\n\t}\n};\n\nexport default {\n\tname: 'Active Ride Shop',\n\tdomain: 'activerideshop.com',\n\tisSinglePageApp: true,\n\tDriver,\n\tmaxCoupons: 4, // due to `Total test time`\n};\n","import ShopifyDriver from './_base';\nimport { format, DOM } from '../../../utils';\n\nconst { extractElement } = DOM;\nconst { elemToFloat } = format;\n/* Behavior description:\n+ Existing code: yes\n+ Remove code: yes\n+ Stackable: no\n+ Free gift support: no\n+ Free shipping: no\n+ ‘isValid’ implemented: yes\n+ Codes can be replaced by another code: no\n+ Pages, where extension works: Checkout\n+ Is driver SPA: yes\n+ Gather codes on site pages: no\n*/\nconst BASE_URL = 'https://www.bebe.com/';\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.APPLIED_CODE_SELECTOR = '.order-summary__section--discount .reduction-code__text';\n\n\t\tthis.restoreShippingMethod = true;\n\t}\n\n\tcheckCondition() {\n\t\tconst { href } = window.location;\n\n\t\tconst isOnRightURL =\n\t\t\thref.startsWith(BASE_URL) && href.includes('/checkouts/') && !href.includes('stock_problems');\n\t\tconst isCodeInput = document.querySelector(this.CODES_INPUT_SELECTOR);\n\n\t\treturn isOnRightURL && isCodeInput;\n\t}\n\n\tgetPreTaxShippingTotal() {\n\t\treturn fetch(this.bodyData.action, {\n\t\t\tmethod: 'POST',\n\t\t\tcredentials: 'include',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\n\t\t\t},\n\t\t\tbody: this.bodyData.params,\n\t\t})\n\t\t\t.then(response => response.text())\n\t\t\t.then(resText => {\n\t\t\t\tconst total = elemToFloat(extractElement(this.TOTAL_SELECTOR, resText));\n\t\t\t\tconst shipping =\n\t\t\t\t\telemToFloat(extractElement('.total-line--shipping > .total-line__price > span', resText)) || 0;\n\t\t\t\tconst tax = elemToFloat(extractElement('.total-line--taxes > .total-line__price > span', resText)) || 0;\n\t\t\t\treturn total - shipping - tax;\n\t\t\t});\n\t}\n};\n\nexport default {\n\tname: 'Bebe',\n\tdomain: 'bebe.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisSinglePageApp: true,\n\trestoreUserData: true,\n};\n","import ShopifyDriver from './_base';\nimport { format, DOM } from '../../../utils';\nimport { sessionTimer } from '../../lib';\n\nconst { toFloat } = format;\nconst { extractFromHTML, extractElement } = DOM;\n\n/** Behavior description:\n * We can apply only one code\n * We can get existing code\n * We can remove existing code\n * sessionTimer 15 min\n * */\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.TAXES_SELECTOR = '.total-line--taxes span';\n\t\tthis.LOGGED_IN_USER_SELECTOR = '.logged-in-customer-information';\n\t\tthis.TAXES = 0;\n\t}\n\n\tcheckCondition() {\n\t\tconst { href } = window.location;\n\n\t\tconst checkoutURL =\n\t\t\thref.startsWith('https://www.bellamihair.com/') &&\n\t\t\thref.includes('/checkouts/') &&\n\t\t\t!href.includes('stock_problems');\n\n\t\treturn checkoutURL;\n\t}\n\n\twatchForCartUrl() {\n\t\tconst interval = super.watchForCartUrl();\n\n\t\tsessionTimer.initialize({\n\t\t\tactionInterval: interval,\n\t\t\ttimeout: 15,\n\t\t});\n\t}\n\n\tgetExistingCodes() {\n\t\tconst codes = [document.querySelector(this.APPLIED_CODE_SELECTOR)].filter(Boolean).map(el => el.textContent);\n\t\tthis.APPLIED_CODES_ARRAY_LENGTH = codes.length;\n\t\treturn {\n\t\t\tcodes,\n\t\t\tcodeCount: this.APPLIED_CODES_ARRAY_LENGTH,\n\t\t};\n\t}\n\n\t_parseTotal(data) {\n\t\tlet totalSumm = null;\n\t\tif (this.IS_ON_SHIPPING) {\n\t\t\tconst shippingPriceIndex = this._getShippingSelectorIndex();\n\t\t\tconst shippingRateSelector = `.content-box__row:nth-of-type(${shippingPriceIndex + 1}) .input-radio`;\n\t\t\ttotalSumm = data\n\t\t\t\t? extractFromHTML(data, shippingRateSelector, null, this.CHECKOUT_TOTAL_SELECTOR_ATTRIBUTE)\n\t\t\t\t: document.querySelector(shippingRateSelector).getAttribute(this.CHECKOUT_TOTAL_SELECTOR_ATTRIBUTE);\n\t\t} else {\n\t\t\tthis.TAXES = this._getTaxesFromPage(data);\n\t\t\ttotalSumm = data\n\t\t\t\t? extractFromHTML(data, this.TOTAL_SELECTOR)\n\t\t\t\t: document.querySelector(this.TOTAL_SELECTOR).textContent;\n\t\t}\n\t\treturn toFloat(totalSumm) - this.TAXES;\n\t}\n\n\t_getTaxesFromPage(data) {\n\t\tif (extractElement(this.LOGGED_IN_USER_SELECTOR, data)) {\n\t\t\treturn this.APPLIED_CODES_ARRAY_LENGTH === 0\n\t\t\t\t? toFloat(\n\t\t\t\t\t\textractElement(this.TAXES_SELECTOR, data).getAttribute('data-checkout-total-taxes-target') /\n\t\t\t\t\t\t\t100,\n\t\t\t\t  )\n\t\t\t\t: 0;\n\t\t}\n\t\treturn 0;\n\t}\n};\n\nexport default {\n\tname: 'BellamiHair',\n\tdomain: 'bellamihair.com',\n\tDriver,\n\tmaxCoupons: 8,\n\tisSinglePageApp: true,\n};\n","import ShopifyDriver from './_base';\nimport { sessionTimer, backgroundMessaging } from '../../lib';\n\nconst DOMAIN = 'https://bestchoiceproducts.com';\n\n/* Driver behaviour description:\n    - Existing code: yes\n    - Remove code: yes\n    - Stackable: no\n    - Free gift support: no\n    - Free shipping: no\n    - Price increase: yes\n    - 'isValid' implemented: yes\n    - Replace code: yes\n====Special cases====\n    - sessionTimer - 15 min\n    - test only 7 codes, site works slow\n    - we may din code testing 2 times per 30 min(due to blicking)\n*/\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.TOTAL_ELEMENT_CONFIG = {\n\t\t\tselector: this.TOTAL_SELECTOR,\n\t\t};\n\t\tthis.loadPageDynamic = true;\n\t\tthis.getPureTotal = true;\n\t\tthis.restoreShippingMethod = true;\n\t\tthis.DISABLE_TIME_MS = 30 * 60 * 1000; // 30 minutes\n\t\tsessionTimer.initialize();\n\t}\n\n\tasync checkCondition() {\n\t\tlet isNotMaxCodeTesting = true;\n\t\tconst driverStorage = await backgroundMessaging.getDriverStorage(DOMAIN);\n\t\tif (driverStorage) {\n\t\t\tconst dataExpired = Date.now() - driverStorage.lastTestTimestamp >= this.DISABLE_TIME_MS;\n\t\t\tif (dataExpired) {\n\t\t\t\tbackgroundMessaging.deleteDriverStorage(DOMAIN);\n\t\t\t} else {\n\t\t\t\tisNotMaxCodeTesting = driverStorage.codeTestingCount < 2;\n\t\t\t}\n\t\t}\n\t\tconst { href } = window.location;\n\t\tconst isInput = document.querySelector(this.CODES_INPUT_SELECTOR);\n\t\tconst isOnCheckoutPage =\n\t\t\thref.startsWith(DOMAIN) && href.includes('/checkouts/') && !href.includes('stock_problems');\n\t\treturn isOnCheckoutPage && isInput && isNotMaxCodeTesting;\n\t}\n\n\tasync beforeApplyCodes() {\n\t\tconst driverStorage = await backgroundMessaging.getDriverStorage(DOMAIN);\n\t\tconst codeTestingCount = driverStorage ? driverStorage.codeTestingCount : 0;\n\t\tbackgroundMessaging.setDriverStorage(DOMAIN, {\n\t\t\tcodeTestingCount: codeTestingCount + 1,\n\t\t\tlastTestTimestamp: Date.now(),\n\t\t});\n\t}\n};\n\nexport default {\n\tname: 'Best Choise Product',\n\tdomain: 'bestchoiceproducts.com',\n\tDriver,\n\tmaxCoupons: 7, // site works slow\n\tisSinglePageApp: true,\n};\n","import ShopifyDriver from './_base';\nimport { sessionTimer } from '../../lib';\nimport { format, DOM } from '../../../utils';\n\nconst { elemToFloat } = format;\nconst { extractElement } = DOM;\n\n/*\nBehavior description:\n+ Existing code: yes\n+ Remove code: yes\n+ Stackable: no\n+ Free gift support: no\n+ Free shipping: no\n+ ‘isValid’ implemented: yes\n+ Codes can be replaced by another code: yes\n+ Manually apply code: no\n+ Pages, where extension works: Checkout, don't support Shipping page if there is error msg\n+ Is driver SPA: yes\n+ Gather codes on site pages: yes, from promo page https://www.bhcosmetics.com/pages/offers-promotions\n+ maxCoupons: 8, due to `Total test time`\n+ sessionTimer - 15 min\n*/\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.APPLIED_CODE_SELECTOR = '.total-line-table .reduction-code__text';\n\t\tthis.BASE_URL = 'https://www.bhcosmetics.com';\n\t\tthis.PROMO_PAGE_URL = `${this.BASE_URL}/pages/offers-promotions`;\n\t\tthis.MERCHANT_CODE_SELECTOR = '.offer__bottom__promo-code';\n\t\t// some page elements like shipping or taxes may load dynamically after page loaded\n\t\tthis.loadPageDynamic = true;\n\t\tthis.SPINER = '.full-page-overlay';\n\t\tthis.SHIPPING_ERROR_MSG_SELECTOR = '[data-shipping-warning]';\n\n\t\tthis.getPureTotal = true;\n\t\tthis.restoreShippingMethod = true;\n\t}\n\n\twatchForCartUrl() {\n\t\tconst interval = super.watchForCartUrl();\n\n\t\tsessionTimer.initialize({\n\t\t\tactionInterval: interval,\n\t\t\ttimeout: 15,\n\t\t});\n\t}\n\n\tcheckCondition() {\n\t\tconst { href } = window.location;\n\t\tconst checkoutURL =\n\t\t\thref.startsWith(this.BASE_URL) && href.includes('/checkouts/') && !href.includes('stock_problems');\n\t\tconst totalElem = document.querySelector(this.TOTAL_SELECTOR);\n\t\tconst istotalPrice = totalElem ? elemToFloat(totalElem) !== 0 : false;\n\t\tconst isSpiner = document.querySelector(this.SPINER);\n\t\tconst shippingErrorMsg = (document.querySelector(this.SHIPPING_ERROR_MSG_SELECTOR) || {}).offsetParent;\n\n\t\treturn checkoutURL && istotalPrice && !isSpiner && !shippingErrorMsg;\n\t}\n\n\tsetUserData(userData) {\n\t\t// in this case we do request on cart url and ending of id of the element is changed after every request\n\t\tconst shipppingId = userData.shippingSelector.slice(-30);\n\t\tconst shipppingSelectorBeginning = userData.shippingSelector.replace(shipppingId, '');\n\t\tconst checkedShippingOption =\n\t\t\tdocument.querySelector(`#${userData.shippingSelector}`) ||\n\t\t\tdocument.querySelector(`[id^=${shipppingSelectorBeginning}]`);\n\n\t\tif (checkedShippingOption) {\n\t\t\tcheckedShippingOption.click();\n\t\t}\n\t}\n\n\tgetMerchantCodes() {\n\t\treturn this._getPromoPage().then(response =>\n\t\t\t[...extractElement(this.MERCHANT_CODE_SELECTOR, response, true)]\n\t\t\t\t.filter(el => el.textContent.match(/use code\\s?(\\w+)/i))\n\t\t\t\t.map(el => el.textContent.match(/use code\\s?(\\w+)/i)[1]),\n\t\t);\n\t}\n\n\t_getPromoPage() {\n\t\treturn fetch(this.PROMO_PAGE_URL, {\n\t\t\tmethod: 'GET',\n\t\t\tcredentials: 'include',\n\t\t}).then(res => res.text());\n\t}\n};\n\nexport default {\n\tname: 'BH Cosmetics',\n\tdomain: 'bhcosmetics.com',\n\tisSinglePageApp: true,\n\tDriver,\n\trestoreUserData: true,\n\tmaxCoupons: 8, // due to `Total test time`\n};\n","/*    eslint class-methods-use-this: [\"error\", { \"exceptMethods\": [\"checkCondition\"] }] */\nimport Promise from 'bluebird';\nimport ShopifyDriver from './_base';\nimport bus from '../../bus';\n\nimport { sessionTimer } from '../../lib';\n\nimport { format, DOM, browserUtils, log } from '../../../utils';\n\nconst { elemToFloat } = format;\nconst { extractElement } = DOM;\nconst { isFirefox } = browserUtils;\n\n/*\nDriver behaviour description:\n•    Existing code: yes\n•    Remove code: yes\n•    Stackable: no\n•    Free gift support: no\n•    'isValid' implemented: yes\n•     Codes can be replaced by another code: yes\n•    Is driver SPA and add the condition to show popup: yes\n\tApply codes only after user clicks on the 'Continue to checkout' on the popup\n\tRun codes is allowed only on payment page\n\tsessionTimer 15 min\n\tmaxCoupons: 8, // due to low performance\n*/\n\nconst DOMAIN = 'https://bluemercury.com';\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\t// some page elements like shipping or taxes may load dynamically after page loaded\n\t\tthis.loadPageDynamic = true;\n\t\tthis.APPLIED_CODE_SELECTOR = '.edit_checkout .reduction-code .reduction-code__text';\n\n\t\tthis.TAX_VALUE_SELECTOR = '[data-checkout-total-taxes-target], .total-line--taxes .order-summary__emphasis';\n\t\tthis.SHIPPING_VALUE_SELECTOR = '.total-line--shipping .total-line__price';\n\n\t\tthis.LOGGED_IN_SELECTOR = '.logged-in-customer-information';\n\t\tthis.INPUT_SELECTOR = '#checkout_reduction_code';\n\t}\n\n\tbeforeCheckCodes() {\n\t\tthis.appliedCode = this.getExistingCodes();\n\t\tthis.loggedInUser = document.querySelector(this.LOGGED_IN_SELECTOR);\n\t\treturn Promise.resolve();\n\t}\n\n\tcheckCondition() {\n\t\tconst isInput = document.querySelector(this.INPUT_SELECTOR);\n\t\tconst isOnCheckoutPage =\n\t\t\twindow.location.href.startsWith(DOMAIN) &&\n\t\t\twindow.location.href.includes('/checkouts/') &&\n\t\t\t!window.location.href.includes('stock_problems');\n\t\treturn isOnCheckoutPage && isInput;\n\t}\n\n\twatchForCartUrl() {\n\t\tconst interval = super.watchForCartUrl();\n\n\t\tsessionTimer.initialize({\n\t\t\tactionInterval: interval,\n\t\t\ttimeout: 15,\n\t\t});\n\t}\n\n\tcheckCodes(codes, originalPrice = this._parseTotal()) {\n\t\tlog(`Original price: ${originalPrice}`);\n\t\treturn Promise.each(codes, code =>\n\t\t\tthis._applyCode(code)\n\t\t\t\t.then(responseHTML => (this.loadPageDynamic ? this._getCartSummary() : responseHTML))\n\t\t\t\t.then(responseText => {\n\t\t\t\t\tconst result = {\n\t\t\t\t\t\tcode,\n\t\t\t\t\t\tfinalPrice: originalPrice,\n\t\t\t\t\t\tfinalDiscount: 0,\n\t\t\t\t\t\tisValid: false,\n\t\t\t\t\t};\n\n\t\t\t\t\tif (extractElement(this.APPLIED_CODE_SELECTOR, responseText)) {\n\t\t\t\t\t\tresult.finalPrice = this._parseTotal(responseText);\n\t\t\t\t\t\tresult.finalDiscount = originalPrice - result.finalPrice;\n\t\t\t\t\t\tif (isFirefox() && !this.appliedCode.codes.length && this.loggedInUser) {\n\t\t\t\t\t\t\tresult.finalDiscount -= extractElement(this.TAX_VALUE_SELECTOR)\n\t\t\t\t\t\t\t\t? elemToFloat(extractElement(this.TAX_VALUE_SELECTOR))\n\t\t\t\t\t\t\t\t: 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresult.isValid = true;\n\t\t\t\t\t}\n\t\t\t\t\treturn this._removeCode().then(() => bus.$emit('code-checked', result));\n\t\t\t\t}),\n\t\t);\n\t}\n\n\tgetPreTaxShippingTotal() {\n\t\treturn this._getCartSummary().then(responseHTML => {\n\t\t\tconst taxValue = elemToFloat(extractElement(this.TAX_VALUE_SELECTOR, responseHTML));\n\t\t\tconst isTaxValue = Number.isNaN(taxValue) ? 0 : taxValue;\n\t\t\tconst shippingValue = elemToFloat(extractElement(this.SHIPPING_VALUE_SELECTOR, responseHTML));\n\t\t\tconst isShippingValue = Number.isNaN(shippingValue) ? 0 : shippingValue;\n\t\t\tconst totalValue = this._parseTotal(responseHTML);\n\t\t\treturn totalValue - isTaxValue - isShippingValue;\n\t\t});\n\t}\n};\n\nexport default {\n\tname: 'Blue Mercury',\n\tdomain: 'bluemercury.com',\n\tmaxCoupons: 8, // due to low performance\n\tisSinglePageApp: true,\n\tDriver,\n};\n","import ShopifyDriver from './_base';\nimport { format, DOM, browserUtils, completionActions } from '../../../utils';\nimport { sessionTimer } from '../../lib';\nimport backgroundMessaging from '../../lib/background-messaging';\n\nconst { toFloat } = format;\nconst { extractData, extractElement, setValue } = DOM;\nconst { wait } = browserUtils;\n\n/* Driver behaviour description:\n•    Existing code: yes\n•    Remove code: yes\n•    Stackable: no\n•    Free gift support: no\n•    'isValid' implemented: no\n•     Codes can be replaced by another code: yes\n•     Manually apply code: yes, on checkout(contact information)\nsessionTimer - 15 min\ntest only 8 codes due to slow site \n======= Special case =======\nremoved support from the second step of the checkout because of incorrect total\nadded blocking testing due to blocking user by website if testing code more then 4 times\n*/\n\nconst DOMAIN = 'bodycandy.com';\n\nconst checkoutStep = () => document.querySelector('.step');\nconst isOnShipping = () => checkoutStep() && checkoutStep().getAttribute('data-step') === 'shipping_method';\nconst isOnInformation = () => checkoutStep() && checkoutStep().getAttribute('data-step') === 'contact_information';\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.BASE_URL = `https://www.${DOMAIN}`;\n\t\tthis.SUMMARY_SELECTOR = '.order-summary__section--discount';\n\t\tthis.APPLY_BUTTON_SELECTOR = `${this.SUMMARY_SELECTOR} button`;\n\t\tthis.REMOVE_DISCOUNT_SELECTOR = '#checkout_clear_discount';\n\t\tthis.SPINNER_SELECTOR = '.full-page-overlay';\n\t\tthis.CODES_INPUT_SELECTOR = '.order-summary__section--discount #checkout_reduction_code';\n\t\tthis.MERCHANT_CODE_SELECTOR = 'table [color=\"#990033\"]';\n\t\tthis.CURRENT_STEP_SELECTOR = '[aria-current=\"step\"]';\n\t\tthis.DISABLE_TIME_MS = 20 * 60 * 1000; // 20 minutes\n\t}\n\n\tasync checkCondition() {\n\t\tlet isNotMaxCodeTesting = true;\n\t\tconst driverStorage = await backgroundMessaging.getDriverStorage(DOMAIN);\n\t\tif (driverStorage) {\n\t\t\tconst dataExpired = Date.now() - driverStorage.lastTestTimestamp >= this.DISABLE_TIME_MS;\n\t\t\tif (dataExpired) {\n\t\t\t\tbackgroundMessaging.deleteDriverStorage(DOMAIN);\n\t\t\t} else {\n\t\t\t\tisNotMaxCodeTesting = driverStorage.codeTestingCount < 4;\n\t\t\t}\n\t\t}\n\t\tconst { href } = window.location;\n\t\tconst shippingURL = isOnShipping();\n\t\tconst spinnerIsPresent = document.querySelector(this.SPINNER_SELECTOR);\n\t\tconst inputField = document.querySelector(this.CODES_INPUT_SELECTOR);\n\t\tconst checkoutURL = href.startsWith(this.BASE_URL) && href.includes('/checkouts/');\n\n\t\treturn !spinnerIsPresent && checkoutURL && !shippingURL && inputField && isNotMaxCodeTesting;\n\t}\n\n\tgetMerchantCodes() {\n\t\treturn fetch(`${this.BASE_URL}/pages/coupon`, {\n\t\t\tmethod: 'GET',\n\t\t})\n\t\t\t.then(res => res.text())\n\t\t\t.then(html => {\n\t\t\t\treturn [...extractElement(this.MERCHANT_CODE_SELECTOR, html, true)]\n\t\t\t\t\t.filter(Boolean)\n\t\t\t\t\t.map(elem => elem.textContent);\n\t\t\t});\n\t}\n\n\twatchForCartUrl() {\n\t\tconst interval = super.watchForCartUrl();\n\n\t\tsessionTimer.initialize({\n\t\t\tactionInterval: interval,\n\t\t\ttimeout: 15,\n\t\t});\n\t}\n\n\tbeforeCheckCodes(originalPrice) {\n\t\tif (!originalPrice) {\n\t\t\treturn this._getCartSummary().then(responseHTML => this._parseTotal(responseHTML));\n\t\t}\n\t\treturn originalPrice;\n\t}\n\n\tasync beforeApplyCodes() {\n\t\tconst driverStorage = await backgroundMessaging.getDriverStorage(DOMAIN);\n\t\tconst codeTestingCount = driverStorage ? driverStorage.codeTestingCount : 0;\n\t\tbackgroundMessaging.setDriverStorage(DOMAIN, {\n\t\t\tcodeTestingCount: codeTestingCount + 1,\n\t\t\tlastTestTimestamp: Date.now(),\n\t\t});\n\t}\n\n\tapplyCodes(codes) {\n\t\tif (isOnInformation()) {\n\t\t\treturn this._applyCodeManually(codes[0]);\n\t\t}\n\t\treturn super.applyCodes(codes);\n\t}\n\n\t_applyCodeManually(code) {\n\t\tsetValue(document.querySelector(this.CODES_INPUT_SELECTOR), code);\n\t\tconst isCodeApplied = () => document.querySelector(this.APPLIED_CODE_SELECTOR);\n\t\tdocument.querySelector(this.APPLY_BUTTON_SELECTOR).click();\n\t\treturn wait(isCodeApplied, 5000);\n\t}\n\n\t_parseTotal(data = false) {\n\t\treturn toFloat(extractData(this.TOTAL_SELECTOR, data, false));\n\t}\n};\n\nexport default {\n\tname: 'Body Candy',\n\tdomain: 'bodycandy.com',\n\tDriver,\n\tcompletionAction: isOnInformation() ? completionActions.none : completionActions.default,\n\tmaxCoupons: 8, // slow site\n\tisSinglePageApp: true,\n};\n","import Promise from 'bluebird';\nimport ShopifyDriver from './_base';\nimport bus from '../../bus';\nimport { sessionTimer, backgroundMessaging } from '../../lib';\nimport { DOM, format, log, completionActions } from '../../../utils';\n\nconst { toFloat } = format;\nconst { extractFormValues, extractData, extractElement, setValue } = DOM;\n\n/** Driver behavior description:\n+ Existing code: yes\n+ Remove code: yes\n+ Stackable: no\n+ Free gift support: no\n+ Free shipping: no\n+ ‘isValid’ implemented: yes\n+ Codes can be replaced by another code: no\n+ Pages, where extension works: checkout\n+ Is driver SPA yes\n+ Gather codes on site pages: yes\n+ Special case about the driver works (if it needed).\n  - maxCoupons (4) blocking\n  - sessionTimer yes (15)\n  - showDifferentDiscountMessage: true\n  - allow testing, retesting, wait for 20 min to the next testing, because of blocking\n */\n\nconst DOMAIN = 'bombas.com';\nconst DOMAIN_URL = `https://${DOMAIN}/`;\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t\tthis.MERCHANT_CODES_SELECTOR = '#alertbar';\n\t\tthis.PROMO_CODES_SELECTOR = '.bee-coupon-dialog';\n\t\tthis.MERCHANT_CODES_REGEXP = /code\\s([\\d\\w]+)/i;\n\t\tthis.CODE_INPUT_SELECTORS = '#checkout_reduction_code';\n\t\tthis.APPLY_BUTTON_SELECTOR = '.field__input-btn';\n\t\tthis.restoreShippingMethod = true;\n\t\tthis.DISABLE_TIME_MS = 20 * 60 * 1000; // 20 minutes\n\t\tsessionTimer.initialize();\n\t}\n\n\tasync checkCondition() {\n\t\tlet isNotMaxCodeTesting = true;\n\t\tconst driverStorage = await backgroundMessaging.getDriverStorage(DOMAIN);\n\t\tif (driverStorage) {\n\t\t\tconst dataExpired = Date.now() - driverStorage.lastTestTimestamp >= this.DISABLE_TIME_MS;\n\t\t\tif (dataExpired) {\n\t\t\t\tbackgroundMessaging.deleteDriverStorage(DOMAIN);\n\t\t\t} else {\n\t\t\t\tisNotMaxCodeTesting = driverStorage.codeTestingCount < 2;\n\t\t\t}\n\t\t}\n\t\tconst isOnCartUrl =\n\t\t\twindow.location.href.startsWith(DOMAIN_URL) &&\n\t\t\twindow.location.href.includes('/checkouts/') &&\n\t\t\t!window.location.href.includes('stock_problems') &&\n\t\t\t!window.location.href.includes('/thanks-you');\n\t\tconst isTotal = document.querySelector(this.TOTAL_SELECTOR);\n\t\tconst currentState = isOnCartUrl && isTotal && isNotMaxCodeTesting;\n\t\treturn currentState;\n\t}\n\n\tasync beforeTestCodes() {\n\t\tthis.shippingPriceIndex = null;\n\t\tif (!this.bodyData) {\n\t\t\tthis.bodyData = extractFormValues(this.FORM_SELECTOR);\n\t\t}\n\t\tthis.CHECKOUT_STEP = document.querySelector('.step');\n\t\tthis.IS_ON_SHIPPING = this.CHECKOUT_STEP\n\t\t\t? this.CHECKOUT_STEP.getAttribute('data-step') === 'shipping_method'\n\t\t\t: false;\n\t\tconst driverStorage = await backgroundMessaging.getDriverStorage(DOMAIN);\n\t\tconst codeTestingCount = driverStorage ? driverStorage.codeTestingCount : 0;\n\t\tbackgroundMessaging.setDriverStorage(DOMAIN, {\n\t\t\tcodeTestingCount: codeTestingCount + 1,\n\t\t\tlastTestTimestamp: Date.now(),\n\t\t});\n\t\treturn Promise.resolve();\n\t}\n\n\tgetMerchantCodes() {\n\t\treturn fetch(DOMAIN_URL)\n\t\t\t.then(response => response.text())\n\t\t\t.then(responseHTML => {\n\t\t\t\tconst mainPageCode = extractElement(this.PROMO_CODES_SELECTOR, responseHTML)\n\t\t\t\t\t? [...extractElement(this.PROMO_CODES_SELECTOR, responseHTML, true)]\n\t\t\t\t\t\t\t.filter(Boolean)\n\t\t\t\t\t\t\t.map(el => el.getAttribute('data-coupon-code'))\n\t\t\t\t\t: [];\n\t\t\t\treturn [\n\t\t\t\t\t...new Set(\n\t\t\t\t\t\t[...extractElement(this.MERCHANT_CODES_SELECTOR, responseHTML, true)]\n\t\t\t\t\t\t\t.map(el => el.textContent.match(this.MERCHANT_CODES_REGEXP))\n\t\t\t\t\t\t\t.filter(Boolean)\n\t\t\t\t\t\t\t.map(code => code[1]),\n\t\t\t\t\t).add(...mainPageCode),\n\t\t\t\t];\n\t\t\t});\n\t}\n\n\tremoveCodes() {\n\t\treturn (\n\t\t\tthis._removeCode()\n\t\t\t\t// sometimes after code removing we got in respons old info about total price.\n\t\t\t\t// So we need to send request to the cart page, and after that  - send request tot get updated total sum\n\t\t\t\t.then(() => this._getCartSummary())\n\t\t\t\t.then(responseHTML => (this.IS_ON_SHIPPING ? this._getCartSummary() : responseHTML))\n\t\t\t\t.then(responseHTML => this._parseTotal(responseHTML))\n\t\t);\n\t}\n\n\tcheckCodes(codes, originalPrice = this._parseTotal()) {\n\t\tlog(`Original price: ${originalPrice}`);\n\t\treturn Promise.each(codes, code =>\n\t\t\tPromise.delay(2500).then(() => {\n\t\t\t\tthis._applyCode(code)\n\t\t\t\t\t.then(() => this._getCartSummary())\n\t\t\t\t\t.then(responseText => {\n\t\t\t\t\t\tconst result = {\n\t\t\t\t\t\t\tcode,\n\t\t\t\t\t\t\tfinalPrice: originalPrice,\n\t\t\t\t\t\t\tfinalDiscount: 0,\n\t\t\t\t\t\t\tisValid: true,\n\t\t\t\t\t\t};\n\t\t\t\t\t\tif (!responseText || !extractElement(this.APPLIED_CODE_SELECTOR, responseText)) {\n\t\t\t\t\t\t\tresult.isValid = false;\n\t\t\t\t\t\t\treturn bus.$emit('code-checked', result);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresult.finalPrice = this._parseTotal(responseText);\n\t\t\t\t\t\tresult.finalDiscount = originalPrice - result.finalPrice;\n\t\t\t\t\t\treturn this._removeCode().then(() => bus.$emit('code-checked', result));\n\t\t\t\t\t});\n\t\t\t}),\n\t\t);\n\t}\n\n\tapplyCodes(codes) {\n\t\treturn this._manuallyApplyCode(codes[0]);\n\t}\n\n\t_manuallyApplyCode(code) {\n\t\tsetValue(document.querySelector(this.CODE_INPUT_SELECTORS), code);\n\t\tdocument.querySelector(this.APPLY_BUTTON_SELECTOR).click();\n\t\treturn Promise.resolve();\n\t}\n\n\t_manageCode() {\n\t\treturn fetch(this.bodyData.action, {\n\t\t\tmethod: 'POST',\n\t\t\tcredentials: 'include',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\n\t\t\t},\n\t\t\tbody: this.bodyData.params,\n\t\t}).then(response => (response.status === 409 || response.status === 429 ? null : response.text()));\n\t}\n\n\t_parseTotal(data) {\n\t\tlet totalSumm = null;\n\t\tif (this.IS_ON_SHIPPING) {\n\t\t\tconst shippingPriceIndex = this._getShippingSelectorIndex();\n\t\t\tconst shippingRateSelector = `.content-box__row:nth-of-type(${shippingPriceIndex + 1}) .input-radio`;\n\t\t\ttotalSumm = data\n\t\t\t\t? extractData(shippingRateSelector, data, false, this.CHECKOUT_TOTAL_SELECTOR_ATTRIBUTE)\n\t\t\t\t: extractData(this.TOTAL_SELECTOR);\n\t\t} else {\n\t\t\ttotalSumm = extractData(this.TOTAL_SELECTOR, data);\n\t\t}\n\t\treturn toFloat(totalSumm);\n\t}\n};\n\nexport default {\n\tname: 'Bombas',\n\tdomain: 'bombas.com',\n\tDriver,\n\tmaxCoupons: 4,\n\trestoreUserData: true,\n\tisSinglePageApp: true,\n\tcompletionAction: completionActions.none,\n\tshowDifferentDiscountMessage: true,\n};\n","import ShopifyDriver from './_base';\nimport { sessionTimer } from '../../lib';\n\n// Driver behaviour description:\n// •    Existing code: yes\n// •    Remove code: yes\n// •    Stackable: no\n// •    Free gift support: no\n// •    'isValid' implemented: yes\n// •     Codes can be replaced by another code: yes\n// • sessionTimer 15 min\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\t// some page elements like shipping or taxes may load dynamically after page loaded\n\t\tthis.loadPageDynamic = true;\n\t\tthis.PROMO_INPUT = '#checkout_reduction_code';\n\t}\n\n\tcheckCondition() {\n\t\tconst { href } = window.location;\n\t\treturn (\n\t\t\thref.startsWith('https://store.bpisports.com/') &&\n\t\t\thref.includes('/checkouts/') &&\n\t\t\tdocument.querySelector(this.PROMO_INPUT)\n\t\t);\n\t}\n\n\twatchForCartUrl() {\n\t\tconst interval = super.watchForCartUrl();\n\n\t\tsessionTimer.initialize({\n\t\t\tactionInterval: interval,\n\t\t\ttimeout: 15,\n\t\t});\n\t}\n};\n\nexport default {\n\tname: 'BPI sports',\n\tdomain: 'bpisports.com',\n\tDriver,\n\tisSinglePageApp: true,\n\tmaxCoupons: 8, // site locks us\n};\n","import ShopifyDriver from './_base';\nimport { sessionTimer } from '../../lib';\n\n/*\nBehavior description:\n+ Existing code: yes\n+ Remove code: yes\n+ Stackable: no\n+ Free gift support: no\n+ Free shipping: no\n+ ‘isValid’ implemented: yes\n+ Pages, where extension works: Checkout pages\n+ Is driver SPA: yes\n+ Gather codes on site pages: no\n+ maxCoupons: 10\n*/\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.USER_ADDRESS_SELECTOR = '#checkout_shipping_address_first_name';\n\t\tthis.CODE_INPUT_SELECTOR = '[name=\"checkout[reduction_code]\"]';\n\t\tthis.STEP_SELECTOR = '.step';\n\t}\n\n\twatchForCartUrl() {\n\t\tconst interval = super.watchForCartUrl();\n\n\t\tsessionTimer.initialize({\n\t\t\tactionInterval: interval,\n\t\t\ttimeout: 15,\n\t\t});\n\t}\n\n\tcheckCondition() {\n\t\tconst { href } = window.location;\n\t\tconst isOnRightURL =\n\t\t\thref.startsWith('https://shop.brayola.com') &&\n\t\t\thref.includes('/checkouts/') &&\n\t\t\t!href.includes('stock_problems');\n\t\tconst isCodeInputEl = document.querySelector(this.CODE_INPUT_SELECTOR);\n\t\treturn isOnRightURL && isCodeInputEl;\n\t}\n};\n\nexport default {\n\tname: 'brayola',\n\tdomain: 'brayola.com',\n\tDriver,\n\tisSinglePageApp: true,\n\tmaxCoupons: 8, // site locks us\n};\n","import Promise from 'bluebird';\nimport ShopifyDriver from './_base';\nimport bus from '../../bus';\nimport { DOM, log } from '../../../utils';\nimport { sessionTimer } from '../../lib';\n\nconst { extractFormValues, extractFromHTML } = DOM;\n\n// Behavior description:\n// we can apply only one code\n// We can get existing code\n// we can remove code or we can replace old code with new one\n// maxCoupons: 5,\n// • sessionTimer 15 min\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t\tthis.contactInfoStep = false;\n\t\tthis.CONTACT_INFO_FORM_SELECTOR = '.edit_checkout:first-child';\n\t}\n\n\tcheckCondition() {\n\t\tconst isRightUrl = window.location.href.includes('/checkouts/');\n\t\tconst codeInput = document.querySelector(this.CODES_INPUT_SELECTOR);\n\t\tconst isCodeInput = codeInput && codeInput.offsetParent;\n\t\tconst totalEl = document.querySelector(this.TOTAL_SELECTOR);\n\t\tconst isTotal = totalEl && totalEl.offsetParent;\n\t\tconst currentState = isRightUrl && isCodeInput && isTotal;\n\t\treturn currentState;\n\t}\n\n\twatchForCartUrl() {\n\t\tconst interval = super.watchForCartUrl();\n\n\t\tsessionTimer.initialize({\n\t\t\tactionInterval: interval,\n\t\t\ttimeout: 15,\n\t\t});\n\t}\n\n\tbeforeTestCodes() {\n\t\tif (!this.bodyData) {\n\t\t\tthis.bodyData = extractFormValues(this.FORM_SELECTOR);\n\t\t}\n\t\tthis.CHECKOUT_STEP = document.querySelector('.step');\n\t\tthis.IS_ON_SHIPPING = this.CHECKOUT_STEP\n\t\t\t? this.CHECKOUT_STEP.getAttribute('data-step') === 'shipping_method'\n\t\t\t: false;\n\t\tthis._getShippingSelectorIndex();\n\t\tconst step = document.querySelector('.step');\n\t\tthis.contactInfoStep = step.dataset.step === 'contact_information';\n\t\treturn Promise.resolve();\n\t}\n\n\tbeforeCheckCodes() {\n\t\treturn this.contactInfoStep\n\t\t\t? this._getCartSummary().then(responseHTML => this._parseTotal(responseHTML))\n\t\t\t: Promise.resolve();\n\t}\n\n\tcheckCodes(codes, originalPrice = this._parseTotal()) {\n\t\tlog(`Original price: ${originalPrice}`);\n\t\treturn Promise.each(codes, code =>\n\t\t\tthis._applyCode(code)\n\t\t\t\t.then(responseHTML => (this.loadPageDynamic ? this._getCartSummary(code) : responseHTML))\n\t\t\t\t.then(responseText => {\n\t\t\t\t\tconst result = {\n\t\t\t\t\t\tcode,\n\t\t\t\t\t\tfinalPrice: originalPrice,\n\t\t\t\t\t\tfinalDiscount: 0,\n\t\t\t\t\t\tisValid: false,\n\t\t\t\t\t};\n\n\t\t\t\t\tif (extractFromHTML(responseText, this.APPLIED_CODE_SELECTOR)) {\n\t\t\t\t\t\tresult.finalPrice = this._parseTotal(responseText);\n\t\t\t\t\t\tresult.finalDiscount = originalPrice - result.finalPrice;\n\t\t\t\t\t\tresult.isValid = true;\n\n\t\t\t\t\t\treturn this._removeCode().then(() => bus.$emit('code-checked', result));\n\t\t\t\t\t}\n\t\t\t\t\treturn bus.$emit('code-checked', result);\n\t\t\t\t}),\n\t\t);\n\t}\n\n\t_getCartSummary(code = '') {\n\t\tlet contactForm = null;\n\t\tif (this.contactInfoStep) {\n\t\t\tcontactForm = extractFormValues(this.CONTACT_INFO_FORM_SELECTOR).params;\n\t\t\tcontactForm.set(this.APPLY_CODE_PARAMETER, code);\n\t\t}\n\t\treturn fetch(`${window.location.href}${contactForm ? '?' : ''}${contactForm ? contactForm.toString() : ''}`, {\n\t\t\tmethod: 'GET',\n\t\t\tcredentials: 'include',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\n\t\t\t},\n\t\t}).then(response => response.text());\n\t}\n};\n\nexport default {\n\tname: 'Bulletproof',\n\tdomain: 'bulletproof.com',\n\tisSinglePageApp: true,\n\tDriver,\n\tmaxCoupons: 5,\n};\n","import ShopifyDriver from './_base';\nimport { sessionTimer } from '../../lib';\nimport { format, DOM, sendXhr } from '../../../utils';\n\nconst { toFloat } = format;\nconst { extractElement, extractData } = DOM;\n/* BEHAVIOUR\n+ Existing code: yes\n+ Remove code: yes\n+ Stackable: no\n+ Free gift support: no\n+ Free shipping: no\n+ ‘isValid’ implemented: yes\n+ Manually apply code: no\n+ Pages, where extension works:\n- Cart page, checkout page\n * - Sometimes coupon deletes gift\n * - MaxCoupons = 7, because 1 valid code ~ 8ms\n * - sessionTimer 15 min\n */\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t\tthis.STEP_SELECTOR = '.step';\n\t\tthis.INPUT_FIELD_SELECTOR = '.order-summary__sections #checkout_reduction_code';\n\t\tthis.SHIPPING_ELEMENT_SELECTOR = '.content-box__row .input-radio';\n\t\tthis.SHIPPING_PRICE_SELECTOR = '.total-line--shipping .order-summary__emphasis';\n\t\tthis.SHIPPING_PRICE = 0;\n\t}\n\n\twatchForCartUrl() {\n\t\tconst interval = super.watchForCartUrl();\n\t\tsessionTimer.initialize({\n\t\t\tactionInterval: interval,\n\t\t\ttimeout: 15,\n\t\t});\n\t}\n\n\tcheckCondition() {\n\t\tconst { href } = window.location;\n\t\tconst isOnCheckoutPage = href.startsWith('https://www.chubbiesshorts.com') && href.includes('/checkouts/');\n\t\tconst inputField = document.querySelector(this.INPUT_FIELD_SELECTOR);\n\t\tconst isInput = inputField && inputField.offsetParent;\n\t\treturn isOnCheckoutPage && isInput;\n\t}\n\n\tcheckRestoreDataCondition() {\n\t\tconst checkouStepElement = document.querySelector(this.STEP_SELECTOR);\n\t\tthis.IS_ON_SHIPPING = checkouStepElement && checkouStepElement.getAttribute('data-step') === 'shipping_method';\n\t\treturn this.IS_ON_SHIPPING;\n\t}\n\n\tgetUserData() {\n\t\t// Nothing to restore on the cart page\n\t\tif (this.IS_ON_SHIPPING) {\n\t\t\tconst checkedShippingElement = [...document.querySelectorAll(this.SHIPPING_ELEMENT_SELECTOR)].find(\n\t\t\t\telement => element.checked,\n\t\t\t);\n\t\t\tif (checkedShippingElement) {\n\t\t\t\t// store shipping price to add it in parseTotal if there will be no shipping options\n\t\t\t\tthis.SHIPPING_PRICE = toFloat(checkedShippingElement.getAttribute('data-checkout-total-shipping')) || 0;\n\t\t\t}\n\t\t\treturn checkedShippingElement\n\t\t\t\t? {\n\t\t\t\t\t\tshippingSelector: `input#${checkedShippingElement.getAttribute('id')}`,\n\t\t\t\t  }\n\t\t\t\t: null;\n\t\t}\n\t\treturn null;\n\t}\n\n\tsetUserData(userData) {\n\t\tif (userData) {\n\t\t\tdocument.querySelector(userData.shippingSelector).click();\n\t\t}\n\t}\n\n\t_getCartSummary() {\n\t\t// merchant auto apply code, and change url address\n\t\tconst { href } = window.location;\n\t\tconst requestUrl = href.match(/step=/) ? href : href.split('?')[0];\n\t\treturn sendXhr(requestUrl, {\n\t\t\tmethod: 'GET',\n\t\t\tcredentials: 'include',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\n\t\t\t},\n\t\t}).then(response => response.text());\n\t}\n\n\t_manageCode() {\n\t\treturn sendXhr(this.bodyData.action, {\n\t\t\tmethod: 'POST',\n\t\t\tcredentials: 'include',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\n\t\t\t},\n\t\t\tbody: this.bodyData.params,\n\t\t}).then(response => response.text());\n\t}\n\n\t_parseTotal(data = false) {\n\t\t// there are cases, when shipping options doesn't show\n\t\t// we will take total with default shipping\n\t\tif (this.IS_ON_SHIPPING) {\n\t\t\tconst isShippingMethod = extractElement(this.ALL_SHIPPINGS_SELECTOR, data);\n\t\t\tif (isShippingMethod) {\n\t\t\t\tconst shippingRateSelector = `.content-box__row:nth-of-type(${\n\t\t\t\t\tthis.shippingPriceIndex < 0 ? 1 : this.shippingPriceIndex + 1\n\t\t\t\t}) .input-radio`;\n\t\t\t\treturn toFloat(extractData(shippingRateSelector, data, false, this.CHECKOUT_TOTAL_SELECTOR_ATTRIBUTE));\n\t\t\t}\n\t\t\t// we stored shipping price before testing and add here to order total, in case when there are no shipping options in response or on the page\n\t\t\treturn toFloat(extractData(this.TOTAL_SELECTOR, data)) + this.SHIPPING_PRICE;\n\t\t}\n\t\treturn toFloat(extractData(this.TOTAL_SELECTOR, data));\n\t}\n};\nexport default {\n\tname: 'ChubbiesShorts.com',\n\tdomain: 'chubbiesshorts.com',\n\tisSinglePageApp: true,\n\tmaxCoupons: 5,\n\trestoreUserData: true,\n\tDriver,\n};\n","import ShopifyDriver from './_base';\n\nconst Driver = class Driver extends ShopifyDriver {};\n\nexport default {\n\tname: 'cotopaxi',\n\tdomain: 'cotopaxi.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith('https://cotopaxi.com/') && href.includes('/checkouts/');\n\t},\n};\n","import ShopifyDriver from './_base';\n\n/* Behaviour description:\n   - we can apply code\n   - we can remove code\n   - we can apply only one code\n   - we can't replace a valid code with invalid one\n   - we can remove code or we can replace old code with new one\n*/\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.APPLIED_CODE_SELECTOR = '.reduction-code__text';\n\t}\n};\n\nexport default {\n\tname: 'Cuddl Duds',\n\tdomain: 'cuddlduds.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith('https://cuddlduds.com/') && href.includes('/checkouts/');\n\t},\n};\n","import ShopifyDriver from './_base';\nimport { backgroundMessaging } from '../../lib';\nimport { browserUtils } from '../../../utils';\n\nconst { setCookie, getCookie } = browserUtils;\n\n// Driver behavior description:\n// \t+ Existing code: yes\n// + Remove code: yes\n// + Stackable:  no\n// + Free gift support:  no\n// + Free shipping:  no\n// + ‘isValid’ implemented: yes\n// + Pages, where extension works:\n// \t- checkout\n// \t+ Is driver SPA: yes\n//  + max code testing 4 for 25 minutes\n// + Gather codes on site pages: yes(only if user visited main page)\n\nconst BASE_URL = 'https://dressbarn.com';\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.MERCHANT_CODE_SELECTOR = '.coupon-code';\n\t\tthis.APPLIED_CODE_SELECTOR = '.reduction-code__text';\n\t\tthis.loadPageDynamic = true;\n\t\tthis.restoreShippingMethod = true;\n\t\t// eslint-disable-next-line no-useless-escape\n\t\tthis.APPLIED_CODE_REGEX = /^[\\w\\-]+/;\n\t\tthis.DISABLE_TIME_MS = 25 * 60 * 1000;\n\t}\n\n\tasync checkCondition() {\n\t\tconst { href } = window.location;\n\t\tconst correctUrl = href.startsWith(BASE_URL) && href.includes('/checkouts/');\n\n\t\tif (!getCookie('merchant_code')) {\n\t\t\tconst merchantCode =\n\t\t\t\tdocument.querySelector(this.MERCHANT_CODE_SELECTOR) &&\n\t\t\t\tdocument.querySelector(this.MERCHANT_CODE_SELECTOR).textContent;\n\t\t\tif (merchantCode) {\n\t\t\t\tawait setCookie('merchant_code', merchantCode, 30, 'dressbarn.com');\n\t\t\t}\n\t\t}\n\n\t\tlet isNotMaxCodeTesting = true;\n\t\tconst driverStorage = await backgroundMessaging.getDriverStorage(BASE_URL);\n\t\tif (driverStorage) {\n\t\t\tconst dataExpired = Date.now() - driverStorage.lastTestTimestamp >= this.DISABLE_TIME_MS;\n\t\t\tif (dataExpired) {\n\t\t\t\tbackgroundMessaging.deleteDriverStorage(BASE_URL);\n\t\t\t} else {\n\t\t\t\tisNotMaxCodeTesting = driverStorage.codeTestingCount < 4;\n\t\t\t}\n\t\t}\n\n\t\treturn correctUrl && isNotMaxCodeTesting;\n\t}\n\n\tgetMerchantCodes() {\n\t\tif (getCookie('merchant_code')) {\n\t\t\treturn [getCookie('merchant_code')];\n\t\t}\n\t\treturn [];\n\t}\n\n\tgetExistingCodes() {\n\t\tconst codes = [\n\t\t\t...new Set(\n\t\t\t\t[...document.querySelectorAll(this.APPLIED_CODE_SELECTOR)]\n\t\t\t\t\t.map(el => el.textContent.trim().match(this.APPLIED_CODE_REGEX))\n\t\t\t\t\t.filter(Boolean)\n\t\t\t\t\t.map(el => el[0]),\n\t\t\t),\n\t\t];\n\n\t\treturn {\n\t\t\tcodes,\n\t\t\tcodeCount: codes.length,\n\t\t};\n\t}\n\n\tasync beforeApplyCodes() {\n\t\tconst driverStorage = await backgroundMessaging.getDriverStorage(BASE_URL);\n\t\tconst codeTestingCount = driverStorage ? driverStorage.codeTestingCount : 0;\n\t\tbackgroundMessaging.setDriverStorage(BASE_URL, {\n\t\t\tcodeTestingCount: codeTestingCount + 1,\n\t\t\tlastTestTimestamp: Date.now(),\n\t\t});\n\t}\n};\n\nexport default {\n\tname: 'Dressbarn',\n\tdomain: 'dressbarn.com',\n\trestoreUserData: true,\n\tmaxCoupons: 7,\n\tisSinglePageApp: true,\n\tDriver,\n\t// no need to write isCartEmpty() because user can`t go to the checkout page without goods\n};\n","import ShopifyDriver from './_base';\n\nconst Driver = class Driver extends ShopifyDriver {};\n\nexport default {\n\tname: 'Edens Garden',\n\tdomain: 'edensgarden.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith('https://www.edensgarden.com/') && href.includes('/checkouts/');\n\t},\n};\n","import ShopifyDriver from './_base';\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t}\n};\n\nexport default {\n\tname: 'EFavorMart',\n\tdomain: 'efavormart.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith('https://www.efavormart.com/') && href.includes('/checkouts/');\n\t},\n};\n","import ShopifyDriver from './_base';\n\nconst Driver = class Driver extends ShopifyDriver {};\n\nexport default {\n\tname: 'eLuxury',\n\tdomain: 'eluxury.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith('https://www.eluxury.com/') && href.includes('/checkouts/');\n\t},\n};\n","/*    eslint class-methods-use-this: [\"error\", { \"exceptMethods\": [\"_getInputFromDiv\", \"checkCondition\"] }] */\n\nimport ShopifyDriver from './_base';\nimport { DOM } from '../../../utils';\nimport { sessionTimer } from '../../lib';\n\nconst { extractFormValues } = DOM;\n\n// Driver behaviour description:\n// •    Existing code: yes\n// •    Remove code: yes\n// •    Stackable: no\n// •    Free gift support: no\n// •    'isValid' implemented: no\n// •     Codes can be replaced by another code: yes\n// sessionTimer 15 min\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t\t// registered users have another btn selector\n\t\tthis.APPLY_BUTTON_SELECTOR = '.order-summary__section--discount .field__input-btn.btn';\n\n\t\tthis.NEW_URL_FORM_SELECTOR = '.order-summary__section--discount form:first-of-type';\n\t\tthis.CHECKOUT_EMAIL_PARAM_SELECTOR = '[data-rtl-ensure]';\n\t\tthis.INPUT_DIV_SELECTOR = '.field--required input, .field--required select';\n\n\t\tthis.STEP_SELECTOR = '.step';\n\t}\n\n\tcheckCondition() {\n\t\tconst { href } = window.location;\n\n\t\tconst checkoutURL =\n\t\t\thref.startsWith('https://shop.enfamil.com/') &&\n\t\t\thref.includes('/checkouts/') &&\n\t\t\t!href.includes('stock_problems');\n\t\tconst isTotal =\n\t\t\tdocument.querySelector(this.TOTAL_SELECTOR) && document.querySelector(this.TOTAL_SELECTOR).offsetParent;\n\t\treturn checkoutURL && isTotal;\n\t}\n\n\twatchForCartUrl() {\n\t\tconst interval = super.watchForCartUrl();\n\n\t\tsessionTimer.initialize({\n\t\t\tactionInterval: interval,\n\t\t\ttimeout: 15,\n\t\t});\n\t}\n\n\tbeforeTestCodes() {\n\t\tsuper.beforeTestCodes();\n\t\tthis.IS_ON_CONTACT_PAGE = this.CHECKOUT_STEP\n\t\t\t? this.CHECKOUT_STEP.getAttribute('data-step') === 'contact_information'\n\t\t\t: false;\n\t\tthis.userIsLoggedIn = document.querySelector('.shopify-checkout-logout');\n\t\t// we need to send request to this url only for logged in users\n\t\tthis.newStringURLCondition = this.userIsLoggedIn && this.IS_ON_CONTACT_PAGE;\n\t\tthis.newStringURL = this.newStringURLCondition\n\t\t\t? encodeURI(this._newURLForming().slice(0, -1))\n\t\t\t: window.location.href;\n\t}\n\n\t_getCartSummary() {\n\t\treturn fetch(this.newStringURL, {\n\t\t\tcredentials: 'include',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\n\t\t\t},\n\t\t}).then(response => response.text());\n\t}\n\n\t_getInputFromDiv(selector) {\n\t\tconst body = {};\n\t\t[...document.querySelectorAll(selector)].reduce((acc, el) => {\n\t\t\tacc[el.name] = el.value;\n\t\t\treturn acc;\n\t\t}, body);\n\t\treturn body;\n\t}\n\n\t// this method is used for forming url with query params. This url is used for send request to get tax price(it loads dynamically)\n\t_newURLForming() {\n\t\tconst obj = extractFormValues(this.NEW_URL_FORM_SELECTOR);\n\t\tconst newObj = obj.params;\n\t\t// We need to append params in the order, they are written down\n\t\tnewObj.append('previous_step', 'contact_information');\n\t\tnewObj.append(\n\t\t\t'checkout[email]',\n\t\t\tdocument.querySelector(this.CHECKOUT_EMAIL_PARAM_SELECTOR).textContent.slice(1, -1),\n\t\t);\n\n\t\tconst divElement = this._getInputFromDiv(this.INPUT_DIV_SELECTOR);\n\t\t// first we need to add empty params\n\t\tObject.keys(divElement).forEach(key => {\n\t\t\tnewObj.append(key, '');\n\t\t});\n\t\t// after that we need to add the same params with values\n\t\tObject.entries(divElement).forEach(([key, value]) => {\n\t\t\tnewObj.append(key, value);\n\t\t});\n\t\tnewObj.set('checkout[buyer_accepts_marketing]', '0');\n\t\tnewObj.delete('');\n\t\tnewObj.delete('checkout[client_details][javascript_enabled]');\n\t\tnewObj.delete('checkout[client_details][browser_height]');\n\t\tnewObj.delete('checkout[client_details][browser_width]');\n\t\tnewObj.delete('checkout[reduction_code]');\n\t\t// at the end we need to combine all params in url\n\t\tlet stringURL = `${window.location.href.split('?')[0]}?`;\n\t\t[...newObj.entries()].forEach(([key, value]) => {\n\t\t\tstringURL += `${key}=${value}&`;\n\t\t});\n\t\treturn stringURL;\n\t}\n};\n\nexport default {\n\tname: 'enFamil',\n\tdomain: 'enfamil.com',\n\tisSinglePageApp: true,\n\tmaxCoupons: 8, // due to test time\n\tDriver,\n};\n","import Promise from 'bluebird';\nimport ShopifyDriver from './_base';\nimport bus from '../../bus';\nimport { format } from '../../../utils';\n\nconst { toFloat } = format;\n\n/* Behaviour\n * We have two pages, where we can apply code\n * One page works as base driver `DriverShopifyBase`\n * Another page works as `DriverNotBase`\n */\n\nconst DOMAIN = 'entertainment.com';\nconst IS_CHECKOUT_PAGE = window.location.pathname.includes('/checkouts');\nconst CODE_INPUT_SELECTORS = '#checkout_reduction_code, .checkout-discount-code';\n\nconst DriverShopifyBase = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t\tthis.FORM_SELECTOR =\n\t\t\t'.order-summary__section--discount form:first-child, .order-summary__section--discount form:last-of-type';\n\t}\n};\n\nconst DriverNotBase = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.APPLIED_CODE_SELECTOR = '.total-line__discount_code, .applied-reduction-code__information';\n\t\tthis.bodyData = null;\n\t\tthis.APPLY_CODE_PARAMETER = 'discount_code';\n\t\tthis.APPLY_BUTTON_SELECTOR = '#side_order_summary .apply-discount-code';\n\t\tthis.CODES_INPUT_SELECTOR = '#side_order_summary .checkout-discount-code';\n\t}\n\n\tbeforeTestCodes() {\n\t\tthis.bodyData = {\n\t\t\taction: `https://account.${DOMAIN}/ajax/get_discount`,\n\t\t\tparams: new URLSearchParams(),\n\t\t};\n\t\tthis.bodyData.params.set('products', sessionStorage.ProductInfo);\n\t\tif (!this.bodyData.params.has('products')) {\n\t\t\tthis.bodyData.params.set('products', sessionStorage.ProductInfo);\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n\n\tgetExistingCodes() {\n\t\tconst codes = [sessionStorage.getItem('DiscountInfo')].filter(Boolean).map(info => JSON.parse(info).code);\n\n\t\treturn {\n\t\t\tcodes,\n\t\t\tcodeCount: codes.length,\n\t\t};\n\t}\n\n\tremoveCodes() {\n\t\treturn this._removeCode().then(() => this._calculateTotal());\n\t}\n\n\tcheckCodes(codes, originalPrice = this._parseTotal()) {\n\t\treturn Promise.each(codes, code => {\n\t\t\tconst result = {\n\t\t\t\tcode,\n\t\t\t\tfinalPrice: originalPrice,\n\t\t\t\tfinalDiscount: 0,\n\t\t\t};\n\t\t\treturn (\n\t\t\t\tthis._applyCode(code)\n\t\t\t\t\t// here can be response JSON and can be HTML\n\t\t\t\t\t.then(response => {\n\t\t\t\t\t\tresult.isValid = Boolean(!response.error);\n\t\t\t\t\t\tconst discountAmount = response.error ? 0 : response.discount.amount;\n\t\t\t\t\t\tresult.finalPrice = originalPrice - discountAmount;\n\t\t\t\t\t\tresult.finalDiscount = originalPrice - result.finalPrice;\n\t\t\t\t\t\treturn bus.$emit('code-checked', result);\n\t\t\t\t\t})\n\t\t\t);\n\t\t});\n\t}\n\n\tapplyCodes(codes) {\n\t\treturn this._applyCode(codes[0]);\n\t}\n\n\t_removeCode() {\n\t\treturn this._applyCode('REMOVE');\n\t}\n\n\t_manageCode() {\n\t\treturn fetch(this.bodyData.action, {\n\t\t\tmethod: 'POST',\n\t\t\tcredentials: 'include',\n\t\t\tbody: this.bodyData.params,\n\t\t}).then(response => response.json());\n\t}\n\n\t_calculateTotal() {\n\t\tlet total = 0;\n\t\tconst products = JSON.parse(sessionStorage.ProductInfo);\n\t\tproducts.forEach(item => {\n\t\t\ttotal += toFloat(item.price * item.qty);\n\t\t});\n\t\ttotal /= 100;\n\t\tconst shipping = sessionStorage.getItem('ShippingInfo') ? JSON.parse(sessionStorage.ShippingInfo).price : 0;\n\t\ttotal += shipping;\n\t\treturn total;\n\t}\n};\n\nexport default {\n\tname: 'Entertainment',\n\tdomain: 'entertainment.com',\n\tmaxCoupons: 8, // site locks us\n\tget Driver() {\n\t\treturn IS_CHECKOUT_PAGE ? DriverShopifyBase : DriverNotBase;\n\t},\n\tisOnCartUrl(href) {\n\t\treturn (\n\t\t\t(href.includes('/shop') ||\n\t\t\t\thref.includes('/checkout-shipping') ||\n\t\t\t\thref.includes('/checkout-payment') ||\n\t\t\t\thref.includes('/checkout')) &&\n\t\t\tdocument.querySelector(CODE_INPUT_SELECTORS)\n\t\t);\n\t},\n};\n","import Promise from 'bluebird';\nimport ShopifyDriver from './_base';\nimport { DOM } from '../../../utils';\n\nconst { extractFromHTML, extractElement } = DOM;\n\n/** Behavior description:\n + Existing code: yes\n + Remove code: yes\n + Stackable: no\n + Free gift support: no\n + Free shipping: no\n + ‘isValid’ implemented: yes\n + Manually apply code: no\n + Pages, where extension works: Checkout\n + Is driver SPA: yes\n + Gather codes on site pages: no\n + maxCoupons: 4 // because of blocking\n\n Special case:\n + This merchant has a page with current promotions: https://support.fashionnova.com/hc/en-us/articles/360024552052 .\n But when request on this page is sent, it responds with 304 status code and 'Provisional headers are shown' warning appears.\n Also we can't get it via iframe because 'DENY is one of three possible directives for X-Frame Options'\n Explanation for this warning: https://stackoverflow.com/questions/21177387/caution-provisional-headers-are-shown-in-chrome-debugger\n * */\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.BASE_URL = 'https://www.fashionnova.com/';\n\t\tthis.SPINNER = '.full-page-overlay';\n\t\tthis.FORM_SELECTOR = '.order-summary__section--discount form:last-of-type';\n\t\tthis.loadPageDynamic = true;\n\t\tthis.APPLIED_CODE_SELECTOR = 'form .reduction-code__text';\n\t\tthis.MERCHANT_CODES_SELECTOR = '.shipping-banner-carousel .gender-content a';\n\t\tthis.MERCHANT_CODES_REGEXP = /code:? (\\w+)/i;\n\t\tthis.setFlag = (regex, flag) => new RegExp(regex, flag);\n\n\t\tthis.restoreShippingMethod = true;\n\t}\n\n\tcheckCondition() {\n\t\tconst { href } = window.location;\n\t\tconst isOnCheckout =\n\t\t\thref.startsWith(this.BASE_URL) &&\n\t\t\thref.includes('/checkouts/') &&\n\t\t\t!href.includes('stock_problems') &&\n\t\t\t!href.includes('/thank_you');\n\t\tconst isTotal = document.querySelector(this.TOTAL_SELECTOR);\n\t\tconst isSpinner = document.querySelector(this.SPINNER);\n\t\treturn isOnCheckout && isTotal && !isSpinner;\n\t}\n\n\tgetMerchantCodes() {\n\t\treturn this._getPage().then(responseHTML => {\n\t\t\treturn [\n\t\t\t\t...new Set(\n\t\t\t\t\t[...extractElement(this.MERCHANT_CODES_SELECTOR, responseHTML, true)]\n\t\t\t\t\t\t.map(elem => elem.innerText.match(this.MERCHANT_CODES_REGEXP))\n\t\t\t\t\t\t.filter(Boolean)\n\t\t\t\t\t\t.map(code => code[1]),\n\t\t\t\t),\n\t\t\t];\n\t\t});\n\t}\n\n\tgetExistingCodes() {\n\t\tconst codes = new Set([...document.querySelectorAll(this.APPLIED_CODE_SELECTOR)].map(el => el.textContent));\n\n\t\treturn {\n\t\t\tcodes: [...codes],\n\t\t\tcodeCount: codes.size,\n\t\t};\n\t}\n\n\tbeforeCheckCodes(originalPrice) {\n\t\tif (!originalPrice) {\n\t\t\treturn this._getCartSummary().then(responseHTML => this._parseTotal(responseHTML));\n\t\t}\n\t\treturn originalPrice;\n\t}\n\n\t_getPage(url = this.BASE_URL) {\n\t\treturn fetch(url, {\n\t\t\tmethod: 'GET',\n\t\t\tcredentials: 'include',\n\t\t}).then(response => response.text());\n\t}\n\n\t_getCartSummary(retry = false) {\n\t\treturn Promise.delay(2000).then(() => {\n\t\t\treturn fetch(window.location.href, {\n\t\t\t\tmethod: 'GET',\n\t\t\t\tcredentials: 'include',\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\n\t\t\t\t},\n\t\t\t})\n\t\t\t\t.then(response => response.text())\n\t\t\t\t.then(responseHTML => {\n\t\t\t\t\tif (!extractFromHTML(responseHTML, this.TOTAL_SELECTOR) && !retry) {\n\t\t\t\t\t\treturn this._getCartSummary(true);\n\t\t\t\t\t}\n\t\t\t\t\treturn responseHTML;\n\t\t\t\t});\n\t\t});\n\t}\n};\n\nexport default {\n\tname: 'fashionnova',\n\tdomain: 'fashionnova.com',\n\tDriver,\n\trestoreUserData: true,\n\tisSinglePageApp: true,\n\tmaxCoupons: 4,\n};\n","import ShopifyDriver from './_base';\n\nconst BASE_URL = 'https://www.fit-fresh.com';\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t}\n};\n\nexport default {\n\tname: 'Fit & Fresh',\n\tdomain: 'fit-fresh.com',\n\t// Site may be a little slow\n\tmaxCoupons: 8,\n\tDriver,\n\tisOnCartUrl: href => href.startsWith(BASE_URL) && href.includes('/checkouts/'),\n};\n","import Promise from 'bluebird';\nimport bus from '../../bus';\nimport ShopifyDriver from './_base';\nimport { DOM, log } from '../../../utils';\n\nconst { extractElement } = DOM;\n\nconst BASE_URL = 'https://flattummyco.com';\n/*\nDriver behaviour description:\n•    Existing code: yes\n•    Remove code: yes\n•    Stackable: no\n•    Free gift support: no\n•    'isValid' implemented: yes\n•     Codes can be replaced by another code: yes\n•    Is driver SPA and add the condition to show popup: no\n\tmaxCoupons: 10, // due to low performance\n*/\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t}\n\n\tcheckCodes(codes, originalPrice = this._parseTotal()) {\n\t\tlog(`Original price: ${originalPrice}`);\n\t\treturn Promise.each(codes, code =>\n\t\t\tthis._applyCode(code)\n\t\t\t\t.then(responseHTML => (this.loadPageDynamic ? this._getCartSummary() : responseHTML))\n\t\t\t\t.then(responseText => {\n\t\t\t\t\tconst result = {\n\t\t\t\t\t\tcode,\n\t\t\t\t\t\tfinalPrice: originalPrice,\n\t\t\t\t\t\tfinalDiscount: 0,\n\t\t\t\t\t\tisValid: false,\n\t\t\t\t\t};\n\n\t\t\t\t\tif (extractElement(this.APPLIED_CODE_SELECTOR, responseText)) {\n\t\t\t\t\t\tresult.finalPrice = this._parseTotal(responseText);\n\t\t\t\t\t\tresult.finalDiscount = originalPrice - result.finalPrice;\n\t\t\t\t\t\tresult.isValid = result.finalPrice < originalPrice;\n\t\t\t\t\t}\n\t\t\t\t\treturn this._removeCode().then(() => bus.$emit('code-checked', result));\n\t\t\t\t}),\n\t\t);\n\t}\n};\n\nexport default {\n\tname: 'Flat Tummy Co',\n\tdomain: 'flattummyco.com',\n\tmaxCoupons: 8, // site locks us\n\tDriver,\n\tisOnCartUrl: href => href.startsWith(BASE_URL) && href.includes('/checkouts/'),\n};\n","import ShopifyDriver from './_base';\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\t// code applied dynamically without refreshing page\n\t\tthis.loadPageDynamic = true;\n\t}\n};\n\nexport default {\n\tname: 'Florists',\n\tdomain: 'florists.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith('https://www.florists.com/') && href.includes('/checkouts/');\n\t},\n};\n","import ShopifyDriver from './_base';\n\nconst Driver = class Driver extends ShopifyDriver {};\n\nexport default {\n\tname: 'gammaLabs',\n\tdomain: 'gammalabs.net',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith('https://gammalabs.net/') && href.includes('/checkouts/');\n\t},\n};\n","import ShopifyDriver from './_base';\n\nconst Driver = class Driver extends ShopifyDriver {};\n\nexport default {\n\tname: 'Genuine People',\n\tdomain: 'genuine-people.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith('https://genuine-people.com') && href.includes('/checkouts/');\n\t},\n\t// no need to write isCartEmpty() because user can`t go to the checkout page without goods\n};\n","import Promise from 'bluebird';\nimport BaseDriver from '../base';\nimport bus from '../../bus';\nimport { format, DOM, completionActions, log } from '../../../utils';\n\nconst { toFloat, elemToFloat } = format;\nconst { setValue } = DOM;\n\n// This page work with json\n// On the page can be applied normal-discount and special (that's why Set used in getExistingCodes)\n// We can't support page `https://shop.globein.com/a/secure/checkout` because of cors requests for code apply\n// After reloading page code will be removed, so we can't apply code by request at the end of the testing\n// Driver behaviour description:\n// -    Existing code: yes\n// -    Remove code: yes\n// -    Stackable: no\n// -    Free gift support: no\n// -    'isValid' implemented: yes\n// -    Manually apply code: yes\n// -    Is driver SPA and add the condition to show popup: no\nconst DOMAIN = 'globein.com';\n\nconst NotTemplateDriver = class Driver extends BaseDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.REQUEST_HEADERS = null;\n\t\tthis.XPID_REGEX = new RegExp(/xpid/);\n\t\tthis.XPID_REGEX_SELECTOR = new RegExp(/xpid:\"(.*?)\"/);\n\t\tthis.bodyData = null;\n\t\tthis.COUNTRY_SELECTOR = '.shipping-form select.country';\n\t\tthis.APPLIED_CODE_SELECTOR = '.discount-applied .code';\n\t\tthis.APPLY_BUTTON_SELECTOR = '.submit-discount';\n\t\tthis.CODE_INPUT_SELECTOR = '.discount-code';\n\t\tthis.TOTAL_SELECTOR = '.value-total';\n\t\tthis.REQUEST_URL = `https://${DOMAIN}/subscription/get-price`;\n\t}\n\n\tbeforeTestCodes() {\n\t\tthis.REQUEST_HEADERS = {\n\t\t\t'X-Requested-With': 'XMLHttpRequest',\n\t\t};\n\t\tconst url = new URL(window.location.href);\n\t\tthis.bodyData = new URLSearchParams({\n\t\t\tgiftbox_type: url.searchParams.get('giftbox_type'),\n\t\t\tcoupon_code: '',\n\t\t\tcountry: document.querySelector(this.COUNTRY_SELECTOR).value,\n\t\t\tis_recurrent: url.searchParams.get('is_recurrent'),\n\t\t});\n\t\treturn Promise.resolve();\n\t}\n\n\tgetExistingCodes() {\n\t\tconst codes = new Set(\n\t\t\t[...document.querySelectorAll(this.APPLIED_CODE_SELECTOR)]\n\t\t\t\t.map(codeElement => codeElement.innerText.trim())\n\t\t\t\t.filter(Boolean),\n\t\t);\n\n\t\treturn {\n\t\t\tcodes: [...codes],\n\t\t\tcodeCount: codes.size,\n\t\t};\n\t}\n\n\tremoveCodes() {\n\t\treturn this._removeCode().then(responseJSON => this._parseTotal(responseJSON));\n\t}\n\n\tcheckCodes(codes, originalPrice = this._parseTotal()) {\n\t\tlog(`Original price: ${originalPrice}`);\n\n\t\treturn Promise.each(codes, code => {\n\t\t\tconst result = {\n\t\t\t\tcode,\n\t\t\t\tfinalPrice: originalPrice,\n\t\t\t\tfinalDiscount: 0,\n\t\t\t\tisValid: true,\n\t\t\t};\n\t\t\treturn this._applyCode(code).then(responseJSON => {\n\t\t\t\tif (this._codeAppliedCheck(responseJSON)) {\n\t\t\t\t\tresult.isValid = false;\n\t\t\t\t\treturn bus.$emit('code-checked', result);\n\t\t\t\t}\n\n\t\t\t\tresult.finalPrice = this._parseTotal(responseJSON);\n\t\t\t\tresult.finalDiscount = originalPrice - result.finalPrice;\n\n\t\t\t\treturn bus.$emit('code-checked', result);\n\t\t\t});\n\t\t});\n\t}\n\n\tapplyCodes(codes) {\n\t\treturn this._manuallyApplyCode(codes[0]);\n\t}\n\n\t_manuallyApplyCode(code) {\n\t\tconst applyButton = document.querySelector(this.APPLY_BUTTON_SELECTOR);\n\t\tconst codesInput = document.querySelector(this.CODE_INPUT_SELECTOR);\n\t\tsetValue(codesInput, code);\n\t\tapplyButton.click();\n\t\treturn Promise.resolve();\n\t}\n\n\t_removeCode() {\n\t\treturn this._applyCode('');\n\t}\n\n\t_applyCode(code) {\n\t\tthis.bodyData.set('coupon_code', code);\n\t\treturn fetch(this.REQUEST_URL, {\n\t\t\tmethod: 'POST',\n\t\t\tcredentials: 'include',\n\t\t\theaders: this.REQUEST_HEADERS,\n\t\t\tbody: this.bodyData,\n\t\t}).then(response => response.json());\n\t}\n\n\t_codeAppliedCheck(data) {\n\t\treturn Boolean(data.message);\n\t}\n\n\t_parseTotal(data = false) {\n\t\tif (data) {\n\t\t\treturn toFloat(data.total) / 100;\n\t\t}\n\t\treturn elemToFloat(document.querySelector(this.TOTAL_SELECTOR));\n\t}\n};\n\nexport default {\n\tname: 'GlobeIn',\n\tdomain: 'globein.com',\n\tcompletionAction: completionActions.none,\n\tDriver: NotTemplateDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.includes('/subscription') && document.querySelector('.discount-code');\n\t},\n};\n","import ShopifyDriver from './_base';\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.FORM_SELECTOR = '.order-summary__section--discount form:first-of-type';\n\t}\n};\n\nexport default {\n\tname: 'Inchbug',\n\tdomain: 'inchbug.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith('https://www.inchbug.com/') && href.includes('/checkouts/');\n\t},\n\t// no need to write isCartEmpty() because user can`t go to the checkout page without goods\n};\n","import activerideshop from './activerideshop.com';\nimport bebe from './bebe.com';\nimport bellamihair from './bellamihair.com';\nimport bestchoiceproducts from './bestchoiceproducts.com';\nimport bhcosmetics from './bhcosmetics.com';\nimport bluemercury from './bluemercury.com';\nimport bodycandy from './bodycandy.com';\nimport bombas from './bombas.com';\nimport bpisports from './bpisports.com';\nimport brayola from './brayola.com';\nimport bulletproof from './bulletproof.com';\nimport chubbiesshorts from './chubbiesshorts.com';\nimport cotopaxi from './cotopaxi.com';\nimport cuddlduds from './cuddlduds.com';\nimport dressbarn from './dressbarn.com';\nimport edensgarden from './edensgarden.com';\nimport efavormart from './efavormart.com';\nimport eluxury from './eluxury.com';\nimport enfamil from './enfamil.com';\nimport entertainment from './entertainment.com';\nimport fashionnova from './fashionnova.com';\nimport fitFresh from './fit-fresh.com';\nimport flattummyco from './flattummyco.com';\nimport florists from './florists.com';\nimport gammalabs from './gammalabs.net';\nimport genuinePeople from './genuine-people.com';\nimport globein from './globein.com';\nimport inchbug from './inchbug.com';\nimport juicebeauty from './juicebeauty.com';\nimport lavishalice from './lavishalice.com';\nimport lillap from './lillap.com';\nimport lootcrate from './lootcrate.com';\nimport magnolia from './magnolia.com';\nimport marika from './marika.com';\nimport measurabledifference from './measurabledifference.com';\nimport milanicosmetics from './milanicosmetics.com';\nimport morphebrushes from './morphebrushes.com';\nimport mvmtwatches from './mvmtwatches.com';\nimport myrume from './myrume.com';\nimport outdoorvoices from './outdoorvoices.com';\nimport qalo from './qalo.com';\nimport radioshack from './radioshack.com';\nimport rebeccaminkoff from './rebeccaminkoff.com';\nimport renskincare from './renskincare.com';\nimport roadid from './roadid.com';\nimport shethinx from './shethinx.com';\nimport silkn from './silkn.com';\nimport soylent from './soylent.com';\nimport stevemadden from './stevemadden.com';\nimport thecolorrun from './thecolorrun.com';\nimport tableclothsfactory from './tableclothsfactory.com';\nimport teefury from './teefury.com';\nimport thefryecompany from './thefryecompany.com';\nimport tonyrobbins from './tonyrobbins.com';\nimport untuckit from './untuckit.com';\nimport uspoloassn from './uspoloassn.com';\nimport usa1more from './usa.1more.com';\nimport vanityplanet from './vanityplanet.com';\nimport violife from './violife.com';\nimport volcom from './volcom.com';\nimport wetseal from './wetseal.com';\nimport wildfox from './wildfox.com';\nimport windsorstore from './windsorstore.com';\n\nexport default [\n\tactiverideshop,\n\tbebe,\n\tbellamihair,\n\tbestchoiceproducts,\n\tbhcosmetics,\n\tbluemercury,\n\tbodycandy,\n\tbombas,\n\tbpisports,\n\tbrayola,\n\tbulletproof,\n\tchubbiesshorts,\n\tcotopaxi,\n\tcuddlduds,\n\tdressbarn,\n\tedensgarden,\n\tefavormart,\n\teluxury,\n\tenfamil,\n\tentertainment,\n\tfashionnova,\n\tfitFresh,\n\tflattummyco,\n\tflorists,\n\tgenuinePeople,\n\tgammalabs,\n\tglobein,\n\tinchbug,\n\tjuicebeauty,\n\tlavishalice,\n\tlillap,\n\tlootcrate,\n\tmagnolia,\n\tmarika,\n\tmeasurabledifference,\n\tmilanicosmetics,\n\tmorphebrushes,\n\tmvmtwatches,\n\tmyrume,\n\toutdoorvoices,\n\tqalo,\n\tradioshack,\n\trebeccaminkoff,\n\trenskincare,\n\troadid,\n\tshethinx,\n\tsilkn,\n\tsoylent,\n\tstevemadden,\n\tthecolorrun,\n\ttableclothsfactory,\n\tteefury,\n\tthefryecompany,\n\ttonyrobbins,\n\tuntuckit,\n\tuspoloassn,\n\tusa1more,\n\tvanityplanet,\n\tviolife,\n\tvolcom,\n\twetseal,\n\twildfox,\n\twindsorstore,\n];\n","import ShopifyDriver from './_base';\n\nconst BASE_URL = window.location.origin;\n/* Behavior description:\n * We can apply only one code\n * We can get and remove existing code\n * We can apply codes only on checkout pages\n */\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t}\n};\n\nexport default {\n\tname: 'Juice Beauty',\n\tdomain: 'juicebeauty.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith(BASE_URL) && href.includes('/checkouts/');\n\t},\n};\n","import ShopifyDriver from './_base';\nimport { DOM } from '../../../utils';\n\nconst { extractFormValues, extractFromHTML, extractElement } = DOM;\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.APPLIED_CODE_SELECTOR = '.reduction-code__text';\n\t}\n\n\tbeforeTestCodes() {\n\t\tsuper.beforeTestCodes();\n\t\tthis.bodyData = extractFormValues('.order-summary__section--discount form:first-of-type');\n\t}\n\n\t// on checkout site show total with pounds, method toFloat() work only with $\n\t_myToFloat(moneyString) {\n\t\tif (typeof moneyString === 'number') {\n\t\t\treturn moneyString;\n\t\t}\n\t\t// comma replacement is necessary to not drop things post-comma\n\t\t// negation and dollar and pound signs replacement get it to numeric\n\t\tconst cleanString = moneyString.trim().replace(/[-($|£),]/g, '');\n\t\treturn parseFloat(cleanString);\n\t}\n\n\t_parseTotal(data) {\n\t\tlet totalSumm = null;\n\t\tif (this.IS_ON_SHIPPING) {\n\t\t\tconst shippingPriceIndex = this._getShippingSelectorIndex();\n\t\t\tconst shippingRateSelector = `.content-box__row:nth-of-type(${shippingPriceIndex + 1}) .input-radio`;\n\t\t\ttotalSumm = data\n\t\t\t\t? extractFromHTML(data, shippingRateSelector, null, this.CHECKOUT_TOTAL_SELECTOR_ATTRIBUTE)\n\t\t\t\t: document.querySelector(shippingRateSelector).getAttribute(this.CHECKOUT_TOTAL_SELECTOR_ATTRIBUTE);\n\t\t} else {\n\t\t\ttotalSumm = data\n\t\t\t\t? extractElement(this.TOTAL_SELECTOR, data)\n\t\t\t\t: document.querySelector(this.TOTAL_SELECTOR).textContent;\n\t\t}\n\t\treturn this._myToFloat(totalSumm);\n\t}\n};\n\nexport default {\n\tname: 'Lavish Alice',\n\tdomain: 'lavishalice.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith('https://lavishalice.com/') && href.includes('/checkouts/');\n\t},\n};\n","import ShopifyDriver from './_base';\n\n/* Driver behaviour description:\n•    Existing code: yes\n•    Remove code: yes\n•    Stackable: no\n•    Free gift support: no\n•    'isValid' implemented: yes */\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.APPLIED_CODE_SELECTOR = '.tag__text .reduction-code__text';\n\t}\n};\n\nexport default {\n\tname: 'Lilla P',\n\tdomain: 'lillap.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith('https://lillap.com/') && href.includes('/checkouts/');\n\t},\n};\n","import Promise from 'bluebird';\nimport BaseDriverShopify from './_base';\nimport BaseDriverRegular from '../base';\nimport bus from '../../bus';\n\nimport { format, log, completionActions, browserUtils, request, requestTypes } from '../../../utils';\nimport { setValue } from '../../../utils/DOM';\nimport { sessionTimer } from '../../lib';\n\nconst { getCookie } = browserUtils;\nconst { toFloat, elemToFloat } = format;\n\n/* Behavior description:\n+ Existing code: yes\n+ Remove code: yes, apply fake code\n+ Stackable: no\n+ Free gift support: no\n+ Free shipping: no\n+ ‘isValid’ implemented: no\n+ Codes can be replaced by another code: yes\n+ Manually apply code: yes\n+ Pages, where extension works: Checkout and Gift pages, vault.lootcrate.com\n+ Is driver SPA: yes\n+ Gather codes on site pages: yes(Checkout and Gift pages),  vault.lootcrate.com - no\n*/\n\nconst isOnGiftPage = window.location.href.includes('gift');\nconst isOnSecondMerchantVersion = () => window.location.href.includes('cart');\nconst isOnShopifyDriver = window.location.href.includes('vault.lootcrate.com');\nconst MERCHANT_CODE_SELECTOR = 'usi_site_coupon';\nconst API_URL = 'https://api.lootcrate.com';\nconst checkoutDriver = class Driver extends BaseDriverRegular {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.TOTAL_PRICE_SELECTOR = '#subscription-today-total';\n\t\tthis.INPUT_FIELD = '#checkout_coupon_code';\n\t\tthis.APPLY_BTN_SELECTOR = '#validate-coupon';\n\t\tthis.APPLY_CODE_BLOCK = '#checkout-show-coupon';\n\t\tthis.APPLIED_CODE_SELECTOR = '.subscription-coupon-text';\n\t\tthis.APPLIED_CODE_REGEX = /Coupon: (.*)/i;\n\t\tthis.CSRF_TOKEN_REGEX = /csrf_token=\"([^\"]*)\"/;\n\t\tthis.SESSION_ID_SELECTOR = 'session_id';\n\t\tthis.CART_ID_SELECTOR = 'cart_id';\n\t\tthis.GET_TOKEN_REQUEST_URL = 'https://www.lootcrate.com//session_tokens';\n\n\t\tthis.SHIPPING_PAGE_SELECTOR = '[name*=shipping_address]';\n\t\tthis.BILLING_PAGE_SELECTOR = '#billingInfo';\n\t\tthis.BILLING_FORM_ACTIVE_SELECTOR = '#newBillingAddress';\n\t\tthis.COUNTRY_SELECTOR = '.all-countries .selector-content select';\n\t\tthis.SHIP_COUNTRY_SELECTOR = 'shipping_address_country';\n\t\tthis.SHIP_CITY_SELECTOR = 'shipping_address_city';\n\t\tthis.SHIP_STATE_SELECTOR = 'shipping_address_state';\n\t\tthis.SHIP_ZIP_SELECTOR = 'shipping_address_zip';\n\t\tthis.SHIP_ADDRESS_1_SELECTOR = 'shipping_address_line_1';\n\t\tthis.SHIP_ADDRESS_2_SELECTOR = 'shipping_address_line_2';\n\t\tthis.BILLING_COUNTRY_SELECTOR = 'billing_address_country';\n\t\tthis.BILLING_ZIP_SELECTOR = 'billing_address_zip';\n\t\tthis.BILLING_VISITED_SELECTOR = 'billing_page_visited';\n\n\t\tthis.FLOW_COUNT = 0;\n\n\t\trequest.setType(requestTypes.embedded);\n\t}\n\n\twatchForCartUrl() {\n\t\tconst interval = super.watchForCartUrl();\n\t\tsessionTimer.initialize({\n\t\t\tactionInterval: interval,\n\t\t\ttimeout: 15,\n\t\t});\n\t}\n\n\tcheckCondition() {\n\t\tif (document.querySelector(this.TOTAL_PRICE_SELECTOR)) {\n\t\t\t// need to set this information in sessionStorage, because need to use it on other page to send request\n\t\t\tif (document.querySelector(this.SHIPPING_PAGE_SELECTOR)) {\n\t\t\t\tthis._setSesionStorageItems(\n\t\t\t\t\tthis.SHIP_COUNTRY_SELECTOR,\n\t\t\t\t\tthis.SHIP_CITY_SELECTOR,\n\t\t\t\t\tthis.SHIP_STATE_SELECTOR,\n\t\t\t\t\tthis.SHIP_ZIP_SELECTOR,\n\t\t\t\t\tthis.SHIP_ADDRESS_1_SELECTOR,\n\t\t\t\t\tthis.SHIP_ADDRESS_2_SELECTOR,\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (document.querySelector(this.BILLING_FORM_ACTIVE_SELECTOR)) {\n\t\t\t\tthis._setSesionStorageItems(this.BILLING_COUNTRY_SELECTOR, this.BILLING_ZIP_SELECTOR);\n\t\t\t}\n\t\t\t// need to check if user visited billing, because after this need to send shipping information in request\n\t\t\tif (sessionStorage.getItem(this.BILLING_VISITED_SELECTOR) === 'false' || this.FLOW_COUNT < 1) {\n\t\t\t\tsessionStorage.setItem(\n\t\t\t\t\tthis.BILLING_VISITED_SELECTOR,\n\t\t\t\t\tBoolean(document.querySelector(this.BILLING_PAGE_SELECTOR)),\n\t\t\t\t);\n\t\t\t\tthis.FLOW_COUNT += 1;\n\t\t\t}\n\t\t}\n\t\tconst { cookieEnabled } = window.navigator;\n\t\tconst selectedCountry = document.querySelector(this.COUNTRY_SELECTOR);\n\t\tconst isUS = selectedCountry && selectedCountry.value === 'US';\n\t\tconst total = (document.querySelector(this.TOTAL_PRICE_SELECTOR) || {}).offsetParent;\n\t\treturn total && isUS && cookieEnabled;\n\t}\n\n\tbeforeTestCodes() {\n\t\t[, this.CSRF_TOKEN] = [...document.querySelectorAll('script')]\n\t\t\t.find(element => element.text.match(this.CSRF_TOKEN_REGEX))\n\t\t\t.text.match(this.CSRF_TOKEN_REGEX);\n\n\t\tconst shippingInfo = this._getShippingInfo();\n\t\tif (isOnSecondMerchantVersion()) {\n\t\t\tthis.CART_ID = sessionStorage.getItem(this.CART_ID_SELECTOR);\n\t\t\tthis.bodyData = {\n\t\t\t\t...shippingInfo,\n\t\t\t\tsession_id: sessionStorage.getItem(this.SESSION_ID_SELECTOR),\n\t\t\t\tid: this.CART_ID,\n\t\t\t};\n\t\t\treturn this._setupAccessToken();\n\t\t}\n\n\t\tconst scripts = [...document.querySelectorAll('script')];\n\t\tconst options = scripts\n\t\t\t.map(el => el.textContent.match(/gon\\.option_values=\\[([\",0-9]+)/))\n\t\t\t.filter(Boolean)[0][1]\n\t\t\t.replace(/\"/g, '');\n\t\tconst plan = scripts\n\t\t\t.map(el => el.textContent.match(/gon\\.plan_name=\"([a-z0-9-]+)/))\n\t\t\t.filter(Boolean)[0][1]\n\t\t\t.replace(/\"/g, '');\n\t\tthis.bodyData = {\n\t\t\t...shippingInfo,\n\t\t\taddons: [],\n\t\t\tcurrency: 'USD',\n\t\t\texpand: ['product', 'plan', 'shipping_cycle'],\n\t\t\tplan_name: plan,\n\t\t\toption_values: options,\n\t\t};\n\t\treturn this._setupAccessToken();\n\t}\n\n\tgetMerchantCodes() {\n\t\treturn [getCookie(MERCHANT_CODE_SELECTOR)].filter(Boolean);\n\t}\n\n\tgetExistingCodes() {\n\t\tconst codes = [...document.querySelectorAll(this.APPLIED_CODE_SELECTOR)]\n\t\t\t.map(el => {\n\t\t\t\tconst codeMatch = el.innerText.match(this.APPLIED_CODE_REGEX);\n\t\t\t\treturn codeMatch ? codeMatch[1] : null;\n\t\t\t})\n\t\t\t.filter(el => Boolean(el) && el !== 'null');\n\n\t\treturn {\n\t\t\tcodes: [...new Set(codes)],\n\t\t\tcodeCount: codes.length,\n\t\t};\n\t}\n\n\tremoveCodes() {\n\t\treturn this._removeCode().then(response => this._parseTotal(response));\n\t}\n\n\tcheckCodes(codes, originalPrice = this._parseTotal()) {\n\t\tlog(`Original price: ${originalPrice}`);\n\t\treturn Promise.each(codes, code => {\n\t\t\tconst result = {\n\t\t\t\tcode,\n\t\t\t\tfinalPrice: originalPrice,\n\t\t\t\tfinalDiscount: 0,\n\t\t\t};\n\t\t\treturn this._applyCode(code).then(responseJSON => {\n\t\t\t\tif (typeof responseJSON === 'string') {\n\t\t\t\t\treturn bus.$emit('code-checked', result);\n\t\t\t\t}\n\t\t\t\tresult.finalPrice = this._parseTotal(responseJSON);\n\t\t\t\tresult.finalDiscount = originalPrice - result.finalPrice;\n\t\t\t\treturn this._removeCode().then(() => bus.$emit('code-checked', result));\n\t\t\t});\n\t\t});\n\t}\n\n\tapplyCodes(codes) {\n\t\tif (document.querySelector(this.APPLY_CODE_BLOCK)) {\n\t\t\tdocument.querySelector(this.APPLY_CODE_BLOCK).click();\n\t\t}\n\t\tsetValue(document.querySelector(this.INPUT_FIELD), codes[0]);\n\t\tdocument.querySelector(this.APPLY_BTN_SELECTOR).click();\n\t}\n\n\t_manageCode(code = '', url) {\n\t\tconst requestUrl = isOnSecondMerchantVersion()\n\t\t\t? `${API_URL}/v2/shopping_carts/${this.CART_ID}/checkout_preview`\n\t\t\t: `${API_URL}/v1/carts/preview`;\n\t\tthis.bodyData.coupon_code = code;\n\t\tthis.requestOptions = {\n\t\t\theaders: {\n\t\t\t\taccept: 'application / json',\n\t\t\t\t'content-type': 'application/json',\n\t\t\t\tauthorization: `Bearer ${this.ACCESS_TOKEN}`,\n\t\t\t},\n\t\t};\n\t\treturn request\n\t\t\t.post(url || requestUrl, JSON.stringify(this.bodyData), this.requestOptions)\n\t\t\t.then(response => response.json());\n\t}\n\n\t_applyCode(code) {\n\t\treturn this._manageCode(code);\n\t}\n\n\t_removeCode() {\n\t\treturn this._manageCode();\n\t}\n\n\t_getAccessToken() {\n\t\tconst requestOptions = {\n\t\t\theaders: {\n\t\t\t\taccept: 'application / json',\n\t\t\t\t'content-type': 'application/json',\n\t\t\t\t'x-csrf-token': this.CSRF_TOKEN,\n\t\t\t\t'x-requested-with': 'XMLHttpRequest',\n\t\t\t},\n\t\t};\n\t\treturn request.post(this.GET_TOKEN_REQUEST_URL, null, requestOptions).then(response => response.json());\n\t}\n\n\t_setupAccessToken() {\n\t\t// eslint-disable-next-line no-return-assign\n\t\treturn this._getAccessToken().then(responseJSON => (this.ACCESS_TOKEN = responseJSON.token));\n\t}\n\n\t_getShippingInfo() {\n\t\t// before user visit billing page information isn't setup\n\t\t// need to check if user has already visited Billing page\n\t\tconst isBillingPageVisited = sessionStorage.getItem(this.BILLING_VISITED_SELECTOR) === 'true';\n\t\tconst shippingInfo = isBillingPageVisited\n\t\t\t? {\n\t\t\t\t\tbilling_address_country: sessionStorage.getItem(this.BILLING_COUNTRY_SELECTOR)\n\t\t\t\t\t\t? sessionStorage.getItem(this.BILLING_COUNTRY_SELECTOR)\n\t\t\t\t\t\t: sessionStorage.getItem(this.SHIP_COUNTRY_SELECTOR),\n\t\t\t\t\tbilling_address_zip: sessionStorage.getItem(this.BILLING_ZIP_SELECTOR)\n\t\t\t\t\t\t? sessionStorage.getItem(this.BILLING_ZIP_SELECTOR)\n\t\t\t\t\t\t: sessionStorage.getItem(this.SHIP_ZIP_SELECTOR),\n\t\t\t\t\tshipping_address_country: sessionStorage.getItem(this.SHIP_COUNTRY_SELECTOR),\n\t\t\t\t\tshipping_address_city: sessionStorage.getItem(this.SHIP_CITY_SELECTOR),\n\t\t\t\t\tshipping_address_state: sessionStorage.getItem(this.SHIP_STATE_SELECTOR),\n\t\t\t\t\tshipping_address_zip: sessionStorage.getItem(this.SHIP_ZIP_SELECTOR),\n\t\t\t\t\tshipping_address_line_1: sessionStorage.getItem(this.SHIP_ADDRESS_1_SELECTOR),\n\t\t\t\t\tshipping_address_line_2: sessionStorage.getItem(this.SHIP_ADDRESS_2_SELECTOR),\n\t\t\t  }\n\t\t\t: {};\n\t\treturn shippingInfo;\n\t}\n\n\t_setSesionStorageItems(...itemSelectors) {\n\t\titemSelectors.forEach(el => sessionStorage.setItem(el, document.querySelector(`[name*=${el}]`).value));\n\t}\n\n\t_parseTotal(response) {\n\t\tif (response) {\n\t\t\tif (isOnSecondMerchantVersion()) {\n\t\t\t\treturn toFloat(response.data.total_amount.data.amount);\n\t\t\t}\n\t\t\treturn toFloat(response.total_amount.amount);\n\t\t}\n\t\treturn elemToFloat(document.querySelector(this.TOTAL_PRICE_SELECTOR));\n\t}\n};\n\nconst giftDriver = class Driver extends BaseDriverRegular {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.TOTAL_PRICE_SELECTOR = '#order-summary .text-right';\n\t\tthis.ZIP_CODE_INPUT_SELECTOR = '#checkout_shipping_address_zip';\n\t\tthis.CODE_INPUT_SELECTOR = '#checkout_coupon_code';\n\t\tthis.CODE_INPUT_BTN_SELECTOR = '#validate-coupon';\n\t\tthis.CODE_INPUT_BLOCK = '#collapseFour';\n\t\tthis.SECTION_PLAN_SELECTOR = '#section-plans div.active';\n\t\tthis.CODE_VALIDATION_INFO = '.coupon-amount';\n\n\t\tthis.COUNTRY_SELECTOR = '.all-countries .selector-content select';\n\t\tthis.requestOptions = {\n\t\t\theaders: {\n\t\t\t\taccept: 'application/json',\n\t\t\t\t'content-type': 'application/json',\n\t\t\t},\n\t\t};\n\t\trequest.setType(requestTypes.embedded);\n\t}\n\n\tcheckCondition() {\n\t\tconst selectedCountry = document.querySelector(this.COUNTRY_SELECTOR);\n\t\tconst isUS = selectedCountry && selectedCountry.value === 'US';\n\t\tconst codeInput = document.querySelector(this.CODE_INPUT_BLOCK);\n\t\tconst codeInputDisplayed = codeInput && codeInput.offsetParent;\n\t\tconst showPopup = codeInputDisplayed && isOnGiftPage;\n\t\tconst currentState = codeInputDisplayed && showPopup && isUS;\n\t\treturn currentState;\n\t}\n\n\tbeforeTestCodes() {\n\t\tconst PLAN_ID = toFloat(\n\t\t\tdocument\n\t\t\t\t.querySelector(this.SECTION_PLAN_SELECTOR)\n\t\t\t\t.getAttribute('id')\n\t\t\t\t.match(/\\d+/)[0],\n\t\t);\n\t\tconst SHIPPING = document.querySelector(this.ZIP_CODE_INPUT_SELECTOR).value;\n\t\tthis.params = {\n\t\t\tplan_id: PLAN_ID,\n\t\t\tshipping_address_zip: SHIPPING,\n\t\t};\n\t\treturn Promise.resolve();\n\t}\n\n\tgetMerchantCodes() {\n\t\treturn [getCookie(MERCHANT_CODE_SELECTOR)].filter(Boolean);\n\t}\n\n\tgetExistingCodes() {\n\t\tconst codes = [document.querySelector(this.CODE_INPUT_SELECTOR).value].filter(el => el.length);\n\t\treturn {\n\t\t\tcodes,\n\t\t\tcodeCount: codes.length,\n\t\t};\n\t}\n\n\tbeforeCheckCodes() {\n\t\treturn this._applyCode('REMOVE_CODE').then(response => this._parseTotal(response));\n\t}\n\n\tcheckCodes(codes, originalPrice) {\n\t\tlog(`Original price: ${originalPrice}`);\n\t\treturn Promise.each(codes, code =>\n\t\t\tthis._applyCode(code).then(response => {\n\t\t\t\tconst finalPrice = this._parseTotal(response);\n\t\t\t\tconst finalDiscount = originalPrice - finalPrice;\n\t\t\t\treturn bus.$emit('code-checked', { code, finalPrice, finalDiscount });\n\t\t\t}),\n\t\t);\n\t}\n\n\tapplyCodes(codes) {\n\t\tconst codeInput = document.querySelector(this.CODE_INPUT_SELECTOR);\n\t\tconst codeButton = document.querySelector(this.CODE_INPUT_BTN_SELECTOR);\n\t\tcodeInput.dispatchEvent(new Event('focus'));\n\t\tsetValue(codeInput, codes[0], 'change');\n\t\tcodeButton.disabled = false;\n\t\tcodeButton.click();\n\t\treturn Promise.resolve();\n\t}\n\n\t_applyCode(code) {\n\t\tthis.params.coupon_code = code;\n\t\treturn request\n\t\t\t.post(`${API_URL}/v1/carts/preview`, JSON.stringify(this.params), this.requestOptions)\n\t\t\t.then(response => response.json());\n\t}\n\n\t_parseTotal(response) {\n\t\treturn toFloat(response.total_amount.amount);\n\t}\n};\n\nconst shopifyDriver = class Driver extends BaseDriverShopify {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t}\n\n\tcheckCondition() {\n\t\tconst { href } = window.location;\n\t\tconst checkoutURL =\n\t\t\thref.startsWith('https://vault.lootcrate.com') &&\n\t\t\thref.includes('/checkouts/') &&\n\t\t\t!href.includes('stock_problems');\n\t\treturn checkoutURL;\n\t}\n\n\twatchForCartUrl() {\n\t\tconst interval = super.watchForCartUrl();\n\t\tsessionTimer.initialize({\n\t\t\tactionInterval: interval,\n\t\t\ttimeout: 15,\n\t\t});\n\t}\n\n\tbeforeTestCodes() {\n\t\tsuper.beforeTestCodes();\n\t\tbus.$emit('change-completion-action', completionActions.default);\n\t}\n};\n\nexport default {\n\tname: 'Loot Crate',\n\tdomain: 'lootcrate.com',\n\tisSinglePageApp: true,\n\tmaxCoupons: isOnShopifyDriver ? 8 : 15,\n\tcompletionAction: completionActions.none,\n\tget Driver() {\n\t\tif (isOnShopifyDriver) {\n\t\t\treturn shopifyDriver;\n\t\t}\n\t\tif (isOnGiftPage) {\n\t\t\treturn giftDriver;\n\t\t}\n\t\treturn checkoutDriver;\n\t},\n};\n","import Promise from 'bluebird';\nimport ShopifyDriver from './_base';\nimport backgroundMessaging from '../../lib/background-messaging';\nimport { DOM, format } from '../../../utils';\n\nconst { extractFormValues, extractElement, extractFromHTML } = DOM;\nconst { toFloat, elemToFloat } = format;\n\nconst DOMAIN = 'shop.magnolia.com';\n/*\n\tDriver behavior description:\n\t+ Existing code: yes\n\t+ Remove code: yes\n\t+ Stackable: no\n\t+ Free gift support: no\n\t+ Free shipping: no\n\t+ ‘isValid’ implemented: yes\n\t+ Codes can be replaced by another code: yes (valid ones only)\n\t+ Manually apply code: no\n\t+\n\t+ Pages, where extension works:\n\t\t- Сheckout steps\n\t+ Is driver SPA yes\n\t+ Gather codes on site pages: no\n\t+ Special case about the driver works (if it needed).\n\t\t- we can remove code or we can replace old code with new one\n \t\t- can be run twice on the 1 step and twice on the last step.\n*/\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t\tthis.contactInfoStep = false;\n\t\tthis.APPLIED_CODE_SELECTOR = '.order-summary__section--discount .reduction-code__text';\n\t\tthis.CONTACT_INFO_FORM_SELECTOR = '.edit_checkout:first-child';\n\t\tthis.TAX_HIDDEN_SELECTOR = '.total-line--taxes.hidden';\n\t\tthis.TAX_SELECTOR = '.total-line--taxes .total-line__price';\n\t\tthis.CONTACT_INFO_FORM_SELECTOR = '.edit_checkout:first-child';\n\t\tthis.isTaxHidden = false;\n\t\tthis.STEP_SELECTOR = '.step';\n\t\tthis.step = null;\n\n\t\tthis.DISABLE_TIME_MS = 20 * 60 * 1000; // 20 minutes\n\n\t\tthis.IS_SOLD_OUT_SELECTOR = '.product__status--sold-out';\n\t\tthis.SHIPPING_EL_SELECTOR = '.total-line--shipping .order-summary__emphasis';\n\t}\n\n\tasync checkCondition() {\n\t\tconst isRightUrl = window.location.href.includes('/checkouts/');\n\t\tconst stepElement = document.querySelector(this.STEP_SELECTOR);\n\t\tthis.step = stepElement && stepElement.dataset.step;\n\t\tlet isNotMaxCodeTesting = false;\n\t\tif (this.step) {\n\t\t\tconst driverStorage = await backgroundMessaging.getDriverStorage(DOMAIN);\n\t\t\tif (driverStorage) {\n\t\t\t\tconst dataExpired = Date.now() - driverStorage.lastTestTimestamp >= this.DISABLE_TIME_MS;\n\t\t\t\tif (dataExpired) {\n\t\t\t\t\tbackgroundMessaging.deleteDriverStorage(DOMAIN);\n\t\t\t\t\tisNotMaxCodeTesting = true;\n\t\t\t\t} else {\n\t\t\t\t\t// if there is no info for current step it means that driver hasn't been run on the current page\n\t\t\t\t\tisNotMaxCodeTesting = (driverStorage[this.step] || 0) < 2;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tisNotMaxCodeTesting = true;\n\t\t\t}\n\t\t}\n\t\tconst isSoldOut = document.querySelector(this.IS_SOLD_OUT_SELECTOR);\n\t\tconst isRightStep = this.step !== 'shipping_method' && this.step !== 'thank-you';\n\t\tconst currentState = isRightUrl && !isSoldOut && isRightStep && isNotMaxCodeTesting;\n\n\t\treturn currentState;\n\t}\n\n\tbeforeTestCodes() {\n\t\tif (!this.bodyData) {\n\t\t\tthis.bodyData = extractFormValues(this.FORM_SELECTOR);\n\t\t}\n\t\tthis.CHECKOUT_STEP = document.querySelector('.step');\n\t\tthis.IS_ON_SHIPPING = this.CHECKOUT_STEP\n\t\t\t? this.CHECKOUT_STEP.getAttribute('data-step') === 'shipping_method'\n\t\t\t: false;\n\t\tthis._getShippingSelectorIndex();\n\t\tthis.contactInfoStep =\n\t\t\tthis.step === 'contact_information' && !document.querySelector(this.SHIPPING_EL_SELECTOR);\n\t\tif (this.contactInfoStep) {\n\t\t\tthis.isTaxHidden = !!document.querySelector(this.TAX_HIDDEN_SELECTOR);\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n\n\tbeforeCheckCodes() {\n\t\t// need to send this request to get right total\n\t\treturn this.contactInfoStep\n\t\t\t? this._applyCode('FAKE_CODE')\n\t\t\t\t\t.then(() => this._getCartSummary())\n\t\t\t\t\t.then(responseHTML => this._parseTotal(responseHTML))\n\t\t\t: Promise.resolve();\n\t}\n\n\tasync beforeApplyCodes() {\n\t\tconst driverStorage = await backgroundMessaging.getDriverStorage(DOMAIN);\n\t\tconst currentStorageState = driverStorage || {};\n\t\tconst currentTestingCount = currentStorageState[this.step] || 0;\n\n\t\tbackgroundMessaging.setDriverStorage(DOMAIN, {\n\t\t\t...currentStorageState,\n\t\t\t[this.step]: currentTestingCount + 1,\n\t\t\tlastTestTimestamp: Date.now(),\n\t\t});\n\n\t\treturn Promise.resolve();\n\t}\n\n\t_getCartSummary() {\n\t\tlet contactForm = null;\n\t\tif (this.contactInfoStep) {\n\t\t\tcontactForm = extractFormValues(this.CONTACT_INFO_FORM_SELECTOR).params;\n\t\t}\n\t\treturn fetch(\n\t\t\t`${\n\t\t\t\tthis.contactInfoStep\n\t\t\t\t\t? `${window.location.href.split('?')[0]}?${contactForm.toString()}`\n\t\t\t\t\t: window.location.href\n\t\t\t}`,\n\t\t\t{\n\t\t\t\tmethod: 'GET',\n\t\t\t\tcredentials: 'include',\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\n\t\t\t\t},\n\t\t\t},\n\t\t).then(response => response.text());\n\t}\n\n\t_parseTotal(data) {\n\t\tlet totalSumm = null;\n\t\tif (this.contactInfoStep) {\n\t\t\t// if tax is hidden on the page, we will calculate total without taxes from response\n\t\t\ttotalSumm = this.isTaxHidden\n\t\t\t\t? elemToFloat(extractElement(this.TOTAL_SELECTOR, data)) -\n\t\t\t\t  elemToFloat(extractElement(this.TAX_SELECTOR, data))\n\t\t\t\t: extractElement(this.TOTAL_SELECTOR, data).textContent;\n\t\t} else if (this.IS_ON_SHIPPING) {\n\t\t\tconst shippingRateSelector = `.content-box__row:nth-of-type(${this.shippingPriceIndex + 1}) .input-radio`;\n\t\t\ttotalSumm = data\n\t\t\t\t? extractFromHTML(data, shippingRateSelector, null, this.CHECKOUT_TOTAL_SELECTOR_ATTRIBUTE)\n\t\t\t\t: document.querySelector(shippingRateSelector).getAttribute(this.CHECKOUT_TOTAL_SELECTOR_ATTRIBUTE);\n\t\t} else {\n\t\t\ttotalSumm = data\n\t\t\t\t? extractFromHTML(data, this.TOTAL_SELECTOR)\n\t\t\t\t: document.querySelector(this.TOTAL_SELECTOR).textContent;\n\t\t}\n\t\treturn toFloat(totalSumm);\n\t}\n};\n\nexport default {\n\tname: 'Magnolia',\n\tdomain: 'magnolia.com',\n\tisSinglePageApp: true,\n\tmaxCoupons: 8, // site locks us\n\tDriver,\n\tisOnCartUrl: () => false,\n\t// no need to write isCartEmpty() because user can`t go to the checkout page without goods\n};\n","import ShopifyDriver from './_base';\nimport { sessionTimer } from '../../lib';\n\n/** Behaviour\n * One to one with base\n */\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t}\n\n\tcheckCondition() {\n\t\tconst { href } = window.location;\n\t\tconst checkoutURL =\n\t\t\thref.startsWith('https://www.marika.com') &&\n\t\t\thref.includes('/checkouts/') &&\n\t\t\t!href.includes('stock_problems');\n\t\tconst totalIsPresent =\n\t\t\tdocument.querySelector(this.TOTAL_SELECTOR) && document.querySelector(this.TOTAL_SELECTOR).offsetParent;\n\n\t\treturn checkoutURL && totalIsPresent && document.readyState === 'complete';\n\t}\n\n\twatchForCartUrl() {\n\t\tconst interval = super.watchForCartUrl();\n\t\tsessionTimer.initialize({\n\t\t\tactionInterval: interval,\n\t\t\ttimeout: 15,\n\t\t});\n\t}\n};\n\nexport default {\n\tname: 'Marika',\n\tdomain: 'marika.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisSinglePageApp: true,\n};\n","import ShopifyDriver from './_base';\nimport { format, DOM } from '../../../utils';\n\nconst { toFloat } = format;\nconst { extractFormValues, extractFromHTML } = DOM;\n\n/*\nBehavior description:\n- can get existing codes;\n- can remove codes;\n- valid code can be replaced with another valid code;\n- can't apply multiple codes (not stackable);\n- code testing may be run on 'Checkout' page;\n*/\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.APPLIED_CODE_SELECTOR = '.edit_checkout .reduction-code .reduction-code__text';\n\t\t// some page elements like shipping or taxes may load dynamically after page loaded\n\t\tthis.loadPageDynamic = true;\n\t}\n\n\tbeforeTestCodes() {\n\t\tthis.bodyData = extractFormValues('.order-summary__section--discount form:first-of-type');\n\t\tif (!this.bodyData) {\n\t\t\tthis.bodyData = extractFormValues(this.FORM_SELECTOR);\n\t\t}\n\t\tthis.CHECKOUT_STEP = document.querySelector('.step');\n\t\tthis.IS_ON_SHIPPING = this.CHECKOUT_STEP\n\t\t\t? this.CHECKOUT_STEP.getAttribute('data-step') === 'shipping_method'\n\t\t\t: false;\n\t\tthis._getShippingSelectorIndex();\n\t\treturn Promise.resolve();\n\t}\n\n\t_parseTotal(data) {\n\t\tlet totalSumm = null;\n\t\tif (this.IS_ON_SHIPPING) {\n\t\t\tconst shippingRateSelector = `.content-box__row:nth-of-type(${this.shippingPriceIndex + 1}) .input-radio`;\n\t\t\ttotalSumm = data\n\t\t\t\t? extractFromHTML(data, shippingRateSelector, null, this.CHECKOUT_TOTAL_SELECTOR_ATTRIBUTE)\n\t\t\t\t: document.querySelector(shippingRateSelector).getAttribute(this.CHECKOUT_TOTAL_SELECTOR_ATTRIBUTE);\n\t\t} else {\n\t\t\ttotalSumm = data\n\t\t\t\t? extractFromHTML(data, this.TOTAL_SELECTOR)\n\t\t\t\t: document.querySelector(this.TOTAL_SELECTOR).textContent;\n\t\t}\n\t\t// in some case (on shipping step), we can get null, so we try to get the price from page to prevent error\n\t\treturn toFloat(totalSumm || extractFromHTML(data, this.TOTAL_SELECTOR));\n\t}\n};\n\nexport default {\n\tname: 'Measurable Difference',\n\tdomain: 'measurabledifference.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith('https://www.measurabledifference.com/') && href.includes('/checkouts/');\n\t},\n};\n","import ShopifyDriver from './_base';\nimport { DOM } from '../../../utils';\n\nconst { extractFormValues } = DOM;\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t\tthis.APPLIED_CODE_SELECTOR = '.applied-reduction-code__information';\n\t}\n\n\tbeforeTestCodes() {\n\t\tsuper.beforeTestCodes();\n\t\tthis.bodyData = extractFormValues('.order-summary__section--discount form:first-of-type');\n\t}\n};\n\nexport default {\n\tname: 'MILANI',\n\tdomain: 'milanicosmetics.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith('https://www.milanicosmetics.com/') && href.includes('/checkouts/');\n\t},\n};\n","import Promise from 'bluebird';\nimport ShopifyDriver from './_base';\nimport { DOM, format } from '../../../utils';\n\nconst { extractFormValues, extractData } = DOM;\nconst { toFloat } = format;\n\n/**\nDriver behavior description:\n+ Existing code: yes\n+ Remove code: yes\n+ Stackable:  no\n+ Free gift support:  no\n+ Free shipping: no\n+ ‘isValid’ implemented: yes\n+ Pages, where extension works: checkout\n+ Is driver SPA yes\n+ Gather codes on site pages:  no\n */\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\t// code applied dynamically without refreshing page\n\n\t\tthis.loadPageDynamic = true;\n\n\t\tthis.FORM_SELECTOR = '.order-summary__section--discount form';\n\t\tthis.currentShippingQuantity = null;\n\t\tthis.responseShippingQuantity = null;\n\t\tthis.restoreShippingMethod = true;\n\t}\n\n\tcheckCondition() {\n\t\tconst { href } = window.location;\n\t\tconst isOnCartUrl = href.startsWith('https://www.morphe.com/') && href.includes('/checkouts/');\n\t\tconst readyState = document.querySelector('#checkout_reduction_code');\n\t\tconst completeBtn = document.querySelector('[data-trekkie-id=\"complete_order_button\"]');\n\t\treturn isOnCartUrl && ((readyState && readyState.offsetParent) || (completeBtn && readyState));\n\t}\n\n\tbeforeTestCodes() {\n\t\tif (!this.bodyData) {\n\t\t\tthis.bodyData = extractFormValues(this.FORM_SELECTOR);\n\t\t}\n\t\tthis.CHECKOUT_STEP = document.querySelector('.step');\n\t\tthis.IS_ON_SHIPPING = this.CHECKOUT_STEP\n\t\t\t? this.CHECKOUT_STEP.getAttribute('data-step') === 'shipping_method'\n\t\t\t: false;\n\t\tif (this.IS_ON_SHIPPING) {\n\t\t\tthis.currentShippingQuantity = this._checkShipping();\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n\n\t_checkShipping(data) {\n\t\treturn extractData('.input-radio', data, true).length;\n\t}\n\n\t_parseTotal(data) {\n\t\tlet totalSumm = null;\n\t\tif (this.IS_ON_SHIPPING) {\n\t\t\tthis.responseShippingQuantity = this._checkShipping(data);\n\t\t\tlet shippingPriceIndex = this._getShippingSelectorIndex();\n\t\t\tif (this.currentShippingQuantity < this.responseShippingQuantity) {\n\t\t\t\tshippingPriceIndex += 1;\n\t\t\t} else if (this.currentShippingQuantity > this.responseShippingQuantity) {\n\t\t\t\tshippingPriceIndex -= 1;\n\t\t\t}\n\t\t\tconst shippingRateSelector = `.content-box__row:nth-of-type(${shippingPriceIndex + 1}) .input-radio`;\n\t\t\ttotalSumm = data\n\t\t\t\t? extractData(shippingRateSelector, data, false, this.CHECKOUT_TOTAL_SELECTOR_ATTRIBUTE)\n\t\t\t\t: extractData(this.TOTAL_SELECTOR);\n\t\t} else {\n\t\t\ttotalSumm = extractData(this.TOTAL_SELECTOR, data);\n\t\t}\n\t\treturn toFloat(totalSumm);\n\t}\n};\n\nexport default {\n\tname: 'Morphe',\n\tdomain: 'morphe.com',\n\tisSinglePageApp: true,\n\trestoreUserData: true,\n\tmaxCoupons: 6, // driver tests codes slowly\n\tDriver,\n};\n","import Promise from 'bluebird';\nimport ShopifyDriver from './_base';\nimport { sessionTimer } from '../../lib';\nimport { completionActions, DOM, browserUtils } from '../../../utils';\nimport backgroundMessaging from '../../lib/background-messaging';\n\nconst { setValue, extractElement } = DOM;\nconst { wait } = browserUtils;\n\n// Driver behaviour description:\n// •    Existing code: yes\n// •    Remove code: yes\n// •    Stackable: no\n// •    Free gift support: no\n// •    'isValid' implemented: yes\n// •     Codes can be replaced by another code: yes\n// •     manuallyApplyCode: yes\n// •     page where extention works:  Checkout(information step)\n// •     maxCodeTesting 3 for 20 minutes;\n// •     maxCoupons: 8\n// sessionTimer - 15 min\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.DOMAIN = 'https://www.mvmtwatches.com';\n\t\tthis.MERCHANT_CODE_SELECTOR = '.header-nav-top-bar';\n\t\tthis.MERCHANT_CODE_REGEX = /use code[:]?[\\s+]?(.\\w+)/i;\n\t\tthis.getPureTotal = true;\n\t\tthis.CODE_INPUT_SELECTOR = '#checkout_reduction_code';\n\t\tthis.CODE_APPLY_SELECTOR = '.field__input-btn';\n\t\tthis.SHIPPING_EMPTY_SELECTOR = 'button[data-trekkie-id=continue_to_payment_method_button]';\n\t\tthis.IS_CODE_APPLIED_SELECTOR = '.total-line--reduction';\n\t\tthis.DISABLE_TIME_MS = 20 * 60 * 1000; // 20 minutes\n\n\t\tsessionTimer.initialize({\n\t\t\tactionInterval: null,\n\t\t\ttimeout: 15,\n\t\t});\n\t}\n\n\tasync checkCondition() {\n\t\tconst { href } = window.location;\n\n\t\tconst checkoutURL =\n\t\t\thref.startsWith(`${this.DOMAIN}/`) && href.includes('/checkouts/') && !href.includes('thank_you');\n\n\t\tconst pageIsLoaded = document.readyState === 'complete';\n\n\t\tconst toShippingButton = document.querySelector(this.SHIPPING_EMPTY_SELECTOR);\n\n\t\tconst isShippingEmpty = toShippingButton ? toShippingButton.disabled : false;\n\n\t\tconst isItemOutOfStock = href.includes('stock_problems');\n\n\t\tlet isNotMaxCodeTesting = true;\n\t\tconst driverStorage = await backgroundMessaging.getDriverStorage(this.DOMAIN);\n\t\tif (driverStorage) {\n\t\t\tconst dataExpired = Date.now() - driverStorage.lastTestTimestamp >= this.DISABLE_TIME_MS;\n\t\t\tif (dataExpired) {\n\t\t\t\tbackgroundMessaging.deleteDriverStorage(this.DOMAIN);\n\t\t\t} else {\n\t\t\t\tisNotMaxCodeTesting = driverStorage.codeTestingCount < 3;\n\t\t\t}\n\t\t}\n\n\t\treturn checkoutURL && pageIsLoaded && !isShippingEmpty && !isItemOutOfStock && isNotMaxCodeTesting;\n\t}\n\n\tgetMerchantCodes() {\n\t\treturn fetch(this.DOMAIN)\n\t\t\t.then(res => res.text())\n\t\t\t.then(result =>\n\t\t\t\t[...extractElement(this.MERCHANT_CODE_SELECTOR, result, true)]\n\t\t\t\t\t.map(el => el.textContent.match(this.MERCHANT_CODE_REGEX))\n\t\t\t\t\t.filter(Boolean)\n\t\t\t\t\t.map(el => el[1]),\n\t\t\t);\n\t}\n\n\tasync beforeApplyCodes() {\n\t\tconst driverStorage = await backgroundMessaging.getDriverStorage(this.DOMAIN);\n\t\tconst codeTestingCount = driverStorage ? driverStorage.codeTestingCount : 0;\n\t\tbackgroundMessaging.setDriverStorage(this.DOMAIN, {\n\t\t\tcodeTestingCount: codeTestingCount + 1,\n\t\t\tlastTestTimestamp: Date.now(),\n\t\t});\n\t}\n\n\tapplyCodes(codes) {\n\t\tthis._manuallyCodeApply(codes[0]);\n\t\treturn wait(() => document.querySelector(this.IS_CODE_APPLIED_SELECTOR));\n\t}\n\n\tgetPreTaxShippingTotal() {\n\t\treturn Promise.delay(2000).then(() => super.getPreTaxShippingTotal());\n\t}\n\n\t_manuallyCodeApply(code) {\n\t\tsetValue(document.querySelector(this.CODE_INPUT_SELECTOR), code);\n\t\tdocument.querySelector(this.CODE_APPLY_SELECTOR).click();\n\t}\n};\n\nexport default {\n\tname: 'mvmtwatches',\n\tdomain: 'mvmtwatches.com',\n\tisSinglePageApp: true,\n\tcompletionAction: completionActions.none,\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n};\n","import ShopifyDriver from './_base';\n\nconst Driver = class Driver extends ShopifyDriver {};\n\nexport default {\n\tname: 'RuMe Inc',\n\tdomain: 'myrume.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith('https://www.myrume.com/') && href.includes('/checkouts/');\n\t},\n};\n","import Promise from 'bluebird';\nimport ShopifyDriver from './_base';\nimport { DOM, log } from '../../../utils';\nimport { sessionTimer } from '../../lib';\nimport bus from '../../bus';\n\nconst { extractFormValues, extractFromHTML } = DOM;\n\n// Driver behaviour description:\n// •    Existing code: yes\n// •    Remove code: yes\n// •    Stackable: no\n// •    Free gift support: no\n// •    'isValid' implemented: yes\n// •    Codes can be replaced by another code: yes\n// •    Spa: yes - we can apply codes on each step (on the first step we can apply code only after entering info)\n// •    session timer - 15min\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.APPLIED_CODE_SELECTOR = '.order-summary__section--discount .reduction-code .reduction-code__text';\n\n\t\tthis.loadPageDynamic = true;\n\t\tthis.STEP_SELECTOR = '.step';\n\t\tthis.FIELD_SELECTOR = `${this.STEP_SELECTOR} [id^=checkout_]`;\n\n\t\tthis.contactInfoStep = false;\n\t\tthis.CONTACT_INFO_FORM_SELECTOR = '.edit_checkout:first-child';\n\t}\n\n\twatchForCartUrl() {\n\t\tconst interval = super.watchForCartUrl();\n\n\t\tsessionTimer.initialize({\n\t\t\tactionInterval: interval,\n\t\t\ttimeout: 15,\n\t\t});\n\t}\n\n\tcheckCondition() {\n\t\tconst { href } = window.location;\n\t\tconst isContact = document.querySelector(this.STEP_SELECTOR);\n\t\tconst isFilled = isContact && isContact.dataset.step === 'contact_information' ? this._isFilled() : true;\n\n\t\tconst checkoutURL =\n\t\t\thref.startsWith('https://www.outdoorvoices.com') &&\n\t\t\thref.includes('/checkouts/') &&\n\t\t\t!href.includes('stock_problems') &&\n\t\t\tisFilled;\n\n\t\treturn checkoutURL && document.readyState === 'complete';\n\t}\n\n\tbeforeTestCodes() {\n\t\tthis.bodyData = extractFormValues(this.FORM_SELECTOR);\n\t\tthis.CHECKOUT_STEP = document.querySelector('.step');\n\t\tthis.IS_ON_SHIPPING = this.CHECKOUT_STEP && this.CHECKOUT_STEP.getAttribute('data-step') === 'shipping_method';\n\t\tthis._getShippingSelectorIndex();\n\t\tthis.contactInfoStep = this.CHECKOUT_STEP.dataset.step === 'contact_information';\n\t\treturn Promise.resolve();\n\t}\n\n\tbeforeCheckCodes() {\n\t\treturn this.contactInfoStep\n\t\t\t? this._getCartSummary().then(responseHTML => this._parseTotal(responseHTML))\n\t\t\t: Promise.resolve();\n\t}\n\n\tcheckCodes(codes, originalPrice = this._parseTotal()) {\n\t\tlog(`Original price: ${originalPrice}`);\n\t\treturn Promise.each(codes, code =>\n\t\t\tthis._applyCode(code)\n\t\t\t\t.then(responseHTML => (this.loadPageDynamic ? this._getCartSummary(code) : responseHTML))\n\t\t\t\t.then(responseText => {\n\t\t\t\t\tconst result = {\n\t\t\t\t\t\tcode,\n\t\t\t\t\t\tfinalPrice: originalPrice,\n\t\t\t\t\t\tfinalDiscount: 0,\n\t\t\t\t\t\tisValid: false,\n\t\t\t\t\t};\n\n\t\t\t\t\tif (extractFromHTML(responseText, this.APPLIED_CODE_SELECTOR)) {\n\t\t\t\t\t\tresult.finalPrice = this._parseTotal(responseText);\n\t\t\t\t\t\tresult.finalDiscount = originalPrice - result.finalPrice;\n\t\t\t\t\t\tresult.isValid = true;\n\t\t\t\t\t}\n\t\t\t\t\treturn this._removeCode().then(() => bus.$emit('code-checked', result));\n\t\t\t\t}),\n\t\t);\n\t}\n\n\t_getCartSummary(code = '') {\n\t\tlet contactForm = null;\n\t\tif (this.contactInfoStep) {\n\t\t\tcontactForm = extractFormValues(this.CONTACT_INFO_FORM_SELECTOR).params;\n\t\t\tcontactForm.set('step', 'contact_information');\n\t\t\tcontactForm.set(this.APPLY_CODE_PARAMETER, code);\n\t\t}\n\t\treturn fetch(`${window.location.href}${contactForm ? '?' : ''}${contactForm ? contactForm.toString() : ''}`, {\n\t\t\tmethod: 'GET',\n\t\t\tcredentials: 'include',\n\t\t}).then(response => response.text());\n\t}\n\n\t_isFilled() {\n\t\tconst originalInputLength = [...document.querySelectorAll(this.FIELD_SELECTOR)].filter(\n\t\t\tel => el.offsetParent && !el.id.includes('address2'),\n\t\t).length;\n\t\tconst filledInputLength = [...document.querySelectorAll(this.FIELD_SELECTOR)].filter(\n\t\t\tel => el.offsetParent && !el.id.includes('address2') && el.value !== '',\n\t\t).length;\n\t\treturn originalInputLength === filledInputLength;\n\t}\n};\n\nexport default {\n\tname: 'Outdoor Voices',\n\tdomain: 'outdoorvoices.com',\n\tisSinglePageApp: true,\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl: () => false,\n};\n","import ShopifyDriver from './_base';\n\nconst Driver = class Driver extends ShopifyDriver {};\n\nexport default {\n\tname: 'qalo',\n\tdomain: 'qalo.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith('https://qalo.com/') && href.includes('/checkouts/');\n\t},\n};\n","import Promise from 'bluebird';\nimport ShopifyDriver from './_base';\nimport bus from '../../bus';\nimport { DOM, log } from '../../../utils';\n\nconst { extractElement } = DOM;\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t}\n\n\tcheckCodes(codes, originalPrice = this._parseTotal()) {\n\t\tlog(`Original price: ${originalPrice}`);\n\t\treturn Promise.each(codes, code => {\n\t\t\t// we need to add this delay, sue to shopify API rate limits\n\t\t\treturn Promise.delay(4000).then(() => {\n\t\t\t\treturn this._applyCode(code)\n\t\t\t\t\t.then(responseHTML => (this.loadPageDynamic ? this._getCartSummary() : responseHTML))\n\t\t\t\t\t.then(responseText => {\n\t\t\t\t\t\tconst result = {\n\t\t\t\t\t\t\tcode,\n\t\t\t\t\t\t\tfinalPrice: originalPrice,\n\t\t\t\t\t\t\tfinalDiscount: 0,\n\t\t\t\t\t\t\tisValid: false,\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tif (extractElement(this.APPLIED_CODE_SELECTOR, responseText)) {\n\t\t\t\t\t\t\tresult.finalPrice = this._parseTotal(responseText);\n\t\t\t\t\t\t\tresult.finalDiscount = originalPrice - result.finalPrice;\n\t\t\t\t\t\t\tresult.isValid = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn this._removeCode().then(() => {\n\t\t\t\t\t\t\tbus.$emit('code-checked', result);\n\t\t\t\t\t\t\tresult.originalPrice = originalPrice;\n\t\t\t\t\t\t\treturn bus.$emit('send-validation-codes', result);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\t_getCartSummary() {\n\t\t// on shipping page shipping methods is loaded dynamically and very slowly so we need to delay before each request\n\t\tconst promise = this.IS_ON_SHIPPING ? Promise.delay(500) : Promise.resolve();\n\t\tconst url = this.IS_ON_SHIPPING\n\t\t\t? `${window.location.href.split('?')[0]}?step=shipping_method`\n\t\t\t: window.location.href;\n\t\treturn promise\n\t\t\t.then(() =>\n\t\t\t\tfetch(url, {\n\t\t\t\t\tmethod: 'GET',\n\t\t\t\t\tcredentials: 'include',\n\t\t\t\t}),\n\t\t\t)\n\t\t\t.then(response => response.text());\n\t}\n};\n\nexport default {\n\tname: 'radioShack',\n\tdomain: 'radioshack.com',\n\tDriver,\n\tvalidationSupport: true,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith('https://www.radioshack.com/') && href.includes('/checkouts/');\n\t},\n\t// we can`t go to the checkout without any goods\n};\n","import ShopifyDriver from './_base';\nimport { format, DOM } from '../../../utils';\n\nconst { elemToFloat, toFloat } = format;\nconst { extractElement } = DOM;\n\n/** Behavior description:\n- existing code: yes\n- remove code: yes\n- stackable: no\n- free gift support: no\n- 'isValid' implemented: yes\n- replace code: yes\n- SPA: yes\n- Special case: sometimes website returns page without shipping, in this case discounton the popup can differ from the actual one\n\tbecause it's counted manually.\n\tAlso shipping is reset after page reload, therefore, to see the discounted price, restore the shipping manually.\n*/\n\nconst BASE_URL = 'https://www.rebeccaminkoff.com/';\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.OUT_OF_STOCK_SELECTOR = '.product__status--sold-out';\n\t\tthis.INPUT_CODE_SELECTOR = '#checkout_reduction_code';\n\t\tthis.SHIPPING_RADIO_SELECTOR = '.section--shipping-method .input-radio';\n\t\tthis.SHIPPING_RATE_ATTRIBUTE = 'data-checkout-shipping-rate';\n\t\tthis.getPureTotal = true;\n\t\twindow.addEventListener('beforeunload', () => {\n\t\t\tthis.reload = true;\n\t\t});\n\t\tthis.capturedShippingPrice = 0;\n\t}\n\n\tcheckCondition() {\n\t\tconst href = window.location.href.toLowerCase();\n\t\tconst documentLoaded = document.readyState === 'complete';\n\t\tconst isOnRightUrl = href.startsWith(BASE_URL) && href.includes('/checkouts/');\n\t\tconst outOfStockElement = document.querySelector(this.OUT_OF_STOCK_SELECTOR);\n\t\tconst inputCodeElement = document.querySelector(this.INPUT_CODE_SELECTOR);\n\t\treturn !this.reload && isOnRightUrl && documentLoaded && !outOfStockElement && inputCodeElement;\n\t}\n\n\tbeforeCheckCodes() {\n\t\tconst [selectedShipping] = [...document.querySelectorAll(this.SHIPPING_RADIO_SELECTOR)].filter(\n\t\t\tel => el.checked,\n\t\t);\n\t\tif (selectedShipping) {\n\t\t\tthis.capturedShippingPrice = toFloat(selectedShipping.getAttribute(this.SHIPPING_RATE_ATTRIBUTE));\n\t\t\tif (Number.isNaN(this.capturedShippingPrice)) {\n\t\t\t\tthis.capturedShippingPrice = 0;\n\t\t\t}\n\t\t}\n\t}\n\n\t_parseTotal(data) {\n\t\t// sometims website does not return page with shipping\n\t\tlet total = super._parseTotal(data);\n\t\tif (!total) {\n\t\t\tconst totalWithoutShipping = elemToFloat(extractElement(this.TOTAL_SELECTOR, data));\n\t\t\ttotal = totalWithoutShipping + this.capturedShippingPrice;\n\t\t}\n\t\treturn total;\n\t}\n};\n\nexport default {\n\tname: 'Rebecca Minkoff',\n\tdomain: 'rebeccaminkoff.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisSinglePageApp: true,\n};\n","import ShopifyDriver from './_base';\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t}\n};\n\nexport default {\n\tname: 'REN Skincare',\n\tdomain: 'renskincare.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith('https://usa.renskincare.com/') && href.includes('/checkouts/');\n\t},\n};\n","import ShopifyDriver from './_base';\nimport { format, DOM } from '../../../utils';\n\nconst { toFloat } = format;\nconst { extractFormValues, extractData } = DOM;\n\n// on shipping_method, we must check the delivery method to check if the price is correct\n// because with the apllied code the freeshipping can disappear and it will take wrong selector for price\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\t// code applied dynamically without refreshing page\n\t\tthis.FORM_SELECTOR = '.order-summary__section--discount form';\n\t\tthis.currentShippingQuantity = null;\n\t\tthis.responseShippingQuantity = null;\n\t\tthis.loadPageDynamic = true;\n\t}\n\n\t// changed this method, because at the last step driver finds 2 identical promos\n\tgetExistingCodes() {\n\t\tconst codes = [document.querySelector(this.APPLIED_CODE_SELECTOR)].filter(Boolean).map(el => el.textContent);\n\n\t\treturn {\n\t\t\tcodes,\n\t\t\tcodeCount: codes.length,\n\t\t};\n\t}\n\n\tbeforeTestCodes() {\n\t\tif (!this.bodyData) {\n\t\t\tthis.bodyData = extractFormValues(this.FORM_SELECTOR);\n\t\t}\n\t\tthis.CHECKOUT_STEP = document.querySelector('.step');\n\t\tthis.IS_ON_SHIPPING = this.CHECKOUT_STEP\n\t\t\t? this.CHECKOUT_STEP.getAttribute('data-step') === 'shipping_method'\n\t\t\t: false;\n\t\tif (this.IS_ON_SHIPPING) {\n\t\t\tthis.currentShippingQuantity = this._checkShipping();\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n\n\t_checkShipping(data) {\n\t\treturn extractData('.input-radio', data, true).length;\n\t}\n\n\t_parseTotal(data) {\n\t\tlet totalSumm = null;\n\t\tif (this.IS_ON_SHIPPING) {\n\t\t\tthis.responseShippingQuantity = this._checkShipping(data);\n\t\t\tlet shippingPriceIndex = this._getShippingSelectorIndex();\n\t\t\tif (this.currentShippingQuantity < this.responseShippingQuantity) {\n\t\t\t\tshippingPriceIndex += 1;\n\t\t\t} else if (this.currentShippingQuantity > this.responseShippingQuantity) {\n\t\t\t\tshippingPriceIndex -= 1;\n\t\t\t}\n\t\t\tconst shippingRateSelector = `.content-box__row:nth-of-type(${shippingPriceIndex + 1}) .input-radio`;\n\t\t\ttotalSumm = data\n\t\t\t\t? extractData(shippingRateSelector, data, false, this.CHECKOUT_TOTAL_SELECTOR_ATTRIBUTE)\n\t\t\t\t: extractData(this.TOTAL_SELECTOR);\n\t\t} else {\n\t\t\ttotalSumm = extractData(this.TOTAL_SELECTOR, data);\n\t\t}\n\t\treturn toFloat(totalSumm);\n\t}\n};\n\nexport default {\n\tname: 'Road ID',\n\tdomain: 'roadid.com',\n\tDriver,\n\tmaxCoupons: 6,\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith('https://www.roadid.com/') && href.includes('/checkouts/');\n\t},\n\t// no need to write isCartEmpty() because user can`t go to the checkout page without goods\n};\n","import ShopifyDriver from './_base';\nimport { browserUtils, DOM, completionActions, format } from '../../../utils';\n\nconst { toFloat } = format;\nconst { extractFormValues, extractFromHTML, setValue } = DOM;\nconst { getCookie } = browserUtils;\n\n/*\nDriver behaviour description:\n\t+ Existing code: yes\n\t+ Remove code: yes\n\t+ Stackable: no\n\t+ Free gift support: no\n\t+ Free shipping: no\n\t+ 'isValid' implemented: yes\n\t+ Replace code: yes\n\t+ is SPA: yes\n\t+ manual apply: yes(first step of checkout)\n\t+ Restore user data: yes\n=== Special case ===\n- from time to time site works slow, maxCoupons:6\n- we do\n */\nconst IS_MANUAL_APPLY = document.querySelector('.section--shipping-address');\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t\tthis.CODE_INPUT_SELECTOR = '#checkout_reduction_code';\n\t\tthis.APPLY_BUTTON_SELECTOR = '[data-trekkie-id=\"apply_discount_button\"]';\n\t\tthis.SELECTED_SHIPPING_SELECTOR = '.section--shipping-method input:checked';\n\t\tthis.ADDRESS_BLOCK = '.section--shipping-address';\n\t\tthis.SHIPPING_BLOCK = '.section--shipping-method';\n\t\tthis.BILLING_BLOCK = '.section--payment-method';\n\t\tthis.TAX_FIELD = '.total-line--taxes';\n\t\tthis.SELECTED_SHIPPING_ID = null;\n\t\tthis.restoreShippingMethod = true;\n\t}\n\n\tcheckCondition() {\n\t\tconst { href } = window.location;\n\t\tconst onRightStep = href.includes('checkouts');\n\n\t\tconst isTaxOnShipping =\n\t\t\tdocument.querySelector(this.ADDRESS_BLOCK) ||\n\t\t\t(document.querySelector(this.SHIPPING_BLOCK) &&\n\t\t\t\t!document.querySelector(this.TAX_FIELD).classList.contains('hidden')) ||\n\t\t\tdocument.querySelector(this.BILLING_BLOCK);\n\t\tconst usSelected = getCookie('_dy_geo')\n\t\t\t? getCookie('_dy_geo')\n\t\t\t\t\t.toLowerCase()\n\t\t\t\t\t.includes('us.')\n\t\t\t: false;\n\t\tconst isTotal = document.querySelector(this.TOTAL_SELECTOR);\n\n\t\treturn onRightStep && isTaxOnShipping && isTotal && usSelected;\n\t}\n\n\tbeforeTestCodes() {\n\t\tif (!this.bodyData) {\n\t\t\tthis.bodyData = extractFormValues(this.FORM_SELECTOR);\n\t\t}\n\t\tthis.CHECKOUT_STEP = document.querySelector('.step');\n\t\tthis.IS_ON_SHIPPING = this.CHECKOUT_STEP\n\t\t\t? this.CHECKOUT_STEP.getAttribute('data-step') === 'shipping_method'\n\t\t\t: false;\n\t\tif (this.IS_ON_SHIPPING) {\n\t\t\tthis.SELECTED_SHIPPING_ID = `#${document\n\t\t\t\t.querySelector(this.SELECTED_SHIPPING_SELECTOR)\n\t\t\t\t.getAttribute('id')}`;\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n\n\tbeforeCheckCodes() {\n\t\t// need to do this, because tax appears after page reload\n\t\treturn this._getCartSummary().then(resHtml => this._parseTotal(resHtml));\n\t}\n\n\tapplyCodes(codes) {\n\t\treturn IS_MANUAL_APPLY ? this._manuallyApplyCode(codes[0]) : this._applyCode(codes[0]);\n\t}\n\n\t_manuallyApplyCode(code) {\n\t\tconst applyButton = document.querySelector(this.APPLY_BUTTON_SELECTOR);\n\t\tconst codesInput = document.querySelector(this.CODE_INPUT_SELECTOR);\n\t\tsetValue(codesInput, code);\n\t\tapplyButton.click();\n\t}\n\n\t_parseTotal(data) {\n\t\tlet totalSumm = null;\n\t\tif (this.IS_ON_SHIPPING) {\n\t\t\ttotalSumm = data\n\t\t\t\t? extractFromHTML(data, this.SELECTED_SHIPPING_ID, null, this.CHECKOUT_TOTAL_SELECTOR_ATTRIBUTE)\n\t\t\t\t: document\n\t\t\t\t\t\t.querySelector(this.SELECTED_SHIPPING_ID)\n\t\t\t\t\t\t.getAttribute(this.CHECKOUT_TOTAL_SELECTOR_ATTRIBUTE);\n\t\t} else {\n\t\t\ttotalSumm = data\n\t\t\t\t? extractFromHTML(data, this.TOTAL_SELECTOR)\n\t\t\t\t: document.querySelector(this.TOTAL_SELECTOR).textContent;\n\t\t}\n\t\treturn toFloat(totalSumm);\n\t}\n};\n\nexport default {\n\tname: 'THINX',\n\tdomain: 'shethinx.com',\n\tmaxCoupons: 6, // site works slow\n\tcompletionAction: IS_MANUAL_APPLY ? completionActions.none : completionActions.reload,\n\tisSinglePageApp: true,\n\tshowDifferentDiscountMessage: true,\n\trestoreUserData: true,\n\tDriver,\n};\n","import ShopifyDriver from './_base';\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.FORM_SELECTOR = '.order-summary__section--discount form:first-of-type';\n\t\tthis.getPureTotal = true;\n\t}\n};\n\nexport default {\n\tname: \"Silk'n Skin Care\",\n\tdomain: 'silkn.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith('https://silkn.com/') && href.includes('/checkouts/');\n\t},\n\t// no need to write isCartEmpty() because user can`t go to the checkout page without goods\n};\n","import ShopifyDriver from './_base';\n\n/**\nDriver behavior:\n•   Existing code: yes\n•   Remove code: yes\n•   Code retesting: yes\n•   Stackable: no\n•   Free gift support: no\n•   isValid implemented: yes\n•   Show message about free shipping: no\n•   Driver is SPA: no\n•   Gather merchant codes: no\n•   Special case: there may exist yet another checkout page, but I couldn't reach it\n */\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t\tthis.APPLIED_CODE_SELECTOR = '.reduction-code__text';\n\t}\n};\n\nexport default {\n\tname: 'soylent',\n\tdomain: 'soylent.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.includes('https://soylent.com/') && href.includes('/checkouts/');\n\t},\n};\n","import ShopifyDriver from './_base';\nimport { sessionTimer } from '../../lib';\n\n/*\nBehavior description:\n+ Existing code: yes\n+ Remove code: yes\n+ Stackable: no\n+ Free gift support: no\n+ Free shipping: no\n+ ‘isValid’ implemented: yes\n+ Codes can be replaced by another code: no\n+ Manually apply code: no\n+ Pages, where extension works: Checkout pages\n+ Is driver SPA: yes\n+ Gather codes on site pages: no\n+ Session timer: 15 min\n+ MaxCoupons: 10, due to test time\n*/\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\t// some page elements like shipping or taxes may load dynamically after page loaded\n\t\tthis.loadPageDynamic = true;\n\t\tthis.getPureTotal = true;\n\t\tthis.SOLD_OUT_PRODUCT_SELECTOR = '.product__status--sold-out';\n\t\tthis.STOCK_PRODUCT_SELECTOR = '.stock-problems-table';\n\t\tthis.INPUT_FIELD_SELECTOR = '#checkout_reduction_code';\n\t\tthis.DISCOUNT_REGEX = /\\??&?discount=(.*)/;\n\n\t\tthis.restoreShippingMethod = true;\n\t}\n\n\twatchForCartUrl() {\n\t\tconst interval = super.watchForCartUrl();\n\t\tsessionTimer.initialize({\n\t\t\tactionInterval: interval,\n\t\t\ttimeout: 15,\n\t\t});\n\t}\n\n\tcheckCondition() {\n\t\tconst { href } = window.location;\n\n\t\treturn (\n\t\t\tdocument.readyState === 'complete' &&\n\t\t\thref.startsWith('https://www.stevemadden.com/') &&\n\t\t\thref.includes('/checkouts/') &&\n\t\t\t!document.querySelector(this.SOLD_OUT_PRODUCT_SELECTOR) &&\n\t\t\t!document.querySelector(this.STOCK_PRODUCT_SELECTOR) &&\n\t\t\tdocument.querySelector(this.INPUT_FIELD_SELECTOR)\n\t\t);\n\t}\n\n\tbeforeTestCodes() {\n\t\t// if apply code on pop-up Cart promo code will be added to the url, need to clean it to get right url\n\t\twindow.history.pushState(\n\t\t\twindow.history.state,\n\t\t\twindow.document.title,\n\t\t\twindow.location.href.replace(this.DISCOUNT_REGEX, ''),\n\t\t);\n\t\treturn super.beforeTestCodes();\n\t}\n};\n\nexport default {\n\tname: 'Steve Madden',\n\tdomain: 'stevemadden.com',\n\tDriver,\n\trestoreUserData: true,\n\tmaxCoupons: 8, // site locks us\n\tisSinglePageApp: true,\n\t// no need to write isCartEmpty() because user can`t go to the checkout page without goods\n};\n","import Promise from 'bluebird';\nimport ShopifyDriver from './_base';\nimport { browserUtils } from '../../../utils';\nimport { extractElement, extractFormValues } from '../../../utils/DOM';\nimport { backgroundMessaging } from '../../lib';\n\nconst { wait } = browserUtils;\n\n/** Behavior description:\n•    Existing code: yes\n•    Remove code: yes\n•    Stackable:  no\n•    Free gift support:  no\n•    ‘isValid’ implemented: yes\n•\t SPA: yes\n====Special cases====\n\tWe reset shipping method on shipping page after code testing.\n\tCan test only 3 coupons,\n\twe can test codes 2 times per 30 min\n*/\n\nconst DOMAIN = 'tableclothsfactory.com';\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\t// this.FORM_SELECTOR = '.order-summary__section--discount form:last-child, .edit_checkout';\n\t\tthis.MERACHANT_CODE_SELECTOR = '.announcement-bar-for-mobile';\n\t\tthis.RESPONSE_SHIPPING_SELECTOR = '[data-shipping-methods] input';\n\t\tthis.MERCHANT_CODE_REGEX = /code: (\\w+)/i;\n\t\t// some page elements like shipping or taxes may load dynamically after page loaded\n\t\tthis.loadPageDynamic = true;\n\t\tthis.restoreShippingMethod = true;\n\t\tthis.MAX_TRY_NUMBER = 2;\n\t\tthis.DISABLE_TIME_MS = 30 * 60 * 1000; // 30 minutes\n\t}\n\n\tasync checkCondition() {\n\t\tconst { href } = window.location;\n\t\tlet isNotMaxCodeTesting = true;\n\t\tconst driverStorage = await backgroundMessaging.getDriverStorage(DOMAIN);\n\t\tif (driverStorage) {\n\t\t\tconst dataExpired = Date.now() - driverStorage.lastTestTimestamp >= this.DISABLE_TIME_MS;\n\t\t\tif (dataExpired) {\n\t\t\t\tbackgroundMessaging.deleteDriverStorage(DOMAIN);\n\t\t\t} else {\n\t\t\t\tisNotMaxCodeTesting = driverStorage.codeTestingCount < 2;\n\t\t\t}\n\t\t}\n\t\tconst isOnFirstStep =\n\t\t\thref.includes('step=contact_information') && document.querySelector('.section--shipping-address');\n\t\tconst isOnShippingStep = document.querySelector('[data-shipping-method]');\n\t\tconst isOnPaymentStep = href.includes('step=payment_method');\n\t\tconst isStockProblem = href.includes('stock_problems') && document.querySelector('[data-payment-subform]');\n\t\tconst isTotal =\n\t\t\tdocument.querySelector(this.TOTAL_SELECTOR) && document.querySelector(this.TOTAL_SELECTOR).offsetParent;\n\t\treturn (\n\t\t\tdocument.readyState === 'complete' &&\n\t\t\t(isOnFirstStep || isOnShippingStep || isOnPaymentStep) &&\n\t\t\tisTotal &&\n\t\t\t!isStockProblem &&\n\t\t\tisNotMaxCodeTesting\n\t\t);\n\t}\n\n\tasync beforeTestCodes() {\n\t\tconst driverStorage = await backgroundMessaging.getDriverStorage(DOMAIN);\n\t\tconst codeTestingCount = driverStorage ? driverStorage.codeTestingCount : 0;\n\t\tbackgroundMessaging.setDriverStorage(DOMAIN, {\n\t\t\tcodeTestingCount: codeTestingCount + 1,\n\t\t\tlastTestTimestamp: Date.now(),\n\t\t});\n\t\tif (!this.bodyData) {\n\t\t\tthis.bodyData = extractFormValues(this.FORM_SELECTOR);\n\t\t}\n\t\tthis.CHECKOUT_STEP = document.querySelector('.step');\n\t\tthis.IS_ON_SHIPPING = this.CHECKOUT_STEP\n\t\t\t? this.CHECKOUT_STEP.getAttribute('data-step') === 'shipping_method'\n\t\t\t: false;\n\t\tthis._getShippingSelectorIndex();\n\n\t\treturn Promise.resolve();\n\t}\n\n\tgetMerchantCodes() {\n\t\treturn fetch(`https://${DOMAIN}`)\n\t\t\t.then(res => res.text())\n\t\t\t.then(resHtml =>\n\t\t\t\t[...extractElement(this.MERACHANT_CODE_SELECTOR, resHtml, true)]\n\t\t\t\t\t.map(item => item.textContent.match(this.MERCHANT_CODE_REGEX))\n\t\t\t\t\t.filter(Boolean)\n\t\t\t\t\t.map(item => item[1]),\n\t\t\t);\n\t}\n\n\tbeforeCheckCodes() {\n\t\treturn this._getCartSummary().then(responseHTML => this._parseTotal(responseHTML));\n\t}\n\n\t_applyCode(code, tryNumber = 0) {\n\t\tconst { href } = window.location;\n\t\tthis.bodyData.params.set(this.APPLY_CODE_PARAMETER, code);\n\t\tthis.bodyData.params.delete(this.REMOVE_CODE_PARAMETER); // it is important, without it we can`t send right request\n\t\treturn this._manageCode().then(resHtml => {\n\t\t\tif (\n\t\t\t\t!extractElement(this.RESPONSE_SHIPPING_SELECTOR, resHtml) &&\n\t\t\t\ttryNumber < this.MAX_TRY_NUMBER &&\n\t\t\t\thref.includes('shipping_method') &&\n\t\t\t\t!href.includes('payment_method')\n\t\t\t) {\n\t\t\t\treturn Promise.delay(2000).then(() => this._applyCode(code, tryNumber + 1));\n\t\t\t}\n\t\t\treturn resHtml;\n\t\t});\n\t}\n\n\t_manageCode() {\n\t\treturn fetch(this.bodyData.action, {\n\t\t\tmethod: 'POST',\n\t\t\tcredentials: 'include',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\n\t\t\t},\n\t\t\tbody: this.bodyData.params,\n\t\t}).then(response => response.text());\n\t}\n\n\t_getCartSummary() {\n\t\tconst { href } = window.location;\n\t\tconst shipSel = () =>\n\t\t\thref.includes('shipping_method') && !href.includes('payment_method')\n\t\t\t\t? document.querySelector('[data-shipping-method-form]')\n\t\t\t\t: true;\n\t\treturn wait(shipSel, 10000, 500)\n\t\t\t.then(() =>\n\t\t\t\tfetch(window.location.href, {\n\t\t\t\t\tcredentials: 'include',\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t)\n\t\t\t.then(response => response.text());\n\t}\n};\n\nexport default {\n\tname: 'Tablecloths Factory',\n\tdomain: 'tableclothsfactory.com',\n\tmaxCoupons: 3, // site works slow\n\trestoreUserData: true,\n\tDriver,\n\tisSinglePageApp: true,\n};\n","import ShopifyDriver from './_base';\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.SOLD_OUT_SELECTOR = '.product__status--sold-out';\n\t\tthis.SPINNER_SELECTOR = '.section--shipping-method .content-box svg';\n\t}\n\n\tcheckCondition() {\n\t\tconst isRightUrl = window.location.href.includes('/checkouts/');\n\t\tconst codeInput = document.querySelector(this.CODES_INPUT_SELECTOR);\n\t\tconst totalEl = document.querySelector(this.TOTAL_SELECTOR);\n\t\tconst isCodeInput = codeInput && codeInput.offsetParent;\n\t\tconst isSoldOut = document.querySelector(this.SOLD_OUT_SELECTOR);\n\t\tconst isTotal = totalEl && totalEl.offsetParent;\n\t\tconst spinnerIsPresent = document.querySelector(this.SPINNER_SELECTOR);\n\t\tconst currentState = !spinnerIsPresent && !isSoldOut && isRightUrl && isCodeInput && isTotal;\n\t\treturn currentState;\n\t}\n\n\t_getCartSummary(tryNumber = 1) {\n\t\treturn fetch(window.location.href, {\n\t\t\tmethod: 'GET',\n\t\t\tcredentials: 'include',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\n\t\t\t},\n\t\t})\n\t\t\t.then(response => response.text())\n\t\t\t.then(\n\t\t\t\t// it will work only once, on the shipping apge\n\t\t\t\tresponseHTML =>\n\t\t\t\t\t!this._parseTotal(responseHTML) && tryNumber < 6\n\t\t\t\t\t\t? this._getCartSummary(tryNumber + 1)\n\t\t\t\t\t\t: responseHTML,\n\t\t\t);\n\t}\n};\n\nexport default {\n\tname: 'TeeFury',\n\tdomain: 'teefury.com',\n\tisSinglePageApp: true,\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n};\n","import ShopifyDriver from './_base';\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t}\n};\n\nexport default {\n\tname: 'The Color Run ',\n\tdomain: 'thecolorrun.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith('https://store.thecolorrun.com/') && href.includes('/checkouts/');\n\t},\n};\n","import ShopifyDriver from './_base';\nimport { completionActions, DOM, browserUtils } from '../../../utils';\nimport { sessionTimer, backgroundMessaging } from '../../lib';\n\nconst { setValue } = DOM;\nconst { wait } = browserUtils;\n/* Driver behaviour description:\n•    Existing code: yes\n•    Remove code: yes\n•    Stackable: no\n•    Free gift support: no\n•    'isValid' implemented: yes\n•     Codes can be replaced by another code: yes\n• sessionTimer 20 min after 4 code testing */\n\nconst DOMAIN = 'thefryecompany.com';\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\t// some page elements like shipping or taxes may load dynamically after page loaded\n\t\tthis.loadPageDynamic = true;\n\t\tthis.PROMO_INPUT = '#checkout_reduction_code';\n\t\tthis.APPLY_BUTTON_SELECTOR = '[data-trekkie-id=\"apply_discount_button\"]';\n\t\tthis.getPureTotal = true;\n\t\tthis.DISABLE_TIME_MS = 20 * 60 * 1000; // 20 minutes\n\t\tsessionTimer.initialize();\n\t}\n\n\tasync checkCondition() {\n\t\tlet isNotMaxCodeTesting = true;\n\t\tconst driverStorage = await backgroundMessaging.getDriverStorage(DOMAIN);\n\t\tif (driverStorage) {\n\t\t\tconst dataExpired = Date.now() - driverStorage.lastTestTimestamp >= this.DISABLE_TIME_MS;\n\t\t\tif (dataExpired) {\n\t\t\t\tbackgroundMessaging.deleteDriverStorage(DOMAIN);\n\t\t\t} else {\n\t\t\t\tisNotMaxCodeTesting = driverStorage.codeTestingCount < 4;\n\t\t\t}\n\t\t}\n\t\tconst { href } = window.location;\n\t\treturn (\n\t\t\thref.startsWith('https://www.thefryecompany.com/') &&\n\t\t\thref.includes('/checkouts/') &&\n\t\t\tdocument.querySelector(this.PROMO_INPUT) &&\n\t\t\tisNotMaxCodeTesting\n\t\t);\n\t}\n\n\twatchForCartUrl() {\n\t\tconst interval = super.watchForCartUrl();\n\n\t\tsessionTimer.initialize({\n\t\t\tactionInterval: interval,\n\t\t\ttimeout: 15,\n\t\t});\n\t}\n\n\tapplyCodes(codes) {\n\t\treturn this._manuallyApplyCode(codes[0]);\n\t}\n\n\t_manuallyApplyCode(code) {\n\t\tsetValue(document.querySelector(this.PROMO_INPUT), code);\n\t\tconst isCodeApplied = () => document.querySelector(this.APPLIED_CODE_SELECTOR);\n\t\tdocument.querySelector(this.APPLY_BUTTON_SELECTOR).click();\n\t\treturn wait(isCodeApplied, 5000);\n\t}\n\n\tasync beforeApplyCodes() {\n\t\tconst driverStorage = await backgroundMessaging.getDriverStorage(DOMAIN);\n\t\tconst codeTestingCount = driverStorage ? driverStorage.codeTestingCount : 0;\n\t\tbackgroundMessaging.setDriverStorage(DOMAIN, {\n\t\t\tcodeTestingCount: codeTestingCount + 1,\n\t\t\tlastTestTimestamp: Date.now(),\n\t\t});\n\t}\n};\n\nexport default {\n\tname: 'The Frye Company',\n\tdomain: 'thefryecompany.com',\n\tDriver,\n\tisSinglePageApp: true,\n\tcompletionAction: completionActions.none,\n\tmaxCoupons: 4,\n};\n","import ShopifyDriver from './_base';\n\nconst BASE_URL = 'https://store.tonyrobbins.com';\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t}\n};\n\nexport default {\n\tname: 'Tony Robbins',\n\tdomain: 'tonyrobbins.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith(BASE_URL) && href.includes('/checkouts/') && !href.includes('stock_problems');\n\t},\n};\n","import ShopifyDriver from './_base';\nimport { sessionTimer, backgroundMessaging } from '../../lib';\n\n/*\nBehavior description:\n+ Existing code: yes\n+ Remove code: yes\n+ Stackable: no\n+ Free gift support: no\n+ Free shipping: no\n+ ‘isValid’ implemented: yes\n+ Codes can be replaced by another code: no\n+ Manually apply code: no\n+ Pages, where extension works: Checkout (Shipping and Payment)\n+ Is driver SPA: yes\n+ Gather codes on site pages: no\n+ Session timer: 15 min\n+ MaxCoupons: 6, due to test time\n=====Special case=====\nBlock popup after 5 times of testing\nPopup will not shown on shipping step if it will not shipping method on page\n*/\n\nconst DOMAIN = 'untuckit.com';\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.TOTAL_ELEMENT_CONFIG = {\n\t\t\tselector: this.TOTAL_SELECTOR,\n\t\t};\n\t\tthis.INFORMATION_STEP_SELECTOR = '[value=\"contact_information\"]';\n\t\tthis.FORM_SELECTOR = '.order-summary__section--discount form:last-of-type';\n\t\tthis.BASE_URL = `https://www.${DOMAIN}`;\n\t\tthis.SPINER = '.full-page-overlay';\n\n\t\tthis.DISABLE_TIME_MS = 20 * 60 * 1000; // 20 minutes\n\n\t\tsessionTimer.initialize({\n\t\t\ttimeout: 25,\n\t\t});\n\t\tthis.restoreShippingMethod = true;\n\t}\n\n\tasync checkCondition() {\n\t\tlet isNotMaxCodeTesting = true;\n\t\tconst driverStorage = await backgroundMessaging.getDriverStorage(DOMAIN);\n\t\tif (driverStorage) {\n\t\t\tconst dataExpired = Date.now() - driverStorage.lastTestTimestamp >= this.DISABLE_TIME_MS;\n\t\t\tif (dataExpired) {\n\t\t\t\tbackgroundMessaging.deleteDriverStorage(DOMAIN);\n\t\t\t} else {\n\t\t\t\tisNotMaxCodeTesting = driverStorage.codeTestingCount < 3;\n\t\t\t}\n\t\t}\n\n\t\tconst { href } = window.location;\n\t\tconst isOnCheckout =\n\t\t\thref.startsWith(this.BASE_URL) && href.includes('/checkouts/') && !href.includes('stock_problems');\n\t\tconst completedOrder = href.includes('/thank_you');\n\t\tconst isInformationStep = document.querySelector(this.INFORMATION_STEP_SELECTOR);\n\t\tconst isTotal = document.querySelector(this.TOTAL_SELECTOR);\n\t\tconst isSpiner = document.querySelector(this.SPINER);\n\t\tconst isShippingStep = document.querySelector(this.SHIPPING_SECTION_SELECTOR);\n\t\tconst isChoosingShipping = isShippingStep ? document.querySelector(this.SHIPPING_METHOD_SELECTOR) : true;\n\t\treturn (\n\t\t\tisOnCheckout &&\n\t\t\tisTotal &&\n\t\t\t!isSpiner &&\n\t\t\t!completedOrder &&\n\t\t\t!isInformationStep &&\n\t\t\tisChoosingShipping &&\n\t\t\tisNotMaxCodeTesting\n\t\t);\n\t}\n\n\tasync beforeApplyCodes() {\n\t\tconst driverStorage = await backgroundMessaging.getDriverStorage(DOMAIN);\n\t\tconst codeTestingCount = driverStorage ? driverStorage.codeTestingCount : 0;\n\t\tbackgroundMessaging.setDriverStorage(DOMAIN, {\n\t\t\tcodeTestingCount: codeTestingCount + 1,\n\t\t\tlastTestTimestamp: Date.now(),\n\t\t});\n\t\treturn Promise.resolve();\n\t}\n};\n\nexport default {\n\tname: 'UNTUCKit',\n\tdomain: 'untuckit.com',\n\tDriver,\n\tisSinglePageApp: true,\n\tmaxCoupons: 6,\n\trestoreUserData: true,\n};\n","import ShopifyDriver from './_base';\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t\tthis.FORM_SELECTOR = '.order-summary__section--discount form:first-of-type';\n\t\tthis.APPLIED_CODE_SELECTOR = '.reduction-code__text';\n\t}\n};\n\nexport default {\n\tname: '1MORE USA',\n\tdomain: 'usa.1more.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn (\n\t\t\thref.startsWith('https://usa.1more.com/') &&\n\t\t\thref.includes('/checkouts/') &&\n\t\t\t!document.querySelector('.product__status--sold-out')\n\t\t);\n\t},\n};\n","import ShopifyDriver from './_base';\n\n/*\nDriver behavior description:\n+ Existing code: yes\n+ Remove code: yes\n+ Stackable: no\n+ Free gift support: no\n+ Free shipping: no\n+ ‘isValid’ implemented: yes\n+ Codes can be replaced by another code: no\n+ Manually apply code: no\n+\n+ Pages, where extension works:\n    - checkout\n+ Is driver SPA no\n+ Gather codes on site pages: no\n+ MaxCoupons: 7 (site is slow)\n*/\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t\tthis.FORM_SELECTOR = '.order-summary__section--discount form:first-of-type';\n\t\tthis.APPLIED_CODE_SELECTOR = '.order-summary__section--discount .reduction-code .reduction-code__text';\n\n\t\tthis.SHIPPING_SELECTOR = '.total-line--shipping .total-line__price';\n\n\t\tthis.getPureTotal = true;\n\t\tthis.restoreShippingMethod = true;\n\t}\n};\n\nexport default {\n\tname: 'US Polo Assn',\n\tdomain: 'uspoloassn.com',\n\tDriver,\n\tmaxCoupons: 7, // site is slow\n\trestoreUserData: true,\n\tisCartEmpty() {\n\t\treturn document.querySelector('.wl-cart-view--empty');\n\t},\n\tisOnCartUrl(href) {\n\t\treturn (\n\t\t\thref.includes('uspoloassn.com') &&\n\t\t\thref.includes('/checkouts/') &&\n\t\t\t!document.querySelector('.product__status--sold-out') &&\n\t\t\tdocument.querySelector('#checkout_reduction_code')\n\t\t);\n\t},\n};\n","import Promise from 'bluebird';\nimport ShopifyDriver from './_base';\nimport { DOM, completionActions, browserUtils, format } from '../../../utils';\n\nconst { extractData, extractElement, setValue, extractFormValues } = DOM;\nconst { toFloat } = format;\nconst { wait } = browserUtils;\n/*\nDriver behavior description:\n+ Existing code: yes\n+ Remove code: yes\n+ Stackable: no\n+ Free gift support: no\n+ Free shipping: no\n+ ‘isValid’ implemented: no\n+ Codes can be replaced by another code: yes (valid ones only)\n+ Manually apply code: yes, on checkout(contact information)\n+\n+ Pages, where extension works:\n    - Checkout page\n+ Is driver SPA yes\n\t- right url\n\t- code input is on the page\n\t- total element is on the page\n\t- there are no shipping errors\n+ Gather codes on site pages: no\n+ Special case about the driver works (if it needed).\n    - maxCoupons 4 (timing)\n\t- sessionTimer no\n\t- we can increase shipping price if code gives bigger discount then shipping price\n*/\n\nconst checkoutStep = () => document.querySelector('.step');\nconst isOnShipping = () => checkoutStep() && checkoutStep().getAttribute('data-step') === 'shipping_method';\nconst isOnInformation = () => checkoutStep() && checkoutStep().getAttribute('data-step') === 'contact_information';\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\n\t\tthis.SUMMARY_SELECTOR = '.order-summary__section--discount';\n\t\tthis.FORM_SELECTOR = `${this.SUMMARY_SELECTOR} form`;\n\t\tthis.APPLY_BUTTON_SELECTOR = `${this.SUMMARY_SELECTOR} button`;\n\t\tthis.URL_REGEX = /&discount=(\\w+)/i;\n\t\tthis.getPureTotal = true;\n\t\tthis.APPLIED_CODE_SELECTOR = '.edit_checkout .reduction-code__text';\n\t\tthis.REMOVE_DISCOUNT_SELECTOR = '#checkout_clear_discount';\n\t\tthis.SHIPPING_OPRIONS_ELEMENT_SELECTOR = '.content-box.blank-slate p';\n\t\tthis.SHIPPING_OPTIONS_REGEX = /no shipping methods available/i;\n\t\tthis.SHIPPING_SECTION_SELECTOR = '.section--shipping-method';\n\t\tthis.SHIPPING_METHOD_SELECTOR = '.section--shipping-method .input-radio';\n\t}\n\n\tcheckCondition() {\n\t\tconst isRightUrl = window.location.href.includes('/checkouts/');\n\t\tconst codeInput = document.querySelector(this.CODES_INPUT_SELECTOR);\n\t\tconst totalEl = document.querySelector(this.TOTAL_SELECTOR);\n\t\tconst isCodeInput = codeInput && codeInput.offsetParent;\n\t\tconst isTotal = totalEl && totalEl.offsetParent;\n\t\tconst isShippingOptions = [...document.querySelectorAll(this.SHIPPING_OPRIONS_ELEMENT_SELECTOR)].some(item =>\n\t\t\tthis.SHIPPING_OPTIONS_REGEX.test(item.textContent),\n\t\t);\n\n\t\treturn isRightUrl && isCodeInput && isTotal && !isShippingOptions;\n\t}\n\n\tcheckRestoreDataCondition() {\n\t\treturn document.querySelector(this.SHIPPING_METHOD_SELECTOR);\n\t}\n\n\tgetUserData() {\n\t\tif (document.querySelector(this.SHIPPING_SECTION_SELECTOR)) {\n\t\t\tconst checkedShippingElement = [...document.querySelectorAll(this.SHIPPING_METHOD_SELECTOR)].find(\n\t\t\t\telement => element.checked,\n\t\t\t);\n\n\t\t\treturn {\n\t\t\t\tshippingSelector: `#${checkedShippingElement.getAttribute('id')}`,\n\t\t\t};\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tsetUserData(userData) {\n\t\tconst checkedShippingOption = document.querySelector(userData.shippingSelector);\n\t\tif (checkedShippingOption) {\n\t\t\tcheckedShippingOption.click();\n\t\t}\n\t}\n\n\tbeforeTestCodes() {\n\t\tif (window.location.href.includes('discount')) {\n\t\t\t// if url contains discount=\"SOME_CODE\",\n\t\t\t// we can't get right order summary request,\n\t\t\t// but we can fix it, to removes it from URL\n\t\t\tconst url = window.location.href.replace(this.URL_REGEX, '');\n\t\t\twindow.history.replaceState(window.history.state, window.document.title, url);\n\t\t}\n\t\tif (!this.bodyData) {\n\t\t\tthis.bodyData = extractFormValues(this.FORM_SELECTOR);\n\t\t}\n\n\t\tif (isOnShipping()) {\n\t\t\tthis.shippingRateSelector = `#${[...document.querySelectorAll(this.ALL_SHIPPINGS_SELECTOR)]\n\t\t\t\t.find(el => el.checked)\n\t\t\t\t.getAttribute('id')}`;\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n\n\tremoveCodes() {\n\t\tif (isOnInformation() && document.querySelector(this.REMOVE_DISCOUNT_SELECTOR)) {\n\t\t\tdocument.querySelector(this.REMOVE_DISCOUNT_SELECTOR).nextElementSibling.click();\n\t\t}\n\t\treturn super.removeCodes();\n\t}\n\n\tapplyCodes(codes) {\n\t\tif (isOnInformation()) {\n\t\t\treturn this._applyCodeManually(codes[0]);\n\t\t}\n\t\treturn super.applyCodes(codes);\n\t}\n\n\t_applyCodeManually(code) {\n\t\tsetValue(document.querySelector(this.CODES_INPUT_SELECTOR), code);\n\t\tconst isCodeApplied = () => document.querySelector(this.APPLIED_CODE_SELECTOR);\n\t\tdocument.querySelector(this.APPLY_BUTTON_SELECTOR).click();\n\t\treturn wait(isCodeApplied, 5000);\n\t}\n\n\t_parseTotal(data) {\n\t\tlet totalSumm = null;\n\t\tif (isOnShipping()) {\n\t\t\tconst shippingRateElement = extractElement(this.shippingRateSelector, data);\n\t\t\tconst shippingRateSelector = shippingRateElement\n\t\t\t\t? this.shippingRateSelector\n\t\t\t\t: this.SHIPPING_METHOD_SELECTOR;\n\t\t\ttotalSumm = extractData(shippingRateSelector, data, false, this.CHECKOUT_TOTAL_SELECTOR_ATTRIBUTE);\n\t\t} else {\n\t\t\ttotalSumm = extractData(this.TOTAL_SELECTOR, data);\n\t\t}\n\t\treturn toFloat(totalSumm);\n\t}\n\n\t_getCartSummary() {\n\t\t// on shipping page shipping methods is loaded dynamically and very slowly so we need to delay before each request\n\t\tconst promise = document.querySelector('[data-shipping-method-form]') ? Promise.delay(2000) : Promise.resolve();\n\t\treturn promise\n\t\t\t.then(() =>\n\t\t\t\tfetch(window.location.href, {\n\t\t\t\t\tcredentials: 'include',\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t)\n\t\t\t.then(response => response.text());\n\t}\n};\n\nexport default {\n\tname: 'Vanity Planet',\n\tdomain: 'vanityplanet.com',\n\tDriver,\n\tisSinglePageApp: true,\n\trestoreUserData: true,\n\tcompletionAction: isOnInformation() ? completionActions.none : completionActions.default,\n\tmaxCoupons: 4, // optimal time\n\tisOnCartUrl() {\n\t\treturn false;\n\t},\n};\n","import ShopifyDriver from './_base';\nimport { DOM } from '../../../utils';\n\nconst { extractFormValues } = DOM;\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.APPLIED_CODE_SELECTOR = '.edit_checkout .reduction-code__text';\n\t}\n\n\tbeforeTestCodes() {\n\t\tsuper.beforeTestCodes();\n\t\tthis.bodyData = extractFormValues('.order-summary__section--discount form:first-of-type');\n\t}\n};\n\nexport default {\n\tname: 'vioLife',\n\tdomain: 'violife.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith('https://www.violife.com/') && href.includes('/checkouts/');\n\t},\n};\n","import ShopifyDriver from './_base';\n\n/*\nDriver behavior description:\n• Existing code: yes\n• Remove code: yes\n• Stackable:  no\n• Free gift support:  no\n• ‘isValid’ implemented: yes\nSpecial case:\nWe can run code testing on checkout on\nthe second step for guest, and on checkout\non the first and on the second step for log in user.\n*/\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.isDynamic = false;\n\t}\n};\n\nexport default {\n\tname: 'Volcom',\n\tdomain: 'volcom.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn (\n\t\t\thref.startsWith('https://www.volcom.com/') &&\n\t\t\thref.includes('/checkouts/') &&\n\t\t\tdocument.querySelector('.product-table') &&\n\t\t\t!href.includes('stock_problems')\n\t\t);\n\t},\n};\n","import ShopifyDriver from './_base';\nimport { DOM, format } from '../../../utils';\n\nconst { elemToFloat, toFloat } = format;\nconst { extractElement, extractData } = DOM;\n\n/** Behavior description:\n- existing code: yes\n- remove code: yes\n- stackable: no\n- free gift support: no\n- free shipping: no\n- 'isValid' implemented: yes\n- manually apply code: no\n- replace code: there is only one valid code\n- Pages, where extension works: Checkout page\n- SPA: no\n- gather codes on site pages: no\n- Special case about the driver works:\n  - don't support Cart because there isn't code input;\n  - get total price from response\n  - if there is free shipping for item - finalPrice in console will be without shipping,\n    because after apply code shipping becomes not free and total price will be increase\n- credentials (josephhhh@gmail.com, 12345qwerty)\n */\n\nconst CODES_INPUT_SELECTOR = '.order-summary__section--discount #checkout_reduction_code';\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\n\t\tthis.FREE_SHIPPING_RESPONSE_SELECTOR = '.content-box__emphasis';\n\t\tthis.FREE_SHIPPING_PAGE_SELECTOR = '.total-line--shipping [data-checkout-total-shipping-target]';\n\t}\n\n\tremoveCodes() {\n\t\treturn this._removeCode()\n\t\t\t.then(() => this._getCartSummary())\n\t\t\t.then(responseHTML => {\n\t\t\t\t// need to check free shipping element\n\t\t\t\tconst freeShippingEl = extractElement(this.FREE_SHIPPING_RESPONSE_SELECTOR, responseHTML);\n\t\t\t\tthis.isFreeShippingInResponse = freeShippingEl\n\t\t\t\t\t? freeShippingEl.innerText.toLowerCase().trim() === 'free'\n\t\t\t\t\t: false;\n\t\t\t\treturn this._parseTotal(responseHTML);\n\t\t\t});\n\t}\n\n\tbeforeCheckCodes(originalPrice) {\n\t\tif (!originalPrice) {\n\t\t\t// need to get right total from response\n\t\t\treturn this._getCartSummary().then(responseHTML => this._parseTotal(responseHTML));\n\t\t}\n\t\treturn originalPrice;\n\t}\n\n\t_parseTotal(data) {\n\t\tlet totalSumm = null;\n\t\tconst isFreeShippingOnPage =\n\t\t\textractElement(this.FREE_SHIPPING_PAGE_SELECTOR)\n\t\t\t\t.innerText.toLowerCase()\n\t\t\t\t.trim() === 'free';\n\t\tif (data && this.IS_ON_SHIPPING && !this.isFreeShippingInResponse && !isFreeShippingOnPage) {\n\t\t\tconst shippingRateSelector = `.content-box__row:nth-of-type(${this.shippingPriceIndex + 1}) .input-radio`;\n\t\t\ttotalSumm = toFloat(extractData(shippingRateSelector, data, false, this.CHECKOUT_TOTAL_SELECTOR_ATTRIBUTE));\n\t\t} else {\n\t\t\ttotalSumm = elemToFloat(extractElement(this.TOTAL_SELECTOR, data));\n\t\t}\n\t\treturn totalSumm;\n\t}\n};\n\nexport default {\n\tname: 'Wetseal',\n\tdomain: 'wetseal.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn (\n\t\t\thref.startsWith('https://www.wetseal.com/') &&\n\t\t\thref.includes('/checkouts/') &&\n\t\t\t!href.includes('stock_problems') &&\n\t\t\tdocument.querySelector(CODES_INPUT_SELECTOR)\n\t\t);\n\t},\n\t// no need to write isCartEmpty() because user can`t go to the checkout page without goods\n};\n","import ShopifyDriver from './_base';\n\n// Driver behaviour description:\n// •    Existing code: yes\n// •    Remove code: yes\n// •    Stackable: no\n// •    Free gift support: no\n// •    'isValid' implemented: yes\n// •     Codes can be replaced by another code: yes\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t\tthis.APPLIED_CODE_SELECTOR = '.tags-list .reduction-code__text';\n\t}\n};\n\nexport default {\n\tname: 'wildfox',\n\tdomain: 'wildfox.com',\n\tDriver,\n\tmaxCoupons: 8, // site locks us\n\tisOnCartUrl(href) {\n\t\treturn href.startsWith('https://www.wildfox.com/') && href.includes('/checkouts/');\n\t},\n};\n","import ShopifyDriver from './_base';\nimport { DOM, completionActions } from '../../../utils';\n\nconst { setValue } = DOM;\n\n/* Driver behaviour\n- Free gift support: no\n- Free shipping: no\n- ‘isValid’ implemented: yes\n- Pages, where extension works: Checkout\n- Existing code: yes\n- Stackable: no\n- manuallyApply: yes\n- remove code: no\n- SPA: no\n* */\n\nconst Driver = class Driver extends ShopifyDriver {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.loadPageDynamic = true;\n\t\tthis.CODE_INPUT_SELECTOR = '#checkout_reduction_code';\n\t\tthis.APPLY_CODE_SELECTOR = '.field__input-btn';\n\t}\n\n\tapplyCodes(codes) {\n\t\treturn this._manuallyApplyCode(codes[0]);\n\t}\n\n\t_manuallyApplyCode(code) {\n\t\tsetValue(document.querySelector(this.CODE_INPUT_SELECTOR), code);\n\t\tdocument.querySelector(this.APPLY_CODE_SELECTOR).click();\n\t}\n};\n\nexport default {\n\tname: 'Windsor',\n\tdomain: 'windsorstore.com',\n\tshowDifferentDiscountMessage: true,\n\tmaxCoupons: 7,\n\tcompletionAction: completionActions.none,\n\tDriver,\n\tisOnCartUrl(href) {\n\t\treturn (\n\t\t\thref.startsWith('https://www.windsorstore.com/') &&\n\t\t\thref.includes('/checkouts/') &&\n\t\t\t!document.querySelector('.status-error')\n\t\t);\n\t},\n};\n"],"sourceRoot":""}