!function(e){function t(t){for(var n,i,s=t[0],c=t[1],u=t[2],d=0,m=[];d<s.length;d++)i=s[d],a[i]&&m.push(a[i][0]),a[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(l&&l(t);m.length;)m.shift()();return o.push.apply(o,u||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],n=!0,s=1;s<r.length;s++){var c=r[s];0!==a[c]&&(n=!1)}n&&(o.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},a={23:0},o=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;o.push([435,0]),r()}({0:function(e,t,r){"use strict";r.r(t);r(17),r(29),r(12),r(19),r(20);function n(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function a(e){return function(){var t=this,r=arguments;return new Promise(function(a,o){var i=e.apply(t,r);function s(e){n(i,a,o,s,c,"next",e)}function c(e){n(i,a,o,s,c,"throw",e)}s(void 0)})}}var o={asyncForEachExecutedInParallel:(e,t,...r)=>a(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Promise.all(e.map(e=>t(e,...r))));case 1:case"end":return n.stop()}},n)}))(),asyncForEachExecutedInSuccession:(e,t,...r)=>a(regeneratorRuntime.mark(function n(){var a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:a=[],o=0;case 2:if(!(o<e.length)){n.next=11;break}return n.t0=a,n.next=6,t(e[o],...r);case 6:n.t1=n.sent,n.t0.push.call(n.t0,n.t1);case 8:o++,n.next=2;break;case 11:return n.abrupt("return",a);case 12:case"end":return n.stop()}},n)}))()},i=r(24),s=r(114),c=(r(44),{compare(e,t){const r=e.split("."),n=t.split(".");for(let e=0;e<3;e++){const t=Number(r[e]),a=Number(n[e]);if(!Number.isNaN(Number(t))&&Number.isNaN(Number(a)))return 1;if(Number.isNaN(Number(t))&&!Number.isNaN(Number(a)))return-1;if(t>a)return 1;if(a>t)return-1}return 0}}),u={isEnabled(e,t){if(!e||e.disableBrowserExtensionDriver)return!1;const r=e.browserExtensionMinimumDriverVersion;return!r||c.compare(t,r)>=0}},l=r(41),d=r(188),m=r.n(d),p={decode:e=>m()(e)},f=r(80),h=(r(13),r(130),{enrichCodes:(e,t)=>e.codes.filter(e=>t.indexOf(e.code)>-1).reduce((e,t)=>(Object.assign(e,{[t.code]:t}),e),{})}),b=r(116);r(16),r(10);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var w={standardizedOnBeforeRequest(e){return this._standardizedInitiator(e)},standardizedOnCompleted(e){return this._standardizedInitiator(e)},_standardizedInitiator(e){const t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach(function(t){v(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},e);return e.originUrl&&(t.initiator=e.originUrl),t}},x=r(115);function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function O(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r(52),r(47),r(57),r(40),r(85);function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}r(84);function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var R={fetch:e=>{e.method||Object.assign(e,{method:"GET"});let t={};return fetch(e.url,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach(function(t){O(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},e,{credentials:"include"})).then(e=>(t=e,e.text())).then(e=>{const r=e;let n=e;try{n=JSON.parse(e)}catch(e){}return{status:t.status,statusText:t.statusText,headers:t.headers,redirected:t.redirected,body:n,text:()=>r,json:()=>JSON.parse(r)}})},xhr:e=>{const t=e.url,r=e.body,n=void 0===r?null:r,a=e.headers,o=void 0===a?[]:a,i=e.method,s=void 0===i?"GET":i;return new Promise((e,r)=>{const a=new XMLHttpRequest;a.withCredentials=!0,a.open(s,t,!0),a.onreadystatechange=(()=>{if(!a||4!==a.readyState)return;const t=function(e){const t=["age","authorization","content-length","content-type","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];try{const r=e.split("\n");return r.reduce((e,r)=>{const n=r.split(":").map(e=>e.trim()),a=E(n,2),o=a[0],i=a[1];return t.includes(o)||Object.assign(e,{[o]:i}),e},{})}catch(e){return{}}}(a.getAllResponseHeaders());let r=a.responseText;try{r=JSON.parse(r)}catch(e){}e({body:r,status:a.status,statusText:a.statusText,headers:t,text:()=>a.responseText,json:()=>JSON.parse(a.responseText)})}),a.onabort=(()=>r(new Error("Request aborted"))),a.onerror=(()=>r(new Error("Network Error"))),a.ontimeout=(()=>r(new Error("timeout exceeded"))),Object.entries(o).forEach(([e,t])=>{a.setRequestHeader(e,t)}),a.send(n)})},embedded:e=>{const t=e.url,r=e.headers,n=void 0===r?[]:r,a=e.method,o=void 0===a?"GET":a,i=e.caller,s=void 0===i?"XMLHttpRequest":i,c=e.withCredentials,u=void 0===c||c;let l=null;return l="string"==typeof e.body?e.body:e.body instanceof FormData?new URLSearchParams(e.body).toString():e.body instanceof URLSearchParams?e.body.toString():e.body instanceof Array||"object"==typeof e.body?JSON.stringify(e.body):e.body,new Promise((e,r)=>{delete sessionStorage.rmnTemp;const a=document.createElement("script"),i=Object.entries(n).map(([e,t])=>`request.setRequestHeader("${e}", "${t}");`);a.innerHTML=`\n\tvar request = new ${s}();\n\t\trequest.withCredentials = ${u};\n\t\trequest.open('${o}', '${t}', true);\n\n\t\t// Listen for ready state\n\t\trequest.onreadystatechange = () => {\n\t\t\tif (!request || request.readyState !== 4) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Prepare the response\n\t\t\tconst responseHeaders = reformatHeaders(request.getAllResponseHeaders());\n\t\t\tlet responseData = request.responseText;\n\n\t\t\tsessionStorage.rmnTemp = JSON.stringify({\n\t\t\t\tbody: responseData,\n\t\t\t\tstatus: request.status,\n\t\t\t\tstatusText: request.statusText,\n\t\t\t\theaders: responseHeaders\n\t\t\t});\n\t\t};\n\n\t\t// Handle browser request cancellation (as opposed to a manual cancellation)\n\t\trequest.onabort = () => {\n\t\t\tsessionStorage.rmnTemp = JSON.stringify({\n\t\t\t\tstatus: 600,\n\t\t\t\tstatusText: 'ABORTED'\n\t\t\t});\n\t\t};\n\t\t// Handle low level network errors\n\t\trequest.onerror = () => {\n\t\t\tsessionStorage.rmnTemp = JSON.stringify({\n\t\t\t\tstatus: 600,\n\t\t\t\tstatusText: 'Network error'\n\t\t\t});\n\t\t};\n\t\t// Handle timeout\n\t\trequest.ontimeout = () => {\n\t\t\tsessionStorage.rmnTemp = JSON.stringify({\n\t\t\t\tstatus: 600,\n\t\t\t\tstatusText: 'timeout of ' + config.timeout + 'ms exceeded'\n\t\t\t});\n\t\t};\n\n\n\t\t// Add headers to the request\n\t\t${i.join(" ")}\n\n\t\t// Send the request\n\t\t// when we have enclosed objects or arrays inside request json-body we need to\n\t\t// pass it like an object. Because such json will be incorrectly transformed into string.\n\n\t\trequest.send('${l}');\n\n\t\tfunction reformatHeaders(headersString) {\n\tconst ignoreDuplicateOf = [\n\t\t'age', 'authorization', 'content-length', 'content-type', 'etag',\n\t\t'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',\n\t\t'last-modified', 'location', 'max-forwards', 'proxy-authorization',\n\t\t'referer', 'retry-after', 'user-agent'\n\t];\n\tconst emptyHeadersObject = {};\n\ttry {\n\t\tconst headersArray = headersString.split('\\n');\n\t\treturn headersArray.reduce((headersObject, current) => {\n\t\t\tconst arr = current.split(':');\n\t\t\tconst key = arr[0].trim();\n\t\t\tconst value = arr[1].trim();\n\t\t\tif (ignoreDuplicateOf.indexOf(key) === -1) {\n\t\t\t\theadersObject[key] = value;\n\t\t\t}\n\n\t\t\treturn headersObject;\n\t\t}, emptyHeadersObject);\n\t} catch (e) {\n\t\treturn emptyHeadersObject;\n\t}\n}\n\t`,document.body.appendChild(a);const c=setInterval(()=>{if(sessionStorage.rmnTemp){const t=JSON.parse(sessionStorage.rmnTemp);delete sessionStorage.rmnTemp,a.remove();const n=t.body;try{t.body=JSON.parse(t.body)}catch(e){}clearInterval(c),t.status>=600&&r(new Error(t.statusText)),e(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach(function(t){S(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},t,{text:()=>n,json:()=>JSON.parse(n)}))}},300)})}};function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach(function(t){I(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function I(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var T=new class{constructor({type:e}){this.adapter=R[e],this.defaultHeaders={},this.mergeHeaders=!1}get(e,t={}){return Object.keys(this.defaultHeaders).length&&Object.assign(t,{headers:this._prepareHeaders(t.headers)}),this._getAdapter(t)(j({url:e,method:"GET"},t))}head(e,t={}){return Object.keys(this.defaultHeaders).length&&Object.assign(t,{headers:this._prepareHeaders(t.headers)}),this._getAdapter(t)(j({url:e,method:"HEAD"},t))}options(e,t={}){return Object.keys(this.defaultHeaders).length&&Object.assign(t,{headers:this._prepareHeaders(t.headers)}),this._getAdapter(t)(j({url:e,method:"OPTIONS"},t))}post(e,t=null,r={}){return Object.keys(this.defaultHeaders).length&&Object.assign(r,{headers:this._prepareHeaders(r.headers)}),this._getAdapter(r)(j({url:e,body:t,method:"POST"},r))}put(e,t=null,r={}){return Object.keys(this.defaultHeaders).length&&Object.assign(r,{headers:this._prepareHeaders(r.headers)}),this._getAdapter(r)(j({url:e,body:t,method:"PUT"},r))}patch(e,t=null,r={}){return Object.keys(this.defaultHeaders).length&&Object.assign(r,{headers:this._prepareHeaders(r.headers)}),this._getAdapter(r)(j({url:e,body:t,method:"PATCH"},r))}delete(e,t={}){return Object.keys(this.defaultHeaders).length&&Object.assign(t,{headers:this._prepareHeaders(t.headers)}),this._getAdapter(t)(j({url:e,method:"DELETE"},t))}setType(e){return this.adapter=R[e]||this.adapter,Boolean(R[e])}setDefaultHeaders(e,t=!1){if("object"!=typeof e||"boolean"!=typeof t)throw new Error("You need to pass valid values into setDefaultHeaders method!");return this.defaultHeaders=e,this.mergeHeaders=t,!0}_prepareHeaders(e){return e?this.mergeHeaders?Object.assign(this.defaultHeaders,e):e:this.defaultHeaders}_getAdapter(e){return e.type&&R[e.type]||this.adapter}}({type:"fetch"}),C={fetch:"fetch",xhr:"xhr",embedded:"embedded"};function P(e){const t={};return Object.entries(e).forEach(([e,r])=>{let n=r;"object"!=typeof r&&(n={type:r,required:!0}),t[e]=n}),t}r.d(t,"asyncUtils",function(){return o}),r.d(t,"browserUtils",function(){return i}),r.d(t,"DOM",function(){return s.a}),r.d(t,"driverUtils",function(){return u}),r.d(t,"format",function(){return l.a}),r.d(t,"jwt",function(){return p}),r.d(t,"log",function(){return f.a}),r.d(t,"merchant",function(){return h}),r.d(t,"semver",function(){return c}),r.d(t,"sendXhr",function(){return b.a}),r.d(t,"webRequest",function(){return w}),r.d(t,"completionActions",function(){return x.a}),r.d(t,"request",function(){return T}),r.d(t,"requestTypes",function(){return C}),r.d(t,"requireProps",function(){return P})},107:function(e,t,r){"use strict";(function(e){r(17),r(29),r(12),r(44),r(10),r(19),r(20);var n=r(14),a=r(0),o=r(4),i=r(31),s=r(82),c=r(7),u=r(93),l=r(24);function d(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function m(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function i(e){d(o,n,a,i,s,"next",e)}function s(e){d(o,n,a,i,s,"throw",e)}i(void 0)})}}const p=a.asyncUtils.asyncForEachExecutedInParallel,f="fromGenie",h=`https://www.${o.a.site.baseDomain}/ajax/rewardActivation`,b=function(){var t=m(regeneratorRuntime.mark(function t(r,n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.tabs.sendMessage(r,{instruction:"cboStatusChanged",cboStatus:"cboActivated",offerUuid:n}));case 1:case"end":return t.stop()}},t)}));return function(e,r){return t.apply(this,arguments)}}(),g=function(){var t=m(regeneratorRuntime.mark(function t(r){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.tabs.query({});case 2:return n=t.sent,t.next=5,p(n.map(e=>e.id),b,r);case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),v={apiEndpoint:void 0,activate({cashbackOffer:e,installationUuid:t,testVariations:r,pageName:a,fromGenie:o=!0}){var d=this;return m(regeneratorRuntime.mark(function m(){var p,h,b,g,v,w,x;return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(p=r){m.next=13;break}return c.b.captureException(new Error("failed to pass testVariations when activating CBO")),m.prev=3,m.next=6,s.a.getVariations(t);case 6:p=m.sent,m.next=13;break;case 9:m.prev=9,m.t0=m.catch(3),c.b.captureException(m.t0,{extra:{source:{filePath:"bg/cashback-api.js",method:"abTesting.getVariations"}}}),p=[];case 13:return m.next=15,d._getApiEndpoint();case 15:return h=m.sent,b={offer_uuid:e.uuid,[f]:1,externalExperiments:JSON.stringify(p)},g=Object.keys(b).map(e=>`${e}=${encodeURIComponent(b[e])}`).join("&"),w={success:!1,cboState:i.a.OFFER_ERROR},m.prev=19,m.next=22,fetch(`${h}?${g}`,{method:"GET",credentials:"include"});case 22:if(!(v=m.sent)||200!==v.status){m.next=44;break}return m.next=26,v.json();case 26:if(!(w=m.sent).success){m.next=31;break}Object(n.q)(e.uuid,w.success),m.next=42;break;case 31:m.t1=w.message,m.next="REBATE_INACTIVE"===m.t1?34:"REBATE_INVALID"===m.t1?37:"UNVERIFIED_EMAIL"===m.t1?38:"EMAIL_INVALID"===m.t1?40:41;break;case 34:return w.cboState=i.a.OFFER_ERROR,a&&o&&(x=a.split("/")[0],(Object(u.a)(Object(l.domainFromHostname)(x))?c.c:c.a).captureMessage(new Error(`${x} - Error: CBO was Expired!`),{extra:{info:{cashbackOffer:e,responseData:w}}})),m.abrupt("break",42);case 37:return m.abrupt("break",42);case 38:return w.cboState=i.a.OFFER_NOT_ACTIVATED,m.abrupt("break",42);case 40:case 41:return m.abrupt("break",42);case 42:m.next=45;break;case 44:w.message="ERROR";case 45:m.next=51;break;case 47:m.prev=47,m.t2=m.catch(19),c.b.captureException(m.t2,{extra:{source:{filePath:"bg/cashback-api.js",method:"cashbackApi.activate"},response:v,responseData:w}}),w.message="ERROR";case 51:return m.abrupt("return",w);case 52:case"end":return m.stop()}},m,null,[[3,9],[19,47]])}))()},listenForActivations(){function e(){return(e=m(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(a.log)("cbo activation listener"),r=a.browserUtils.parseQueryString(t.url),Object.prototype.hasOwnProperty.call(r,f)||!Object.prototype.hasOwnProperty.call(r,"offer_uuid")&&!Object.prototype.hasOwnProperty.call(r,"u")||200!==t.statusCode){e.next=9;break}return n=r.offer_uuid||r.u,!1,e.next=7,this.activate({cashbackOffer:{uuid:n},installationUuid:null,testVariations:[],pageName:null,fromGenie:!1});case 7:e.sent.success&&g(n);case 9:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}Object(a.log)("setting up webrequest listener for CBOs"),chrome.webRequest.onCompleted.addListener(function(t){return e.apply(this,arguments)}.bind(this),{urls:[`https://www.${o.a.site.baseDomain}/view/*`,`https://www.${o.a.site.baseDomain}/cashback?u=*`,`https://www.${o.a.site.baseDomain}/ajax/rewardActivation*`,`https://www.${o.a.site.baseDomain}/responsive/ajax/rewardActivation*`]})},handlePotentialDeactivationNotice(e){const t=a.browserUtils.domainFromHostname(e);return this.getActivatedCboUuids(t).then(e=>{const t=Object.keys(e);let r=!1;return t&&t.forEach(e=>{r=!0,Object(n.q)(e,!1)}),r}).then(r=>{r&&(Object(a.log)("sending deactivation notice: %s",e),chrome.tabs.query({url:[`*://${t}/*`,`*://*.${t}/*`]},e=>{e.forEach(e=>{chrome.tabs.sendMessage(e.id,{instruction:"cboStatusChanged",cboStatus:"cboDeactivated"})})}))})},getActivatedCboUuids(e){if(!e)return Promise.resolve([]);const t=Object(n.e)().then(t=>t[e]),r=Object(n.a)();return Promise.all([t,r]).then(e=>{const t=e[0]||[],r=e[1]||{},n={};return t.forEach(e=>{r[e]&&(n[e]=r[e])}),n})},_getApiEndpoint(){return this.apiEndpoint?Promise.resolve(this.apiEndpoint):Object(n.f)().then(e=>{this.apiEndpoint=e||h}).catch(()=>{this.apiEndpoint=h}).then(()=>this.apiEndpoint)}};t.a=v}).call(this,r(50))},108:function(e,t,r){"use strict";(function(e){r.d(t,"c",function(){return g}),r.d(t,"d",function(){return v}),r.d(t,"b",function(){return w}),r.d(t,"a",function(){return x});r(52),r(13),r(47),r(17),r(29),r(12),r(40),r(66),r(19),r(20);var n=r(0),a=r(109),o=r(64),i=r(2),s=r(4);function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function l(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function i(e){u(o,n,a,i,s,"next",e)}function s(e){u(o,n,a,i,s,"throw",e)}i(void 0)})}}const d=n.asyncUtils.asyncForEachExecutedInParallel;let m,p=[],f=!1;const h=e=>{switch(e){case i.b.LOGIN:return 760;case i.b.SIGN_UP:return 870;case i.b.VERIFY:return 630;default:throw new Error("Unsupported Pop Up Type")}},b=e=>{let t="";switch(e){case i.b.LOGIN:t="login";break;case i.b.SIGN_UP:t="register";break;case i.b.VERIFY:t="verify";break;default:throw new Error("Unsupported Pop Up Type")}const r=s.a.site.baseDomain;return`https://secure.${r}/accounts/${t}?returnTo=${encodeURIComponent(`https://www.${r}/genie/login`)}&ctx=cbo`},g=()=>m&&p[0].windowId,v=function(){var t=l(regeneratorRuntime.mark(function t(r){var n,a,o,i,s,u,l,d;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return f||y(),t.next=3,e.windows.getLastFocused();case 3:return n=t.sent,t.next=6,e.tabs.query({windowId:n.id,active:!0});case 6:return a=t.sent,o=c(a,1),i=o[0],p.unshift(i),s=h(r),470,u=n.top+Math.round((n.height-s)/2),l=n.left+Math.round((n.width-470)/2),t.next=16,e.windows.create({type:"popup",url:b(r),width:470,height:s,top:u,left:l});case 16:d=t.sent,m&&e.windows.remove(m),m=d.id;case 19:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),w=function(){var t=l(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!m){t.next=3;break}return t.next=3,e.windows.update(m,{focused:!0});case 3:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),x=function(){var t=l(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!m){t.next=3;break}return t.next=3,e.windows.remove(m);case 3:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}();function y(){e.windows.onRemoved.addListener(function(){var t=l(regeneratorRuntime.mark(function t(r){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!m||!p.map(e=>e.windowId).includes(r)){t.next=5;break}0===(p=p.filter(e=>e.windowId!==r)).length&&e.windows.remove(m),t.next=21;break;case 5:if(r!==m){t.next=21;break}return t.prev=6,Object(n.log)("pop up closed"),t.next=10,Object(a.b)();case 10:if(t.sent.rmn){t.next=16;break}return t.next=13,Object(o.c)();case 13:return i=t.sent,t.next=16,d(p.map(e=>e.id),o.d,i);case 16:d(p.map(e=>e.id),function(){var t=l(regeneratorRuntime.mark(function t(r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.tabs.sendMessage(r,{instruction:"popUpClosed"}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 17:return t.prev=17,m=void 0,p=[],t.finish(17);case 21:case"end":return t.stop()}},t,null,[[6,,17,21]])}));return function(e){return t.apply(this,arguments)}}()),e.tabs.onRemoved.addListener(t=>{m&&p.map(e=>e.id).includes(t)&&0===(p=p.filter(e=>e.id!==t)).length&&e.windows.remove(m)}),e.tabs.onUpdated.addListener((t,r)=>{m&&p.map(e=>e.id).includes(t)&&(r.url||"loading"===r.status)&&0===(p=p.filter(e=>e.id!==t)).length&&e.windows.remove(m)}),e.tabs.onActivated.addListener(({tabId:e})=>{m&&p.map(e=>e.id).includes(e)&&w()}),f=!0}}).call(this,r(50))},109:function(e,t,r){"use strict";(function(e){r.d(t,"a",function(){return u}),r.d(t,"b",function(){return d}),r.d(t,"c",function(){return p});r(17),r(29),r(12),r(19),r(20);var n=r(0),a=r(7);function o(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function i(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var i=e.apply(t,r);function s(e){o(i,n,a,s,c,"next",e)}function c(e){o(i,n,a,s,c,"throw",e)}s(void 0)})}}const s=r(4).a.site.baseDomain,c=n.asyncUtils.asyncForEachExecutedInParallel,u=()=>e.permissions.contains({origins:[`https://secure.${s}/`,`https://www.${s}/`]}),l=()=>e.permissions.contains({origins:["<all_urls>"]}),d=()=>Promise.all([l(),u()]).then(e=>({all:e[0],rmn:e[1]})).catch(e=>(a.b.captureException(e,{extra:{source:{filePath:"bg/permissions.js",method:"getExtensionPermissions"}}}),{all:!0,rmn:!0})),m=function(){var t=i(regeneratorRuntime.mark(function t(r,n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.tabs.sendMessage(r,{instruction:"permissionsChanged",permissions:n}));case 1:case"end":return t.stop()}},t)}));return function(e,r){return t.apply(this,arguments)}}(),p=()=>{chrome.permissions.onRemoved&&chrome.permissions.onRemoved.addListener(i(regeneratorRuntime.mark(function t(){var r,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.tabs.query({});case 2:return r=t.sent,t.next=5,d();case 5:return n=t.sent,t.next=8,c(r.map(e=>e.id),m,n);case 8:case"end":return t.stop()}},t)})))}}).call(this,r(50))},110:function(e,t,r){"use strict";r.d(t,"e",function(){return A}),r.d(t,"d",function(){return D}),r.d(t,"a",function(){return N}),r.d(t,"b",function(){return U}),r.d(t,"c",function(){return L});r(52),r(13),r(17),r(29),r(56),r(271),r(122),r(12),r(40),r(274),r(44),r(10),r(19),r(20);var n=r(368),a=r.n(n),o=r(264),i=r.n(o),s=r(4),c=r(7),u=r(14),l=r(0),d=r(43),m=r(31),p=r(93);function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function h(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function b(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function i(e){h(o,n,a,i,s,"next",e)}function s(e){h(o,n,a,i,s,"throw",e)}i(void 0)})}}const g=new Map,v={timestamp:null,merchants:[]};let w,x;const y=function(){var e=b(regeneratorRuntime.mark(function e(t,r,n){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.name!==d.a.NETWORK_ERROR&&t.name!==d.a.JSONP_ERROR&&t.name!==d.a.TIMEOUT_ERROR){e.next=14;break}return e.next=3,new Promise(e=>setTimeout(e,100));case 3:return e.prev=3,e.next=6,r.search(n);case 6:return a=e.sent,e.abrupt("return",a);case 10:throw e.prev=10,e.t0=e.catch(3),c.b.captureException(e.t0,{extra:{AlgoliaSearchRetry:n,source:{filePath:"bg/content-api.js",method:"_handleAlgoliaSearchError"}}}),e.t0;case 14:throw t;case 15:case"end":return e.stop()}},e,null,[[3,10]])}));return function(t,r,n){return e.apply(this,arguments)}}(),O=(e,t,r=!1)=>(Object(l.log)("Browsing merchants started."),new Promise((n,a)=>{const o=e.browseAll(t),i=[];o.on("result",e=>{i.push(...e.hits),r&&(o.stop(),n(i))}),o.on("end",()=>(Object(l.log)("Browsing merchants finished!"),n(i))),o.on("error",e=>a(e))})),E=function(){var e=b(regeneratorRuntime.mark(function e(t,r,n){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.name!==d.a.NETWORK_ERROR&&t.name!==d.a.JSONP_ERROR&&t.name!==d.a.TIMEOUT_ERROR){e.next=14;break}return e.next=3,new Promise(e=>setTimeout(e,100));case 3:return e.prev=3,e.next=6,O(r,n);case 6:return a=e.sent,e.abrupt("return",a);case 10:throw e.prev=10,e.t0=e.catch(3),c.b.captureException(e.t0,{extra:{AlgoliaSearchRetry:n,source:{filePath:"bg/content-api.js",method:"handleAlgoliaBrowseError._browseForMerchants"}}}),e.t0;case 14:throw t;case 15:case"end":return e.stop()}},e,null,[[3,10]])}));return function(t,r,n){return e.apply(this,arguments)}}(),k=function(){var e=b(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(x){e.next=8;break}return e.next=3,Object(u.c)();case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0=s.a.api.readKey;case 6:t=e.t0,x=i()("RCSNJTTPHT",t,{useFallback:!1});case 8:return e.abrupt("return",x);case 9:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),S=function(){var e=b(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(w){e.next=11;break}return e.next=3,Object(u.d)();case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0=s.a.api.merchantIndex;case 6:return t=e.t0,e.next=9,k();case 9:r=e.sent,w=r.initIndex(t);case 11:return e.abrupt("return",w);case 12:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),R=function(){var e=b(regeneratorRuntime.mark(function e(){var t,r,n,o,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=["domain","isEnabledOnBrowserExtension","disableBrowserExtensionDriver","browserExtensionBlacklistedSubdomains","browserExtensionDomainOverride","browserExtensionMinimumDriverVersion","browserExtensionSettings","title","uuid","codesCount","rebatesCount"],e.next=3,S();case 3:return r=e.sent,n={query:"",filters:"isEnabledOnBrowserExtension:true",attributesToRetrieve:t,distinct:!0,hitsPerPage:1e3},e.prev=5,e.next=8,O(r,n);case 8:o=e.sent,e.next=16;break;case 11:return e.prev=11,e.t0=e.catch(5),e.next=15,E(e.t0,r,n);case 15:o=e.sent;case 16:return r.clearCache(),i=o.map(e=>a()(e,t)).reduce((e,t)=>{const r=t.browserExtensionDomainOverride||t.domain;return e[r]=t,t.browserExtensionSettings&&t.browserExtensionSettings.additionalDomains&&t.browserExtensionSettings.additionalDomains.forEach(r=>{e[r]=t}),e},{}),g.set("merchants",{merchants:i,timestamp:Date.now()}),e.next=21,Object(u.e)();case 21:return s=e.sent,Object.keys(s).filter(e=>void 0===i[e]).forEach(e=>{Object(u.u)(e,[])}),e.abrupt("return",i);case 24:case"end":return e.stop()}},e,null,[[5,11]])}));return function(){return e.apply(this,arguments)}}(),_=function(){var e=b(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=g.get("merchants"))&&!(Date.now()-t.timestamp>36e5)){e.next=3;break}return e.abrupt("return",R());case 3:return e.abrupt("return",t.merchants);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),j=e=>{const t=f((e.browserExtensionSettings||{}).genieOnlyRebates||[],1)[0];if(t&&t.startShowableDate&&t.endShowableDate){const r=Date.now(),n=new Date(t.startShowableDate).getTime(),a=new Date(t.endShowableDate).getTime();n<=r&&r<=a&&(e.rebates=[t])}},I=e=>{const t=e.browserExtensionStoreSuppressions;if(t){const r=Date.now();t.forEach(t=>{const n=t.offerTypeFilter;let a=t.startDate,o=t.endDate;if(n&&a&&o&&(a=Date.parse(a),o=Date.parse(o),a<r&&o>r))switch(n){case"CODE":e.codes=[];break;case"UGC":e.codes=e.codes.filter(e=>!e.isUgc);break;case"CASH_BACK_OFFER":e.rebates=[]}})}},T=e=>e.filter(e=>{const t=Date.parse(e.startDate),r=Date.parse(e.endDate),n=Date.now();return!(r&&n>r)&&!(t&&n<t)}),C=e=>{const t=e.rebates.map(e=>e.uuid);Object(u.u)(e.domain,t)},P=function(){var e=b(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.rebates&&0!==t.rebates.length){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(u.a)();case 4:r=e.sent,t.rebates.forEach(e=>{const t=r[e.uuid];let n;if(-1===t)n=m.a.OFFER_STOOD_DOWN;else{n=!!t&&Date.now()-t<=432e5?m.a.OFFER_ACTIVATED:m.a.OFFER_NOT_ACTIVATED}e.offerStatus=n});case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=b(regeneratorRuntime.mark(function e(t=""){var r,n,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",_());case 2:return e.next=4,S();case 4:return r=e.sent,n={query:t,attributesToRetrieve:["uuid","domain","title","codes","rebates","browserExtensionStoreSuppressions"],filters:"isEnabledOnBrowserExtension:true AND (codesCount > 0 OR rebatesCount > 0)",hitsPerPage:1e3},e.prev=7,e.next=10,O(r,n);case 10:a=e.sent,e.next=18;break;case 13:return e.prev=13,e.t0=e.catch(7),e.next=17,E(e.t0,r,n);case 17:a=e.sent;case 18:return o=a.reduce((e,t)=>(I(t),t.rebates=T(t.rebates),t.codesCount=t.codes.length,t.rebatesCount=t.rebates.length,t.codesCount||t.rebatesCount?(delete t.codes,delete t.rebates,delete t.browserExtensionStoreSuppressions,[...e,t]):e),[]),r.clearCache(),e.abrupt("return",o.slice(0,50));case 21:case"end":return e.stop()}},e,null,[[7,13]])}));return function(){return e.apply(this,arguments)}}(),D=function(){var e=b(regeneratorRuntime.mark(function e(t=p.b.size){var r,n,a,o,i,s,u,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(v.timestamp&&Date.now()-v.timestamp<36e5&&v.merchants.length)){e.next=2;break}return e.abrupt("return",v.merchants.slice(0,t));case 2:return e.next=4,S();case 4:return r=e.sent,n=[...p.b],a=["uuid","domain","title","codes","rebates","browserExtensionStoreSuppressions"],o=n.map(e=>`domain:${e}`).join(" OR "),i=["isEnabledOnBrowserExtension:true","disableBrowserExtensionDriver:false","codesCount >= 1"].join(" AND "),s={filters:`(${o}) AND ${i}`,attributesToRetrieve:a,hitsPerPage:1e3},e.prev=12,e.next=15,O(r,s);case 15:u=e.sent,e.next=23;break;case 18:return e.prev=18,e.t0=e.catch(12),e.next=22,E(e.t0,r,s);case 22:u=e.sent;case 23:return(l=u.reduce((e,t)=>(I(t),t.rebates=T(t.rebates),t.codes.some(e=>"Top Rated"===e.ranking)?(t.codesCount=t.codes.length,t.rebatesCount=t.rebates.length,delete t.codes,delete t.rebates,delete t.browserExtensionStoreSuppressions,[...e,t]):e),[]).sort((e,t)=>{return n.findIndex(t=>t===e.domain)-n.findIndex(e=>e===t.domain)})).length<10&&c.b.captureException(new Error("Top merchants list contains less than 10 merchants")),r.clearCache(),v.timestamp=Date.now(),v.merchants=l,e.abrupt("return",l.slice(0,t));case 29:case"end":return e.stop()}},e,null,[[12,18]])}));return function(){return e.apply(this,arguments)}}(),N=function(){var e=b(regeneratorRuntime.mark(function e(t){var r,n,a,o,i,s,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:return r=e.sent,n=v.merchants.map(e=>e.domain),a=["uuid","domain","title","codes","rebates","browserExtensionStoreSuppressions"],o=n.map(e=>`NOT domain:${e}`).join(" AND "),i={query:"",filters:`(${o}) AND isEnabledOnBrowserExtension:true AND (codesCount > 0 OR rebatesCount > 0)`,attributesToRetrieve:a,hitsPerPage:20,page:t},e.prev=8,e.next=11,O(r,i,!0);case 11:s=e.sent,e.next=19;break;case 14:return e.prev=14,e.t0=e.catch(8),e.next=18,E(e.t0,r,i);case 18:s=e.sent;case 19:return c=s.reduce((e,t)=>(I(t),t.rebates=T(t.rebates),t.codesCount=t.codes.length,t.rebatesCount=t.rebates.length,t.codesCount||t.rebatesCount?(delete t.codes,delete t.rebates,delete t.browserExtensionStoreSuppressions,[...e,t]):e),[]),r.clearCache(),e.abrupt("return",c);case 22:case"end":return e.stop()}},e,null,[[8,14]])}));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=b(regeneratorRuntime.mark(function e(t){var r,n,a,o,i,s,c,u,l,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r={codes:[],rebates:[]},t){e.next=3;break}return e.abrupt("return",r);case 3:if(n=g.get(t),!(n&&Date.now()-n.timestamp<=36e5)){e.next=10;break}return a=n.merchant,e.next=9,P(a);case 9:return e.abrupt("return",a);case 10:return e.next=12,_();case 12:if(o=e.sent,i=o[t]){e.next=16;break}return e.abrupt("return",r);case 16:return e.next=18,S();case 18:return s=e.sent,c={query:"",filters:`domain:${i.domain}`,distinct:!0},e.prev=20,e.next=23,s.search(c);case 23:l=e.sent,u=l.hits,e.next=33;break;case 27:return e.prev=27,e.t0=e.catch(20),e.next=31,y(e.t0,s,c);case 31:d=e.sent,u=d.hits;case 33:if(s.clearCache(),(a=u[0]).rebates=T(a.rebates),a){e.next=38;break}return e.abrupt("return",r);case 38:return j(a),I(a),C(a),g.set(t,{merchant:a,timestamp:Date.now()}),e.next=44,P(a);case 44:return e.abrupt("return",a);case 45:case"end":return e.stop()}},e,null,[[20,27]])}));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=b(regeneratorRuntime.mark(function e(t){var r,n,a,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_();case 2:r=e.sent,n=t.split("."),a=n.length-2,o=0;case 6:if(!(o<a)){e.next=14;break}if(o+=1,!(i=r[n.join(".")])){e.next=11;break}return e.abrupt("return",i.browserExtensionDomainOverride||i.domain);case 11:n.shift(),e.next=6;break;case 14:return e.abrupt("return",l.browserUtils.domainFromHostname(t));case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},114:function(e,t,r){"use strict";r.d(t,"d",function(){return s}),r.d(t,"c",function(){return c}),r.d(t,"f",function(){return u}),r.d(t,"b",function(){return l}),r.d(t,"e",function(){return d});r(273),r(17),r(29),r(56),r(12),r(272),r(190),r(19),r(84);var n=r(187),a=r.n(n),o=r(24);const i={extractFromHTML:function(e,t,r,n){const a=document.implementation.createHTMLDocument();if(a.body.innerHTML=e,r){const e=[...a.querySelectorAll(t)];return n?e.map(e=>e.getAttribute(n)):e.map(e=>e.textContent)}const o=a.querySelector(t);return o?n?o.getAttribute(n):o.textContent:""},extractElementFromHTML:function(e,t,r){const n=document.implementation.createHTMLDocument();return n.body.innerHTML=e,r?n.querySelectorAll(t):n.querySelector(t)},extractFormValues:function(e,t,r){let n=null;if(t){const r=document.implementation.createHTMLDocument();r.body.innerHTML=t,n=r.querySelector(e)}else n=document.querySelector(e);if(n){const e=a()(n,{empty:!0,hash:!1}),t=new URLSearchParams(e),o=Array.from(t).reduce((e,[n,a])=>{if(n.endsWith("[]")){const r=n.slice(0,-2);e.has(r)||e.set(r,t.getAll(n).join(","))}else r?e.append(n,a):e.set(n,a);return e},new URLSearchParams);let i=n.action;return i&&"string"==typeof n.action||(i=n.getAttribute("action")||null),i&&(i.startsWith("//")?i=window.location.protocol+i:i.startsWith("http")||(i.startsWith("/")||(i=`/${i}`),i=window.location.origin+i)),{action:i,params:o}}return null},extractElement:function(e,t=!1,r=!1){const n=t?(new DOMParser).parseFromString(t,"text/html"):document;return r?n.querySelectorAll(e):n.querySelector(e)},setValue:function(e,t,r="input"){const n=Object.getPrototypeOf(e);Object.getOwnPropertyDescriptor(n,"value").set.call(e,t),e.dispatchEvent(new Event(r,{bubbles:!0}))},extractData:function(e,t=null,r=!1,n=null){const a=i.extractElement(e,t,r),o=e=>n?e.getAttribute(n):e.textContent;return r?[...a].map(e=>o(e)):o(a)},runEmbeddedScript:function(e,t=null,r={conditionMethod:()=>!0,maxWaitTime:4e3,stepTime:300}){t&&(window[t]=null);localStorage.removeItem("rmnReturnValue"),localStorage.removeItem("rmnExceptionOfScript");const n=t?`${e} localStorage.setItem('rmnReturnValue', ${t});`:e;return new Promise(e=>{const r=document.createElement("script");if(r.innerHTML=`try {\n\t\t\t\t${n}\n\t\t\t}\n\t\t\tcatch (error) {\n\t\t\t\tlocalStorage.setItem('rmnExceptionOfScript', true);\n\t\t\t}`,document.body.appendChild(r),r.remove(),localStorage.rmnExceptionOfScript)throw localStorage.removeItem("rmnExceptionOfScript"),new Error("Exception in embedded script");t&&(window[t]=localStorage.getItem("rmnReturnValue"),localStorage.removeItem("rmnReturnValue")),e()}).then(()=>Object(o.wait)(r.conditionMethod,r.maxWaitTime,r.stepTime)).then(()=>t?window[t]:null)}};t.a=i;i.extractFromHTML,i.extractElementFromHTML;const s=i.extractFormValues,c=i.extractElement,u=i.setValue,l=i.extractData,d=i.runEmbeddedScript},115:function(e,t,r){"use strict";t.a={reload:"reload",revisit:"revisit",custom:"custom",none:"none",default:"reload"}},116:function(e,t,r){"use strict";r(17),r(57),r(12),r(44),r(85),r(10),r(19);t.a=((e,t)=>{const r=t.method||"GET",n="include"===t.credentials,a=t.headers,o=void 0===a?[]:a,i=t.body,s=void 0===i?null:i;return new Promise(t=>{const a=new XMLHttpRequest;a.withCredentials=n,a.open(r,e),Object.entries(o).forEach(([e,t])=>{a.setRequestHeader(e,t)}),a.onreadystatechange=(()=>{a.readyState===XMLHttpRequest.DONE&&t({get status(){return a.status},headers(){const e={get(e){return this[e]?this[e]:null}};try{return a.getAllResponseHeaders().split("\n").reduce((e,t)=>{const r=t.split(":");return e[r[0].trim()]=r[1].trim(),e},e)}catch(t){return e}},json:()=>JSON.parse(a.responseText),text:()=>a.responseText})}),a.send(s)})})},127:function(e){e.exports=[{name:"eBates",extensionId:"chhjbpecpncaggjpdakmflnfcopglcmi",webAccessibleResourcePath:"content/style.css"},{name:"Wikibuy",extensionId:"nenlahapcbofgnanklpelkaejcehkggg",webAccessibleResourcePath:"notifications/wikibuy.js"},{name:"Amazon Assistant",extensionId:"pbjikboenpfhbbejgkoklgkhjpfogcam",webAccessibleResourcePath:"static/html/localProxy.html"},{name:"Piggy",extensionId:"hfapbcheiepjppjbnkphkmegjlipojba",webAccessibleResourcePath:"img/new/found-coupons.svg"},{name:"Cently",extensionId:"kegphgaihkjoophpabchkmpaknehfamb",webAccessibleResourcePath:"assets/css/common.css"},{name:"Honey",extensionId:"bmnlcjabgnpnenekpadlanbbkooimhnj",webAccessibleResourcePath:"honey_pay/index.html"}]},128:function(e){e.exports=[{name:"AdBlock",extensionId:"gighmmpiobklfepjocnamgkkbiglidom",webAccessibleResourcePath:"fonts/lato-ext-bolditalic.woff"},{name:"uBlocker",extensionId:"ighmaabplogboibmpbehhbfannflgjcd",webAccessibleResourcePath:"adblock-jquery-ui.custom.css"},{name:"Ghostery",extensionId:"mlomiejdfkolichcflejclcbmpeaniij",webAccessibleResourcePath:"app/images/hub/side-navigation/ghostery-logo.svg"},{name:"AdBlocker Ultimate",extensionId:"ohahllgiabjaoigichmmfljhkcfikeof",webAccessibleResourcePath:"elemhidehit.png"}]},129:function(e,t,r){"use strict";(function(e,n){r.d(t,"c",function(){return x}),r.d(t,"a",function(){return y}),r.d(t,"b",function(){return O});r(47),r(12),r(66),r(20);var a=r(38),o=r.n(a),i=r(0),s=r(108),c=r(4),u=r(71),l=r(18),d=r(7),m=r(82);function p(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function f(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function i(e){p(o,n,a,i,s,"next",e)}function s(e){p(o,n,a,i,s,"throw",e)}i(void 0)})}}let h=null,b=null;const g=(t,r)=>{setTimeout(f(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.tabs.remove(t);case 3:n.next=14;break;case 5:if(n.prev=5,n.t0=n.catch(0),n.t1=b,n.t1){n.next=12;break}return n.next=11,i.browserUtils.lookForInstalledAdBlockers();case 11:n.t1=n.sent;case 12:b=n.t1,d.b.captureException(new Error("Error trying to remove Macys outclick tab"),{extra:{error:n.t0,source:{filePath:"bg/outclick.js",method:"outclick.tabs.remove"},tabInfo:JSON.stringify(r),installedAdBlockers:b}});case 14:case"end":return n.stop()}},n,null,[[0,5]])})),2e3)},v=function(){var t=f(regeneratorRuntime.mark(function t(r,n,a){var o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(h!==r||"complete"!==n.status){t.next=35;break}if(!a.url||!a.url.includes(`o.${c.a.site.baseDomain}`)){t.next=9;break}if(t.t0=b,t.t0){t.next=7;break}return t.next=6,i.browserUtils.lookForInstalledAdBlockers();case 6:t.t0=t.sent;case 7:b=t.t0,d.b.captureException(new Error("Did not redirect from outclick service"),{extra:{outclickServiceUrl:a.url,installedAdBlockers:b}});case 9:if(h=null,t.prev=10,!a||!a.url.includes("www.macys.com")){t.next=15;break}g(r,a),t.next=17;break;case 15:return t.next=17,e.tabs.remove(r);case 17:t.next=29;break;case 19:if(t.prev=19,t.t1=t.catch(10),t.t1.message.includes("No tab with id:")){t.next=29;break}if(t.t2=b,t.t2){t.next=27;break}return t.next=26,i.browserUtils.lookForInstalledAdBlockers();case 26:t.t2=t.sent;case 27:b=t.t2,d.b.captureException(t.t1,{extra:{installedAdBlockers:b,source:{filePath:"bg/outclick.js",method:"outclick.tabs.remove"}}});case 29:return t.next=31,e.tabs.query({active:!0,currentWindow:!0});case 31:if(!(o=t.sent)[0]){t.next=35;break}return t.next=35,e.tabs.sendMessage(o[0].id,{tabClosed:!0});case 35:case"end":return t.stop()}},t,null,[[10,19]])}));return function(e,r,n){return t.apply(this,arguments)}}(),w=function(){var e=f(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:h===t&&(h=null);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),x=()=>{e.tabs.onUpdated.addListener(v),e.tabs.onRemoved.addListener(w)},y=function(){var e=f(regeneratorRuntime.mark(function e(t){var r,n,a,s,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=`https://o.${c.a.site.baseDomain}`,n="",e.prev=2,!t.testVariations){e.next=7;break}n=encodeURIComponent(JSON.stringify(t.testVariations)),e.next=14;break;case 7:return e.next=9,Object(u.a)();case 9:return a=e.sent,e.next=12,m.a.getVariations(a);case 12:s=e.sent,n=encodeURIComponent(JSON.stringify(s));case 14:e.next=25;break;case 16:if(e.prev=16,e.t0=e.catch(2),e.t1=b,e.t1){e.next=23;break}return e.next=22,i.browserUtils.lookForInstalledAdBlockers();case 22:e.t1=e.sent;case 23:b=e.t1,d.b.captureException(e.t0,{extra:{installedAdBlockers:b,source:{filePath:"bg/outclick.js",method:"getOutclickURL"}}});case 25:return t.viewInstanceUuid||(d.b.captureException(new Error("attempt to outclick with no pv uuid - content"),{extra:{uuid:t.uuid}}),l.a.currentViewInstanceUuid?Object.assign(t,{viewInstanceUuid:l.a.currentViewInstanceUuid}):(d.b.captureException(new Error("overlord view instance uuid has become unset")),Object.assign(t,{viewInstanceUuid:o.a.randomBase32()}))),p=`${r}/${t.uuid}?pageType=${t.pageType}&pageName=${t.pageName}&pv=${t.viewInstanceUuid}&utm_medium=genie`,c.a.abTesting.activeCampaigns.length&&n&&(p=`${p}&externalExperiments=${n}`),e.abrupt("return",p);case 30:case"end":return e.stop()}},e,null,[[2,16]])}));return function(t){return e.apply(this,arguments)}}(),O=function(){var t=f(regeneratorRuntime.mark(function t(r){var a,o,c,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null===h){t.next=3;break}return Object(i.log)("outclick canceled, previous outclick on tabId = %o haven't completed yet",h),t.abrupt("return");case 3:if("devtools"!==n.env.VUE_DEVTOOLS){t.next=5;break}return t.abrupt("return");case 5:return Object(i.log)("outclicking: %o",r),t.next=8,y(r);case 8:return a=t.sent,o={url:a,active:!1},(c=Object(s.c)())&&(o.windowId=c),t.next=14,e.tabs.create(o);case 14:u=t.sent,h=u.id;case 16:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}).call(this,r(50),r(76))},14:function(e,t,r){"use strict";(function(e){r.d(t,"f",function(){return u}),r.d(t,"d",function(){return l}),r.d(t,"c",function(){return d}),r.d(t,"B",function(){return m}),r.d(t,"p",function(){return p}),r.d(t,"k",function(){return b}),r.d(t,"y",function(){return g}),r.d(t,"i",function(){return v}),r.d(t,"w",function(){return w}),r.d(t,"n",function(){return x}),r.d(t,"z",function(){return y}),r.d(t,"l",function(){return O}),r.d(t,"t",function(){return E}),r.d(t,"h",function(){return k}),r.d(t,"e",function(){return S}),r.d(t,"u",function(){return R}),r.d(t,"a",function(){return _}),r.d(t,"q",function(){return j}),r.d(t,"r",function(){return I}),r.d(t,"A",function(){return T}),r.d(t,"o",function(){return C}),r.d(t,"j",function(){return P}),r.d(t,"x",function(){return A}),r.d(t,"m",function(){return D}),r.d(t,"b",function(){return N}),r.d(t,"v",function(){return U}),r.d(t,"g",function(){return L}),r.d(t,"s",function(){return V});r(17),r(131),r(12),r(113),r(19),r(20);var n=r(7),a=r(2);function o(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function i(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var i=e.apply(t,r);function s(e){o(i,n,a,s,c,"next",e)}function c(e){o(i,n,a,s,c,"throw",e)}s(void 0)})}}const s=function(){var t=i(regeneratorRuntime.mark(function t(r){var a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.storage.local.get(r);case 3:return a=t.sent,t.abrupt("return",Array.isArray(r)?a:a[r]);case 7:return t.prev=7,t.t0=t.catch(0),o=t.t0 instanceof Error?t.t0:new Error(t.t0),n.b.captureException(o,{extra:{source:{filePath:"bg/storage-access.js",method:"getKeyFromStorage",key:r}}}),t.abrupt("return",null);case 12:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e){return t.apply(this,arguments)}}(),c=function(){var t=i(regeneratorRuntime.mark(function t(r){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.storage.local.set(r);case 3:t.next=9;break;case 5:t.prev=5,t.t0=t.catch(0),a=t.t0 instanceof Error?t.t0:new Error(t.t0),n.b.captureException(a,{extra:{source:{filePath:"bg/storage-access.js",method:"storage-access.setStorageValue"},dictionary:r}});case 9:case"end":return t.stop()}},t,null,[[0,5]])}));return function(e){return t.apply(this,arguments)}}(),u=()=>s(a.c.OVERRIDES.REBATE_ACTIVATION_ENDPOINT),l=()=>s(a.c.OVERRIDES.DATA_STORE_INDEX),d=()=>s(a.c.OVERRIDES.DATA_STORE_API_KEY),m=function(){var e=i(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(a.c.NUMBER_OF_TIMES_CHECKED_CODES);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=0;case 5:return t=e.t0,e.next=8,s(a.c.LAST_CODE_TESTING_STATUS);case 8:if(e.t1=e.sent,e.t1){e.next=11;break}e.t1=!1;case 11:if(r=e.t1,!(t<=3)&&r){e.next=14;break}return e.abrupt("return",!1);case 14:return e.next=16,s(a.c.HAS_SEEN_GENIE_SURVEY);case 16:return e.abrupt("return",!e.sent);case 17:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),p=()=>c({[a.c.HAS_SEEN_GENIE_SURVEY]:!0}),f=function(){var e=i(regeneratorRuntime.mark(function e(t,r,n){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(t);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:return(a=e.t0)[r]=n,e.abrupt("return",c({[t]:a}));case 8:case"end":return e.stop()}},e)}));return function(t,r,n){return e.apply(this,arguments)}}(),h=function(){var e=i(regeneratorRuntime.mark(function e(t,r,n){var a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(t);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:return a=e.t0,o=a[r]||0,e.abrupt("return",o+n>=Date.now());case 8:case"end":return e.stop()}},e)}));return function(t,r,n){return e.apply(this,arguments)}}(),b=(e,t)=>f(a.c.DISPLAYED_CBO_PROMPTS,e,t),g=function(){var e=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(a.c.DISPLAYED_CBO_PROMPTS,t,a.a.DAY);case 2:return e.abrupt("return",!e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),v=(e,t)=>f(a.c.DISPLAYED_CART_PROMPTS,e,t),w=function(){var e=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(a.c.DISPLAYED_CART_PROMPTS,t,20*a.a.MINUTE);case 2:return e.abrupt("return",!e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),x=(e,t)=>f(a.c.DISPLAYED_RXSAVER_PROMPTS,e,t),y=function(){var e=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(a.c.DISPLAYED_RXSAVER_PROMPTS,t,20*a.a.MINUTE);case 2:return e.abrupt("return",!e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=i(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(a.c.CODES_LAST_CHECKED,t,r);case 2:return e.next=4,s(a.c.NUMBER_OF_TIMES_CHECKED_CODES);case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=0;case 7:return n=e.t0,e.next=10,c({[a.c.NUMBER_OF_TIMES_CHECKED_CODES]:n+1});case 10:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}(),E=function(){var e=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c({[a.c.LAST_CODE_TESTING_STATUS]:t});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),k=e=>h(a.c.CODES_LAST_CHECKED,e,5*a.a.MINUTE),S=function(){var e=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(a.c.LIVE_CBOS);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),R=function(){var e=i(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:return(n=e.sent)[t]=r,e.abrupt("return",c({[a.c.LIVE_CBOS]:n}));case 5:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}(),_=function(){var e=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(a.c.ACTIVATED_CBOS);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),j=function(){var e=i(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_();case 2:return(n=e.sent)[t]=r?Date.now():-1,e.abrupt("return",c({[a.c.ACTIVATED_CBOS]:n}));case 5:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}(),I=()=>c({[a.c.ACTIVATED_CBOS]:{}}),T=e=>h(a.c.STAND_DOWN_LIST,e,a.a.HOUR),C=e=>f(a.c.STAND_DOWN_LIST,e,Date.now()),P=()=>c({[a.c.HAS_SEEN_CBO_INFO_PROMPT]:!0}),A=function(){var e=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s([a.c.HAS_SEEN_CBO_INFO_PROMPT]);case 2:return e.abrupt("return",!e.sent);case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),D=()=>c({[a.c.COMPETITOR_CHECK]:Date.now()}),N=()=>s(a.c.COMPETITOR_CHECK),U=e=>c({[a.c.SHOULD_SHOW_REVIEW_US]:e}),L=()=>s(a.c.SHOULD_SHOW_REVIEW_US),V=()=>Promise.all([e.storage.local.remove("hasCompletedGenieSurvey"),e.storage.local.remove("browserBlackList"),e.storage.local.remove("hasShownFirstMessage"),e.storage.local.remove("hasSeenNewUiPrompt"),e.storage.local.remove("hasSeenFirstTimeCallout")])}).call(this,r(50))},18:function(e,t,r){"use strict";var n=r(38),a=r.n(n),o=r(21),i=r(7);let s=a.a.randomBase32(),c=null;const u={session:"",DEFAULT_SEQUENCE:0,sequences:{},getEventSequenceCount(e,t){void 0===u.sequences[e]&&(u.sequences[e]={});const r=u.sequences[e];return void 0===r[t]?r[t]=u.DEFAULT_SEQUENCE:r[t]+=1,r[t]},pruneViewInstanceUuids(e){delete u.sequences[e]},queuedEvents:[],isOnline:!1,saveQueuedEvents(){try{window.localStorage.setItem(o.c,JSON.stringify(this.queuedEvents))}catch(e){i.b.captureException(e,{extra:{source:{filePath:"overlord/overlord-state.js",method:"saveQueuedEvents"}}})}},markInitialized(){this.initialized=!0;try{window.localStorage.setItem(o.b,Date.now())}catch(e){i.b.captureException(e,{extra:{source:{filePath:"overlord/overlord-state.js",method:"markInitialized"}}})}}};try{const e=window.localStorage.getItem(o.c);e&&(u.queuedEvents=JSON.parse(e))}catch(e){i.b.captureException(e,{extra:{source:{filePath:"overlord/overlord-state.js",method:"window.localStorage.getItem"},stateObj:u}})}Object.defineProperty(u,"currentViewInstanceUuid",{get:()=>s,set(e){e!==s&&(c=s,s=e)}}),Object.defineProperty(u,"previousViewInstanceUuid",{get:()=>c}),t.a=u},189:function(e,t,r){"use strict";r(10);var n=r(0),a=r(14);t.a={set:function(e){const t=n.browserUtils.domainFromHostname(e);Object(n.log)("adding stand-down entry: %s",t),Object(a.o)(n.browserUtils.domainFromHostname(t)),chrome.tabs.query({url:[`*://${t}/*`,`*://*.${t}/*`]},e=>{e.forEach(e=>{chrome.tabs.sendMessage(e.id,{instruction:"standDown"})})})}}},2:function(e,t,r){"use strict";r(43),r(62);var n=Object.freeze({LOGIN:"LOGIN",SIGN_UP:"SIGN_UP",VERIFY:"VERIFY"}),a=r(21);var o=Object.freeze({SECOND:1e3,MINUTE:6e4,HOUR:36e5,DAY:864e5});r.d(t,"b",function(){return n}),r.d(t,"c",function(){return a.d}),r.d(t,"a",function(){return o})},21:function(e,t,r){"use strict";r.d(t,"a",function(){return a}),r.d(t,"c",function(){return o}),r.d(t,"b",function(){return i});const n={OVERRIDES:{OUTCLICK_HOST:"OutclickHostOverride",REBATE_ACTIVATION_ENDPOINT:"RebateActivationEndpointOverride",DATA_STORE_INDEX:"DataStoreIndexOverride",DATA_STORE_API_KEY:"DataStoreApiKeyOverride"},INSTALLATION_UUID:"installationUuid",HAS_SEEN_GENIE_SURVEY:"hasSeenGenieSurvey",HAS_SEEN_CBO_INFO_PROMPT:"hasSeenFirstCBOCallout",NUMBER_OF_TIMES_CHECKED_CODES:"numberOfTimesCheckedCodes",LAST_CODE_TESTING_STATUS:"lastCodeTestingStatus",CODES_LAST_CHECKED:"codesLastChecked",LIVE_CBOS:"liveCBOs",ACTIVATED_CBOS:"activatedCBOs",DISPLAYED_CBO_PROMPTS:"displayedCBOPrompts",DISPLAYED_CART_PROMPTS:"displayedCTPrompts",DISPLAYED_RXSAVER_PROMPTS:"displayedRxSaverPrompts",DISPLAYED_AMAZON_CBO_PROMPTS:"displayedAmazonCboPrompts",STAND_DOWN_LIST:"genieStandDownList",COMPETITOR_CHECK:"competitorCheck",PREVIOUS_EXTENSION_VERSION:"previousExtensionVersion",QUEUED_OVERLORD_EVENTS:"_GenieQueuedOverlordEvents",OVERLORD_COOKIE_FLAG:"_GenieCookieHydration",AB_TESTING:"abTesting",SHOULD_SHOW_REVIEW_US:"shouldShowReviewUs"};t.d=n;const a=n.INSTALLATION_UUID,o=n.QUEUED_OVERLORD_EVENTS,i=n.OVERLORD_COOKIE_FLAG},24:function(e,t,r){"use strict";r.r(t),r.d(t,"getCookie",function(){return m}),r.d(t,"setCookie",function(){return p}),r.d(t,"wait",function(){return f}),r.d(t,"parseQueryString",function(){return h}),r.d(t,"domainFromHostname",function(){return b}),r.d(t,"isFirefox",function(){return g}),r.d(t,"isChrome",function(){return v}),r.d(t,"checkExtensionExistence",function(){return w}),r.d(t,"lookForInstalledAdBlockers",function(){return x});r(52),r(17),r(12),r(40),r(112),r(72),r(44),r(19);var n=r(105),a=r.n(n),o=r(27),i=r.n(o),s=r(7),c=r(128);function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}const l=(navigator.userAgent||"").toLowerCase(),d=(navigator.vendor||"").toLowerCase(),m=e=>{const t=document.cookie.match(`(?:^|;)\\s*${e}=([^;]*)`);return t&&t[1]},p=(e,t,r,n,a)=>{let o="";if(r){const e=new Date;e.setTime(e.getTime()+60*r*1e3),o=`; expires=${e.toUTCString()}`}document.cookie=`${e}=${t}${o}; domain=${n||window.location.hostname.replace(/[^.]+/,"")}; path=${a||"/"}`},f=(e,t=4e3,r=300,n=!1)=>new i.a((a,o)=>{let i=0;const s=setInterval(()=>{(i+=r)>t&&(clearInterval(s),n||o(new Error("Timeout is occured")),a(!1)),e()&&(clearInterval(s),a(!0))},r)}),h=(e="")=>{const t=e.split("?")[1],r={};if(t){t.split("&").reduce((e,t)=>{const n=u(t.split("="),2),a=n[0],o=n[1];try{r[a]=decodeURIComponent(o)}catch(e){r[a]=o}return e},r)}return r},b=e=>{let t=e;const r=e.split("."),n=r.length;return n>2&&(t=`${r[n-2]}.${r[n-1]}`),t},g=a()(()=>{return null!==l.match(/(?:firefox)\/(\d+)/)}),v=a()(()=>{return null!==(/google inc/.test(d)?l.match(/(?:chrome)\/(\d+)/):null)}),w=(e,t)=>{const r=v()?"chrome-extension":"moz-extension";return fetch(`${r}://${e}/${t}`).then(e=>i.a.resolve(e.ok)).catch(e=>"TypeError"===e.name&&"Failed to fetch"===e.message?i.a.resolve(!1):i.a.reject(e))},x=()=>{const e=[];return v()?i.a.each(c,t=>w(t.extensionId,t.webAccessibleResourcePath).then(r=>(r&&e.push(t.name),i.a.resolve())).catch(()=>(s.b.captureException(new Error("Check for adBlocker existence failed"),{extra:{source:"_checkInstalledAdBlockers",adBlocker:t.name}}),i.a.resolve([])))).then(()=>e):e}},268:function(e,t,r){"use strict";(function(e){r.d(t,"b",function(){return u}),r.d(t,"a",function(){return l});r(12),r(20);function n(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function a(e){return function(){var t=this,r=arguments;return new Promise(function(a,o){var i=e.apply(t,r);function s(e){n(i,a,o,s,c,"next",e)}function c(e){n(i,a,o,s,c,"throw",e)}s(void 0)})}}let o=null,i=null;const s=function(){var t=a(regeneratorRuntime.mark(function t(r,n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o!==r||"complete"!==n.status){t.next=3;break}return t.next=3,e.tabs.remove(r);case 3:case"end":return t.stop()}},t)}));return function(e,r){return t.apply(this,arguments)}}(),c=function(){var t=a(regeneratorRuntime.mark(function t(r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o!==r){t.next=4;break}return o=null,t.next=4,e.tabs.sendMessage(i,{tabId:r,tabClosed:!0});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),u=()=>{e.tabs.onUpdated.addListener(s),e.tabs.onRemoved.addListener(c)},l=function(){var t=a(regeneratorRuntime.mark(function t({url:r,openerTabId:n,windowId:a}){var s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=n,t.next=3,e.tabs.create({url:r,windowId:a,active:!1});case 3:return s=t.sent,o=s.id,t.abrupt("return",o);case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}).call(this,r(50))},269:function(e,t,r){"use strict";r(17),r(12),r(40),r(19),r(84);var n=r(4);t.a=function(e,t){const r=new URLSearchParams({v:1,tid:n.a.gaId,cid:e,aip:1,ds:"genie",t:t.type,ea:t.action,ec:t.category,el:t.label,dh:`${chrome.runtime.id}.com`,dp:"_generated_background_page.html"}).toString();return fetch("https://www.google-analytics.com/collect",{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r})}},270:function(e,t,r){"use strict";r(12),r(20);var n=r(34),a=r.n(n),o=r(38),i=r.n(o),s=r(370),c=r.n(s),u=r(4),l=r(7),d=r(18);r(52),r(17),r(40),r(19),r(112);function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var p={getBrowserInfo:function(){const e=window.navigator.appName,t=window.navigator.userAgent;let r=this._matchKnownBrowser(t);if(r){const e=t.match(/version\/([.\d]+)/i);if(e){var n=m(e,2);r[2]=n[1]}}return r=r?[r[1],r[2]]:[e,window.navigator.appVersion,"-?"],this._msieBrowserSafetyCheck(r),this._operaBrowserSafetyCheck(r),this._badBrowserSafetyCheck(r)},_matchKnownBrowser:function(e){let t;return t=/OPR/.test(e)?e.match(/(opr|opr)\/(\.?\d+(\.\d+)*)/i):e.match(/(opera|chrome|safari|firefox|msie|trident)\/?\s*(\.?\d+(\.\d+)*)/i)},_msieBrowserSafetyCheck:function(e){"Microsoft Internet Explorer"===window.navigator.appName&&"MSIE"!==e[0]&&(e[0]="MSIE",e[1]=null)},_operaBrowserSafetyCheck:function(e){"OPR"===e[0]?e[0]="Opera":"Opera"===window.navigator.appName&&"Opera"!==e[0]&&(e[0]="Opera",e[1]=null)},_badBrowserSafetyCheck:function(e){return e[0].match(/(opera|chrome|safari|firefox|msie|trident)/i)?e:[null,null]}};function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var h=function(e){return{build(t){t.session=e,t.propertyName="genie";var r=f(p.getBrowserInfo(),2);return t.browserFamily=r[0],t.browserVersion=r[1],t.screenHeight=window.screen.height,t.screenWidth=window.screen.width,t.loggedInFlag=!1,t.userUuid=null,t.custom={},t.custom.installationUuid="",t}}},b=r(71),g=r(82),v=r(64),w=r(0),x=r(21);function y(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function O(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function i(e){y(o,n,a,i,s,"next",e)}function s(e){y(o,n,a,i,s,"throw",e)}i(void 0)})}}const E=i.a.randomBase32(),k={_SDK:void 0,depthExceededNotificationSent:!1,init:function(e){const t=h(e);let r=`https://a.${u.a.site.baseDomain}`;return r=window.localStorage.getItem("overlordHost")||r,k._SDK=c()({host:r,doViewPageEvent:!1,eventPlatform:"www",contextBuilder:t.build.bind(t)}),this},flushEventQueue:()=>O(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!d.a.initializing){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,k._ensureCookieSpace();case 4:return e.next=6,k._flushEventQueueHelper();case 6:case"end":return e.stop()}},e)}))(),_ensureCookieSpace:()=>O(regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!d.a.initialized){e.next=2;break}return e.abrupt("return",d.a);case 2:if(!window.localStorage||!window.localStorage.getItem(x.b)){e.next=5;break}return d.a.initialized=!0,e.abrupt("return",d.a);case 5:return d.a.initializing=!0,t=Date.now(),e.prev=7,r=`?version=${u.a.extensionVersion}&uuid=${E}`,e.next=11,fetch(`https://www.${u.a.site.baseDomain}/genie/-/cookies${r}`,{credentials:"include"});case 11:return e.next=13,d.a.markInitialized();case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(7),n=(Date.now()-t)/1e3,parseInt(n,10)<=120&&l.b.captureMessage("failed to hydrate cookies for overlord",{level:"info",extra:{message:e.t0.message,sendingDuration:n,cookiesStatus:window.navigator.cookieEnabled?"on":"off"}});case 19:return e.prev=19,d.a.initializing=!1,e.finish(19);case 22:return e.abrupt("return",d.a);case 23:case"end":return e.stop()}},e,null,[[7,15,19,22]])}))(),_flushEventQueueHelper:()=>O(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(d.a.queuedEvents.length>0)){e.next=14;break}return t=d.a.queuedEvents.shift(),e.prev=2,e.next=5,k._invokeEventFire(t);case 5:e.next=12;break;case 7:return e.prev=7,e.t0=e.catch(2),l.b.captureException(e.t0,{extra:{source:{filePath:"overlord/client.js",method:"verlordClient._invokeEventFire"}}}),d.a.queuedEvents.unshift(t),e.abrupt("break",14);case 12:e.next=0;break;case 14:case"end":return e.stop()}},e,null,[[2,7]])}))(),fireEvent:(e,t)=>O(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t.eventType=e,t.event=t.event||{},t.context.viewInstanceUuid&&(d.a.currentViewInstanceUuid=t.context.viewInstanceUuid),t.context.previousViewInstanceUuid=d.a.previousViewInstanceUuid,!d.a.isOnline||!d.a.initialized){r.next=8;break}k._invokeEventFire(t),r.next=14;break;case 8:if(d.a.queuedEvents.push(t),!(d.a.queuedEvents.length>50)){r.next=14;break}if(d.a.queuedEvents.shift(),k.depthExceededNotificationSent){r.next=14;break}throw k.depthExceededNotificationSent=!0,new Error("analytics queue depth beyond 50");case 14:case"end":return r.stop()}},r)}))(),_invokeEventFire:e=>O(regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k._hydrateEventInfoWithOverrides(e);case 2:r=t.sent,(0,k[`fire${r.eventType}`])(r.context,r.event);case 5:case"end":return t.stop()}},t)}))(),_hydrateEventInfoWithOverrides:e=>O(regeneratorRuntime.mark(function t(){var r,n,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(b.a)();case 2:if(r=t.sent,n=e.event,(a=e.context).custom={installationUuid:r},a.loggedInFlag=Object(v.a)().isLoggedIn,a.experiment){t.next=16;break}return t.prev=7,t.next=10,g.a.getVariations(r);case 10:a.experiment=t.sent,t.next=16;break;case 13:t.prev=13,t.t0=t.catch(7),l.b.captureException(t.t0,{extra:{content:e.content,source:{source:{filePath:"overlord/client.js",method:"abTesting.getVariations"}}}});case 16:return a.experiment&&a.experiment.length<1&&delete a.experiment,n.eventSequence=d.a.getEventSequenceCount(a.viewInstanceUuid),n.eventTimestamp=(new Date).toISOString(),n.eventPlatformVersion=u.a.extensionVersion,t.abrupt("return",e);case 21:case"end":return t.stop()}},t,null,[[7,13]])}))(),fireClickPage(e,t){k._SDK.fire.ClickPage(r=>{a()(r.context,e),a()(r.event,t)})},fireRenderedImpression(e,t){k._SDK.fire.RenderedImpression(r=>{a()(r.context,e),a()(r.event,t)})},fireViewPrompt(e,t){Object(w.log)("firing view prompt"),k._SDK.fire.ViewPrompt(r=>{a()(r.context,e),a()(r.event,t)})},fireClickPrompt(e,t){k._SDK.fire.ClickPrompt(r=>{a()(r.context,e),a()(r.event,t)})},fireSearch(e,t){k._SDK.fire.Search(r=>{a()(r.context,e),a()(r.event,t)})},fireTestCodes(e,t){k._SDK.fireEvent("analytics.common.engage.TestCodes",r=>{a()(r.context,e),a()(r.event,t)})},fireInstall(e,t){k._SDK.fireEvent("analytics.common.engage.ManageExtension",r=>{a()(r.context,e),a()(r.event,t)})}};var S=k;t.a={client:S,state:d.a}},31:function(e,t,r){"use strict";var n=r(39);t.a=Object.freeze({OFFER_NOT_ACTIVATED:"not activated",OFFER_ACTIVATED:n.a.ACTIVATED,OFFER_ERROR:n.a.EXPIRED,OFFER_LOADING:n.a.LOADING,OFFER_STOOD_DOWN:n.a.DEACTIVATED})},367:function(e,t,r){"use strict";r(10);var n=r(7),a=r(4),o=r(14),i=r(0),s=r(18);const c=i.browserUtils.checkExtensionExistence,u={start(e){Object(o.b)().then(t=>{Date.now()-(t||0)>6048e5&&(this._getCompetitors().forEach(t=>{this._checkExistence(t).then(r=>{e.fireEvent("ViewPrompt",{context:{pageName:"undetermined",promptName:r?"competitor extension installed":"competitor extension not installed",viewInstanceUuid:s.a.currentViewInstanceUuid},event:{eventAction:"view",eventName:"prompt",eventTarget:t.name}})}).catch(e=>{Object(i.log)(`Check for ${t.name} existence failed-${e.name}: ${e.message}`),n.b.captureException(e,{extra:{source:{filePath:"bg/competitor-monitor.js",method:"competitorMonitor.start"},competitor:t.name}})})}),Object(o.m)())})},_getCompetitors:()=>a.a.competitors,_checkExistence:e=>c(e.extensionId,e.webAccessibleResourcePath)};t.a=u},369:function(e,t,r){"use strict";(function(e){r(13),r(47),r(130),r(17),r(113),r(66),r(72),r(44),r(19),r(84);var n=r(107),a=r(189),o=r(0);const i={redirectTrace:[],_baseWhitelist:new Set(["o.retailmenot.com","www.retailmenot.com","www.rmnstage.com","www.rmntest.com","m.retailmenot.com","o.rmn.com","o.rmnstage.com","o.rmntest.com"]),_CJandLinkshareDomains:new Set(["www.anrdoezrs.net","www.commission-junction.com","www.dpbolvw.net","www.apmebf.com","www.jdoqocy.com","www.kqzyfj.com","www.qksrv.net","www.tkqlhce.com","www.qksz.net","www.emjcd.com","www.afcyhf.com","www.awltovhc.com","www.ftjcfx.com","www.lduhtrp.net","www.tqlkg.com","www.awxibrm.com","www.cualbr.com","www.rnsfpw.net","www.vofzpwh.com","www.yceml.net","cj.dotomi.com","cj.mplxtms.com","affiliate.rakuten.com","click.linksynergy.com"]),_affiliateDomains:new Set(["www.awin1.com","scripts.affiliatefuture.com","www.avantlink.com","www.avantlink.ca","www.clixGalore.com","www.sevenly.org","www.linkconnector.com","send.onenetworkdirect.net","www.paidonresults.net","www.pntra.com","www.pntrac.com","www.pjatr.com","www.gopjn.com","www.pjtra.com","www.pntrs.com","prf.hn","shareasale.com","www.shareasale.com","track.webgains.com","partners.hostgator.com","partners.hotwire.com","affiliates.abebooks.com","linkto.hrblock.com","goto.carters.com","vip.silpada.com","go.gemvara.com","go.jewelry.com","partners.wantable.co","hpn.houzz.com","goto.shopspring.com","tracking.hddn.com","goto.target.com"]),_impactradiusDomains:new Set(["evyy","pxf","sjv","7eer","ojrq","uikc","uqhv"]),_redirectStatuses:[301,302,307],_redirectListener(e){const t=o.webRequest.standardizedOnBeforeRequest(e);this._redirectStatuses.includes(t.statusCode)&&(this.redirectTrace.length>=15&&this.redirectTrace.shift(),t.hostname=this._parseHostname(t.url),this.redirectTrace.push(t))},_isCJorLinkshareAffiliate(e){const t=e.url||e.target.url||"";return this._CJandLinkshareDomains.has(e.hostname)||e.hostname.includes("linksynergy")||t.includes("afsrc=1")},_isOtherAffiliate(e){if(this._affiliateDomains.has(e.hostname))return!0;const t=e.hostname.split("."),r=t[t.length-2]||"";return!!this._impactradiusDomains.has(r)},_isPaypalExpressCheckoutCallback(e){try{const t=new URL(e.url).searchParams.get("token");return t&&-1!==t.indexOf("EC-")}catch(e){return!1}},_shouldIgnorePriorRedirects(e){return this._isPaypalExpressCheckoutCallback(e)},_shouldIncludeRedirect(e,t){let r=!1;if(t.requestId===e.requestId||e.initiator&&e.initiator===t.initiator){const n=o.browserUtils.domainFromHostname(t.hostname)!==o.browserUtils.domainFromHostname(e.hostname),a=t.url&&t.url.includes("afsrc=1");r=n||a}else this._previousCompletion&&this._previousCompletion.hostname&&o.browserUtils.domainFromHostname(this._previousCompletion.hostname)!==o.browserUtils.domainFromHostname(e.hostname)&&(r=this._previousCompletion&&this._previousCompletion.initiator&&o.browserUtils.domainFromHostname(t.hostname)===o.browserUtils.domainFromHostname(this._previousCompletion.initiator));return r},_completionListener(t){const r=o.webRequest.standardizedOnCompleted(t);if(this._shouldIgnorePriorRedirects(r))return;r.hostname=this._parseHostname(r.url),window.completionDetails=t;const i=this.redirectTrace.filter(e=>this._shouldIncludeRedirect(r,e));if(200===r.statusCode&&(this._previousCompletion=r),0===i.length)return;const s=i.reduce((t,r)=>{const n=r.initiator&&r.initiator.replace("https://","").split("/")[0];return this._baseWhitelist.has(r.hostname)||this._baseWhitelist.has(n)?t.rmnRedirects+=1:this._isCJorLinkshareAffiliate(r)||r.initiator&&this._previousCompletion&&this._isCJorLinkshareAffiliate(this._previousCompletion)&&this._previousCompletion.hostname&&e.domainFromHostname(r.initiator)===e.domainFromHostname(this._previousCompletion.hostname)?t.CJorLinkshareAffiliateRedirects+=1:(this._isOtherAffiliate(r)||r.initiator&&this._previousCompletion&&this._isOtherAffiliate(this._previousCompletion)&&this._previousCompletion.hostname&&e.domainFromHostname(r.initiator)===e.domainFromHostname(this._previousCompletion.hostname))&&(t.otherAffiliateRedirects+=1),t},{rmnRedirects:0,CJorLinkshareAffiliateRedirects:0,otherAffiliateRedirects:0});Object(o.log)(`completion listener for: ${r.hostname}`),Object(o.log)(s),s.rmnRedirects>0||(s.otherAffiliateRedirects+s.CJorLinkshareAffiliateRedirects>0&&n.a.handlePotentialDeactivationNotice(r.hostname),s.CJorLinkshareAffiliateRedirects>0&&a.a.set(r.hostname))},setUpListeners(){window.redirectTrace=this.redirectTrace,chrome.webRequest.onBeforeRedirect.addListener(this._redirectListener.bind(this),{urls:["<all_urls>"],types:["main_frame"]}),chrome.webRequest.onCompleted.addListener(this._completionListener.bind(this),{urls:["<all_urls>"],types:["main_frame"]})},_parseHostname(e){const t=document.createElement("a");return t.href=e,t.hostname}};window.requestMonitor=i,t.a=i}).call(this,r(50))},371:function(e,t,r){"use strict";(function(e){r(52),r(13),r(47),r(17),r(29),r(12),r(40),r(66),r(44),r(10),r(19),r(20);var n=r(4),a=r(0),o=r(7),i=r(18);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function c(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function u(){var t;return t=regeneratorRuntime.mark(function t(r){var c,u,d,m,p,f,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Object(a.log)("installing extension"),t.prev=1,t.next=4,e.tabs.query({url:[`https://www.${n.a.site.baseDomain}/genie/*`,"https://chrome.google.com/webstore/detail/retailmenot-genie/*","https://chrome.google.com/webstore/detail/retailmenot-genie-instant/*",`https://chrome.google.com/webstore/detail/${chrome.runtime.id}/*`,"https://chrome.google.com/webstore/search/genie","https://chrome.google.com/webstore/search/retailmenot","https://chrome.google.com/webstore/search/retail%20me%20not","https://addons.mozilla.org/en-US/firefox/addon/retailmenot_genie/*"]});case 4:c=t.sent,t.next=11;break;case 7:t.prev=7,t.t0=t.catch(1),o.b.captureException(t.t0,{extra:{findInstallationTab:!0,source:{filePath:"bg/install-and-update.js",method:"_handleInstallation"}}}),c=[];case 11:if(0!==c.length){t.next=13;break}return t.abrupt("return");case 13:c.filter(e=>e.url.includes(n.a.site.baseDomain)&&e.url.includes("utm_campaign=mmm_6182018")).forEach(e=>{chrome.tabs.executeScript(e.id,{code:"\n\t\t\t\tconst scriptElement = document.createElement('script');\n\t\t\t\tscriptElement.text = 'window.MMM.showPopUp();';\n\t\t\t\tdocument.body.appendChild(scriptElement);\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tdocument.body.removeChild(scriptElement);\n\t\t\t\t}, 200);\n\t\t\t\t"})}),u=c.map(e=>e.url),d={medium:null,source:null,campaign:null},m=!1,p="/genie",f="",u.forEach(e=>{if(!m){const t=a.browserUtils.parseQueryString(e);Object.keys(t).length>0&&Object.keys(d).forEach(r=>{const n=t[`utm_${r}`];if(n){m=!0,d[r]=n;var a=s(e.split("?"),2);p=a[0],f=a[1]}})}}),l(f),h={viewInstanceUuid:i.a.currentViewInstanceUuid,previousViewInstanceUuid:null,pageName:p,marketing:d},r.fireEvent("Install",{context:h,event:{eventAction:"manage extension",eventName:"genie",eventTarget:"install"}});case 24:case"end":return t.stop()}},t,null,[[1,7]])}),(u=function(){var e=this,r=arguments;return new Promise(function(n,a){var o=t.apply(e,r);function i(e){c(o,n,a,i,s,"next",e)}function s(e){c(o,n,a,i,s,"throw",e)}i(void 0)})}).apply(this,arguments)}function l(e){chrome.tabs.create({url:`https://www.${n.a.site.baseDomain}/genie/welcome?${e}`})}t.a=function(e){chrome.runtime.onInstalled&&chrome.runtime.onInstalled.addListener(t=>{"install"===t.reason?function(e){u.apply(this,arguments)}(e):"update"===t.reason&&function(e){const t=chrome.runtime.getManifest().version;Object(a.log)("updating extension to %s",t),e.fireEvent("Install",{context:{viewInstanceUuid:i.a.currentViewInstanceUuid,previousViewInstanceUuid:i.a.previousViewInstanceUuid,pageName:"/genie"},event:{eventAction:"manage extension",eventName:"genie",eventTarget:"update"}})}(e)})}}).call(this,r(50))},372:function(e,t,r){"use strict";(function(e){r(12),r(20);var n=r(18),a=r(7),o=r(62);function i(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}const s=/Failed to fetch/,c=/NetworkError when attempting to fetch resource/,u={watchingOnline:!1,retryCount:0,retryInterval:500,retryErrorSent:!1,_onlineMonitor(){return(t=regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.a.isOnline||u.watchingOnline){t.next=2;break}return t.abrupt("return");case 2:if(u.retryCount+=1,u.retryInterval=500*Math.min(u.retryCount,40),navigator.onLine){t.next=7;break}return setTimeout(u._onlineMonitor,u.retryInterval),t.abrupt("return");case 7:return t.prev=7,t.next=10,e.cookies.getAllCookieStores();case 10:t.sent.length>0?fetch("https://d1deqen6vzxvqh.cloudfront.net/assets/images/__test.gif",{mode:"no-cors"}).then(()=>{document.dispatchEvent(new CustomEvent(o.a.NETWORK.ONLINE)),n.a.isOnline=!0,u.watchingOnline=!1,u.retryCount=0,u.retryErrorSent=!1}).catch(e=>{setTimeout(u._onlineMonitor,u.retryInterval),s.test(e.message)||c.test(e.message)||a.b.captureException(e,{extra:{source:{filePath:"bg/readiness-monitor.js",method:"readiness._onlineMonitor"}}}),!u.retryErrorSent&&u.retryCount>40&&(a.b.captureException(new Error("readiness check retries exceeded 40")),u.retryErrorSent=!0)}):setTimeout(u._onlineMonitor,u.retryInterval),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(7),setTimeout(u._onlineMonitor,u.retryInterval);case 17:case"end":return t.stop()}},t,null,[[7,14]])}),function(){var e=this,r=arguments;return new Promise(function(n,a){var o=t.apply(e,r);function s(e){i(o,n,a,s,c,"next",e)}function c(e){i(o,n,a,s,c,"throw",e)}s(void 0)})})();var t},_offlineMonitor(){document.dispatchEvent(new CustomEvent(o.a.NETWORK.OFFLINE)),n.a.isOnline=!1,u.watchingOnline||(u.watchingOnline=!0,u.retryCount=0,u._onlineMonitor())},_suspendMonitor(){n.a.saveQueuedEvents()},init(){u.watchingOnline=!0,u._onlineMonitor(),window.onoffline=u._offlineMonitor}};t.a=u}).call(this,r(50))},39:function(e,t,r){"use strict";t.a=Object.freeze({CAN_ACTIVATE:"activate cashback",ACTIVATED:"cashback activated",DEACTIVATED:"cashback deactivated",UNRECOGNIZED_ERROR:"unrecognized error",EXPIRED:"cashback expired",NOT_LOGGED_IN:"cashback login",NOT_VERIFIED:"cashback verify",LOADING:"loading"})},4:function(e,t,r){"use strict";var n=r(127);const a="Could not establish connection. Receiving end does not exist.",o={production:{raven:{baseUrl:"https://c87af1ebb28142218380117d9d55713f@sentry.io/159881",topDriverUrl:"https://483d3d9a1f9543e7b859343ea1029ee8@sentry.io/1317932",driverUrl:"https://c5be67ccfa924b1088d5aeec72adebfe@sentry.io/1307570",validationIntegrationUrl:"https://87bd6814cd024474aab09964f174434d@sentry.io/2236102",config:{sampleRate:1,debug:!1,environment:"production",ignoreErrors:["Attempting to use a disconnected port object",a]}},site:{baseDomain:"retailmenot.com"},api:{readKey:"8f3ad263ad39d0424faceec47098980e",merchantIndex:"genie-merchants-prod",browserBlackListIndex:"genie-browsers-blacklist-prod"},validationIntegrationAPI:"https://genie-proxy-api.rmneng.com/coupons",gaId:"UA-97092992-2",abTesting:{projectId:"10652141136",cdnUrl:"https://cdn.optimizely.com/json/10652141136.json",activeCampaigns:["a_a"]}},stage:{raven:{baseUrl:"https://54ef679de790433f9658270c410196e9@sentry.io/169781",topDriverUrl:"https://d84faad734164d3e930ebb42b6348b3a@sentry.io/1317927",driverUrl:"https://b5a6023e92ff44d8a2d53b0ca1083fe2@sentry.io/1307569",validationIntegrationUrl:"https://87bd6814cd024474aab09964f174434d@sentry.io/2236102",config:{sampleRate:1,debug:!0,environment:"stage",ignoreErrors:["Attempting to use a disconnected port object",a]}},site:{baseDomain:"rmnstage.com"},api:{readKey:"a4d1fe62afa01ea66fa7980f96dd94bc",merchantIndex:"genie-merchants-aladdin",browserBlackListIndex:"genie-browsers-blacklist-dev"},validationIntegrationAPI:"https://genie-proxy-api.rmneng-stage.com/coupons",gaId:"UA-97092992-3",abTesting:{projectId:"10644961487",cdnUrl:"https://cdn.optimizely.com/json/10644961487.json",activeCampaigns:["a_a"]}},local:{raven:{baseUrl:"https://ce0e73d1fcd74a8a8804205aae7ce774@sentry.io/169782",topDriverUrl:"https://6337fadd96854a918c58e5f2b42fcdd3@sentry.io/1317926",driverUrl:"https://2f0466180d4c4ca2895a6d355ed36cf0@sentry.io/1275289",validationIntegrationUrl:"https://87bd6814cd024474aab09964f174434d@sentry.io/2236102",config:{sampleRate:0,debug:!0,environment:"local",ignoreErrors:["Attempting to use a disconnected port object",a]}},site:{baseDomain:"rmntest.com"},api:{readKey:"a13e067f3c8215269f61ea38a8abb918",merchantIndex:"genie-merchants-testing",browserBlackListIndex:"genie-browsers-blacklist-dev"},gaId:"UA-97092992-3",validationIntegrationAPI:"https://genie-proxy-api.rmneng-test.com/coupons",abTesting:{projectId:"10644961487",cdnUrl:"https://cdn.optimizely.com/json/10644961487.json",activeCampaigns:["a_a"]}},allEnvironments:{competitors:n}},i=Object.assign(o.stage,o.allEnvironments);Object.defineProperty(i,"extensionVersion",{get:()=>chrome.runtime.getManifest().version}),t.a=i},41:function(e,t,r){"use strict";r.d(t,"c",function(){return a}),r.d(t,"e",function(){return o}),r.d(t,"b",function(){return i}),r.d(t,"f",function(){return s}),r.d(t,"d",function(){return c});r(72),r(85);const n={moneyFormat(e){if(Number.isNaN(Number(e)))return"$--";return e.toLocaleString("en",{style:"currency",currency:"USD",minimumFractionDigits:2})},toFloat(e){if("number"==typeof e)return e;return parseFloat(e.trim().replace(/[-$,:;'"=\sA-z]|[#&]\d*/g,""))},elemToFloat:e=>n.toFloat(e.textContent),toInt(e){const t=e.trim().replace(/[-$,]/g,"");return parseInt(t,10)},pluralize(e,t){if(1===e)return t;return t+(/([zxs]|ch|sh)$/.test(t)?"es":"s")},getRandomInt:(e,t)=>Math.floor(Math.random()*(t-e))+e,roundToDecimal:(e,t=2)=>"number"!=typeof e?e:parseFloat(e.toFixed(t))};t.a=n;const a=n.moneyFormat,o=n.toFloat,i=n.elemToFloat,s=n.toInt,c=n.pluralize;n.getRandomInt,n.roundToDecimal},43:function(e,t,r){"use strict";r.d(t,"a",function(){return a});const n={ALGOLIA:{UNPARSABLE_JSON:"AlgoliaSearchUnparsableJSONError",NETWORK_ERROR:"AlgoliaSearchNetworkError",TIMEOUT_ERROR:"AlgoliaSearchRequestTimeoutError",JSONP_ERROR:"AlgoliaSearchJSONPScriptErrorError"}};t.b=n;const a=n.ALGOLIA},435:function(e,t,r){"use strict";r.r(t),function(e){r(17),r(122),r(12),r(112),r(19),r(20);var t=r(38),n=r.n(t),a=r(7),o=r(107),i=r(367),s=r(4),c=r(110),u=r(64),l=r(369),d=r(14),m=r(129),p=r(268),f=r(108),h=r(0),b=r(109),g=r(270),v=r(71),w=r(189),x=r(82),y=r(43),O=r(62),E=r(371),k=r(372),S=r(269),R=r(93);function _(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function j(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function i(e){_(o,n,a,i,s,"next",e)}function s(e){_(o,n,a,i,s,"throw",e)}i(void 0)})}}const I=new Map;window.addEventListener("error",e=>{a.b.captureException(new Error("Error from unhandled errors listener"),{extra:{error:e.error,source:{filePath:"bg/background.js",method:"unhandled errors listener"}}})}),window.addEventListener("unhandledrejection",t=>{const r=e.runtime.getURL("").match(/\/\/([\w-]+)\//)[1],n=t.reason;if(t.currentTarget&&t.currentTarget.origin.match(r)||n.stack&&n.stack.match(r)||n.fileName&&n.fileName.match(r)){const e=n.message.match(/(?:failed to fetch)|(?:networkError when attempting to fetch resource)/i)?"Failed to fetch error from unhandledrejection listener":"Error from unhandledrejection listener";a.b.captureException(new Error(e),{extra:{error:n,source:{filePath:"bg/background.js",method:"unhandledrejection listener"}}})}});const T=g.a.client.init(n.a.randomBase32());function C(){return(C=j(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.a)();case 2:t=e.sent,Object(S.a)(t,{type:"pageview"}).catch(e=>e);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}Object(E.a)(T),function(){C.apply(this,arguments)}(),chrome.runtime.onUpdateAvailable&&chrome.runtime.onUpdateAvailable.addListener(()=>{chrome.runtime.reload()}),"function"==typeof chrome.runtime.requestUpdateCheck&&setTimeout(()=>{chrome.runtime.requestUpdateCheck(()=>{})},18e6);let P=!1;function A(e,t,r,n){console.error(e),"Attempting to use a disconnected port object"!==e.message&&(e.name!==y.b.ALGOLIA.UNPARSABLE_JSON&&a.b.captureException(e,n),"function"==typeof t&&void 0!==r&&t(r))}document.addEventListener(O.a.NETWORK.ONLINE,j(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(P){e.next=9;break}return T.fireEvent("ViewPrompt",{context:{pageName:"undetermined",promptName:"extension background start"}}),Object(v.a)().then(e=>{Object(S.a)(e,{type:"event",category:"network",action:"online"})}),e.next=5,Object(u.c)();case 5:return e.next=7,Object(b.a)();case 7:e.sent&&chrome.cookies&&chrome.cookies.set({url:`https://${s.a.site.baseDomain}/`,domain:`.${s.a.site.baseDomain}`,name:"genieInstalled",value:"1"});case 9:return P=!0,e.prev=10,e.next=13,T.flushEventQueue();case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(10),a.b.captureException(e.t0,{extra:{source:{filePath:"bg/background.js",method:"coreAnalytics.flushEventQueue()"}}});case 18:case"end":return e.stop()}},e,null,[[10,15]])}))),k.a.init(),Object(b.c)(),Object(u.b)(),o.a.listenForActivations(),l.a.setUpListeners(),Object(m.c)(),Object(p.b)(),chrome.tabs.onRemoved.addListener(e=>{g.a.state.pruneViewInstanceUuids(e)}),h.browserUtils.isChrome()&&i.a.start(T),chrome.browserAction.setBadgeBackgroundColor({color:"#de1f72"}),chrome.browserAction.onClicked.addListener(()=>{chrome.tabs.query({active:!0,currentWindow:!0},e=>{chrome.tabs.sendMessage(e[0].id,{reveal:!0},()=>{})})}),chrome.extension.onMessage.addListener(e=>{const t=e.toggle;chrome.tabs.query({active:!0,currentWindow:!0},e=>{chrome.tabs.sendMessage(e[0].id,{reveal:t},()=>{})})}),chrome.runtime.onMessage.addListener((e,t,r)=>{let n=!1;switch(e.instruction){case"updateIcon":chrome.browserAction.setIcon({path:chrome.extension.getURL(`icons/${e.value}-icon-38.png`),tabId:t.tab&&t.tab.id},()=>{});break;case"updateBadge":chrome.browserAction.setBadgeText({text:e.value?`${e.value}`:"",tabId:t.tab&&t.tab.id});break;case"beacon":T.fireEvent(e.eventType,e.eventPayload).catch(A);break;case"error":const i=new Error(e.errorMessage);i.stack=e.errorStack;let s=a.a;e.domain||(s=a.b),e.validationSupport&&(s=a.d),Object(R.a)(e.domain)&&(s=a.c),s.captureException(i,{extra:{stack:e.errorStack,url:e.errorUrl,info:e.errorInfo}},e.logOnBackground);break;case"getDisplayInformation":n=!0,Object(c.c)(e.hostname).then(e=>Promise.all([Object(c.b)(e),Object(u.a)(),Object(d.A)(e),Object(d.y)(e),Object(d.w)(e),Object(d.h)(e),Object(d.B)(),Object(v.a)(),Object(d.x)(),Object(b.b)()]).then(([e,t,n,a,o,i,s,c,u,l])=>x.a.getVariations(c).then(d=>{r({merchant:e,userStatus:t,shouldStandDown:n,shouldShowCboPrompt:a,shouldShowCartPrompt:o,codesRecentlyChecked:i,shouldShowSurvey:s,installationUuid:c,shouldShowCboInfoPrompt:u,extensionVersion:chrome.runtime.getManifest().version,permissions:l,testVariations:d})}))).catch(e=>{A(e,r,{coupons:[],merchant:{},userStatus:{isLoggedIn:!1,isVerified:!1},shouldStandDown:!1,shouldShowCboPrompt:!1,shouldShowCartPrompt:!1,codesRecentlyChecked:!1,shouldShowCboInfoPrompt:!1,extensionVersion:chrome.runtime.getManifest().version,testVariations:[],blockedByNetwork:e.name===y.b.ALGOLIA.UNPARSABLE_JSON,permissions:{all:!0,rmn:!0}})});break;case"getMerchantSearchResults":n=!0,Object(c.e)(e.searchString).then(e=>{r(e)}).catch(e=>{A(e,r,[],{extra:{source:"getMerchantSearchResults"}})});break;case"getTopMerchantsList":n=!0,Object(c.d)(e.limit).then(e=>{r(e)}).catch(e=>{A(e,r,[],{extra:{source:"getTopMerchantsList"}})});break;case"getAdditionalSearchMerchantsList":n=!0,Object(c.a)(e.page).then(e=>{r(e)}).catch(e=>{A(e,r,[],{extra:{source:"getAdditionalSearchMerchantsList"}})});break;case"requestUserStatus":n=!0,Object(u.c)().then(e=>{r(e)});break;case"activateCbo":Object(h.log)("activating CBO: %o",e.cashbackOffer),n=!0,Object(v.a)().then(t=>{o.a.activate({cashbackOffer:e.cashbackOffer,testVariations:e.testVariations,installationUuid:t,pageName:e.pageName}).then(t=>{r(t),Object(m.b)({uuid:e.cashbackOffer.uuid,viewInstanceUuid:e.viewInstanceUuid,pageName:e.pageName,pageType:e.pageType,testVariations:e.testVariations})}).catch(e=>{A(e,r,{success:!1},{extra:{source:"activateCbo"}})})});break;case"checkCboStatus":n=!0,o.a.getActivatedCboUuids(e.domain).then(e=>{r(e)}).catch(e=>{A(e,r,{},{extra:{source:"checkCboStatus"}})});break;case"outclick":Object(m.b)(e);break;case"getOutclickURL":n=!0,Object(m.a)(e).then(e=>r(e)).catch(e=>A(e,r,null,{extra:{source:"getOutclickURL"}}));break;case"setStandDown":w.a.set(e.domain);break;case"markCodeCheckingComplete":Object(d.l)(e.domain,e.timestamp);break;case"setLastCodeTestingStatus":Object(d.t)(e.status);break;case"markCartPromptDisplayed":Object(d.i)(e.domain,e.timestamp);break;case"markRxSaverPromptDisplayed":Object(d.n)(e.domain,e.timestamp);break;case"markCboPromptDisplayed":Object(d.k)(e.domain,e.timestamp);break;case"shouldDisplayPrompt":n=!0;const l="cart"===e.promptType?d.w:d.y;Promise.all([l(e.domain),Object(d.A)(e.domain)]).then(([e,t])=>{r(e&&!t)}).catch(e=>{A(e,r,!1,{extra:{source:"shouldDisplayPrompt"}})});break;case"markCboInfoPromptSeen":Object(d.j)();break;case"markSurveySeen":Object(d.p)();break;case"openNewTab":n=!0,t.tab?Object(p.a)({url:e.url,openerTabId:t.tab.id,windowId:t.tab.windowId}).then(e=>{r(e)}).catch(e=>{A(e,r,!1,{extra:{source:"openNewTab"}})}):r(!1);break;case"getDriverStorage":n=!0,r(I.get(e.domain));break;case"setDriverStorage":I.set(e.domain,e.value);break;case"deleteDriverStorage":I.delete(e.domain);break;case"displayPopUp":Object(h.log)("displaying pop up"),Object(f.d)(e.type);break;case"focusPopUp":Object(h.log)("moving pop up to front"),Object(f.b)();break;case"setShowReviewUsSideCard":Object(d.v)(e.flag);break;case"closePopUp":Object(h.log)("closing pop up"),Object(f.a)();break;default:a.b.captureMessage(`Warn: invoked default background message handler for instruction: ${e.instruction}`)}return n||r({}),n}),Object(d.s)()}.call(this,r(50))},62:function(e,t,r){"use strict";t.a={NETWORK:{ONLINE:"NETWORK_ONLINE",OFFLINE:"NETWORK_OFFLINE"}}},64:function(e,t,r){"use strict";(function(e){r.d(t,"b",function(){return g}),r.d(t,"a",function(){return p}),r.d(t,"d",function(){return h}),r.d(t,"c",function(){return v});r(47),r(29),r(56),r(12),r(66),r(20);var n=r(0),a=r(4),o=r(14),i=r(21),s=r(7);function c(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function u(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function i(e){c(o,n,a,i,s,"next",e)}function s(e){c(o,n,a,i,s,"throw",e)}i(void 0)})}}const l=n.asyncUtils.asyncForEachExecutedInParallel,d=a.a.site.baseDomain,m={isLoggedIn:!1,isVerified:!1,uuid:null},p=()=>m,f=({isLoggedIn:e,isVerified:t,uuid:r=null})=>{m.isLoggedIn=e,m.isVerified=t,m.uuid=r},h=function(){var t=u(regeneratorRuntime.mark(function t(r,n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.tabs.sendMessage(r,{instruction:"userStatusChanged",userStatus:n}));case 1:case"end":return t.stop()}},t)}));return function(e,r){return t.apply(this,arguments)}}(),b=function(){var t=u(regeneratorRuntime.mark(function t(r){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.tabs.query({});case 2:return n=t.sent,t.next=5,l(n.map(e=>e.id),h,r);case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),g=()=>{chrome.cookies.onChanged.addListener(function(){var e=u(regeneratorRuntime.mark(function e(t){var r,a,s,c,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=t.cookie).domain===`.${d}`||r.domain===`.secure.${d}`){e.next=3;break}return e.abrupt("return");case 3:if(a="explicit"===t.cause||t.removed,"jwt"!==r.name||!a){e.next=16;break}if(s=p(),c=n.jwt.decode(r.value),t.removed){e.next=15;break}if((u={isLoggedIn:null!=c.preferred_username,isVerified:!0===c.auth,uuid:c.sub}).isLoggedIn===s.isLoggedIn&&u.isVerified===s.isVerified){e.next=13;break}return f(u),e.next=13,b(u);case 13:e.next=16;break;case 15:(s.isLoggedIn||s.isVerified)&&(f(u={isLoggedIn:!1,isVerified:!1,uuid:null}),setTimeout(()=>{const e=p();e.isLoggedIn&&e.uuid===c.sub||(Object(o.r)(),b(u))},100));case 16:"deviceFingerprint"!==r.name&&"userQualifier"!==r.name||!0!==t.removed||window.localStorage.removeItem(i.b);case 17:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},v=function(){var e=u(regeneratorRuntime.mark(function e(){var t,r,n,a,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,r=!1,e.prev=2,e.next=5,fetch(`https://secure.${d}/accounts/api/me/email`,{credentials:"include"});case 5:if(!(n=e.sent).ok){e.next=20;break}if(!n.headers.get("Content-Type").includes("text/html")){e.next=15;break}if(!(Math.random()>.5)){e.next=13;break}return e.next=11,n.text();case 11:a=e.sent.slice(0,999),s.b.captureMessage("Unexpected Content-Type received from Charon",{level:"info",extra:{responseText:a}});case 13:e.next=20;break;case 15:return e.next=17,n.json();case 17:o=e.sent,t=!0,r=o.data.verified&&!!o.data.email;case 20:e.next=27;break;case 22:e.prev=22,e.t0=e.catch(2),"Failed to fetch"!==e.t0.message&&s.b.captureException(e.t0,{extra:{loginMonitorAttempt:!0,source:{filePath:"bg/login.js",method:"login.requestUserStatus"}}}),t=!1,r=!1;case 27:return f(i={isLoggedIn:t,isVerified:r}),e.abrupt("return",i);case 30:case"end":return e.stop()}},e,null,[[2,22]])}));return function(){return e.apply(this,arguments)}}()}).call(this,r(50))},7:function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return s}),r.d(t,"c",function(){return c}),r.d(t,"d",function(){return u});r(10);var n=r(65),a=r.n(n),o=r(4);o.a.raven.config.release=o.a.extensionVersion;const i=new a.a.Client,s=new a.a.Client,c=new a.a.Client,u=new a.a.Client;function l(e){const t=e.captureException,r=e.captureMessage;e.captureException=function(e,r={},n=!0){return r.extra=r.extra||{},Object.getOwnPropertyNames(e).forEach(t=>{"name"!==t&&"message"!==t&&(r.extra[t]=e[t])}),r.fingerprint||(r.fingerprint=[e.message],r.extra.domain&&r.fingerprint.push(r.extra.domain)),n&&console.error(e),t.apply(this,[e,r])},e.captureMessage=function(e,t={},n=!0){return t.extra=t.extra||{},n&&console.warn(e),r.apply(this,[e,t])}}i.config(o.a.raven.baseUrl,o.a.raven.config),s.config(o.a.raven.driverUrl,o.a.raven.config),c.config(o.a.raven.topDriverUrl,o.a.raven.config),u.config(o.a.raven.validationIntegrationUrl,o.a.raven.config),l(i),l(s),l(c),l(u)},71:function(e,t,r){"use strict";var n=r(38),a=r.n(n),o=r(27),i=r.n(o),s=r(4),c=r(7),u=r(21);let l,d=!1;const m=e=>{chrome.runtime.setUninstallURL(`https://www.${s.a.site.baseDomain}/genie/uninstall?uu=${e}&v=${s.a.extensionVersion}`)};t.a=(()=>l?i.a.resolve(l):new i.a(e=>{chrome.storage.sync.get(u.a,t=>{if(t[u.a])l=t[u.a],m(l),e(l);else{const t="setInstallationUuidEvent";d?document.addEventListener(t,t=>{e(t.detail[u.a])},{once:!0},!1):(d=!0,chrome.storage.local.get(u.a,r=>{const n={};r[u.a]?(n[u.a]=r[u.a],chrome.storage.local.remove(u.a),c.b.captureMessage("Local installation UUID used for resync")):n[u.a]=a.a.randomBase32(),chrome.storage.sync.set(n,()=>{chrome.runtime.lastError&&(c.b.captureException(new Error(chrome.runtime.lastError),{extra:{source:{filePath:"bg/installation-uuid.js",method:"getInstallationUuid.lastError"}}}),((e,t)=>{let r=0;const n=setInterval(()=>{chrome.storage.sync.set(e,()=>{chrome.runtime.lastError?(r+=1)>=t&&(c.b.captureException(new Error("_retrySetSyncStorage: maxRetries exceeded"),{extra:{extra:e}}),clearInterval(n)):(c.b.captureMessage("_retrySetSyncStorage: successfully set",{level:"info",extra:e}),clearInterval(n))})},2e3)})(n,5));const r=new CustomEvent(t,{detail:n});document.dispatchEvent(r),chrome.storage.onChanged.addListener((e,t)=>{"sync"===t&&e[u.a]&&(c.b.captureMessage("Installation UUID resynced",{level:"info",extra:e[u.a]}),l=e[u.a].newValue,m(l))}),l=n[u.a],m(l),e(l)})}))}})}))},80:function(e,t,r){"use strict";var n=r(106),a=r.n(n);let o=()=>{};a.a.enable("*"),o=a()("genie-extension:info"),t.a=o},82:function(e,t,r){"use strict";r(12),r(20);var n=r(366),a=r.n(n),o=r(0),i=r(7),s=r(4);function c(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}const u=s.a.abTesting.cdnUrl,l=s.a.abTesting.activeCampaigns,d={version:"4",rollouts:[],anonymizeIP:!0,projectId:s.a.abTesting.projectId,variables:[],featureFlags:[],experiments:[],audiences:[],groups:[],attributes:[],botFiltering:!1,accountId:"10253911865",events:[],revision:"8"},m={_updatedTime:null,_pending:!1,_optimizelyClientPromiseResolver:()=>{},_optimizelyClientPromiseRejecter:()=>{},_resetClientPromise(){this._optimizelyClientPromiseResolver(this._createClient(d)),this._optimizelyClientPromise=new Promise((e,t)=>{this._optimizelyClientPromiseResolver=e,this._optimizelyClientPromiseRejecter=t})},_initFromRemote(){return this._pending=!0,this._resetClientPromise(),Object(o.log)("fetching optimizely datafile"),fetch(u).then(e=>e.json()).then(e=>(Object(o.log)("fetched updated optimizely datafile",e),this._updatedTime=Date.now(),this._optimizelyClientPromiseResolver(this._createClient(e)),this._pending=!1,this._optimizelyClientPromise)).catch(e=>("Unexpected token < in JSON at position 0"!==e.message&&i.b.captureException(e,{extra:{source:{filePath:"bg/ab-testing.js",method:"_initFromRemote"}}}),this._pending=!1,this._optimizelyClientPromiseResolver(this._createClient(d)),this._optimizelyClientPromise))},_createClient:e=>a.a.createInstance({datafile:e,logger:{log:o.log}}),_getClient(){return!this._pending&&(null===this._updatedTime||Date.now()-this._updatedTime>36e5)?this._initFromRemote():this._optimizelyClientPromise},getVariations(e){var t,r=this;return(t=regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r._getClient();case 2:return n=t.sent,window.testVariations=l.reduce((t,r)=>{const a=n.getVariation(r,e);return a&&t.push({campaign:r,variation:a}),t},[]),t.abrupt("return",window.testVariations);case 5:case"end":return t.stop()}},t)}),function(){var e=this,r=arguments;return new Promise(function(n,a){var o=t.apply(e,r);function i(e){c(o,n,a,i,s,"next",e)}function s(e){c(o,n,a,i,s,"throw",e)}i(void 0)})})()}};m._resetClientPromise(),t.a=m},93:function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"a",function(){return a});r(17),r(113),r(19);const n=new Set(["homedepot.com","target.com","kohls.com","etsy.com","macys.com","sephora.com","dominos.com","doordash.com","jcpenney.com","ulta.com","wish.com","papajohns.com","pizzahut.com","ae.com","forever21.com","dsw.com","walgreens.com","fashionnova.com","barnesandnoble.com","bathandbodyworks.com","sears.com","wayfair.com","shutterfly.com","grubhub.com","officedepot.com","bestbuy.com","shein.com","staples.com","vitacost.com","catherines.com","cvs.com","michaels.com","1800flowers.com","abercrombie.com","adameve.com","advanceautoparts.com","aeropostale.com","anntaylor.com","anthropologie.com","amazon.com","ashleyfurniture.com","asos.com","avenue.com","barnesandnoble.com","biglots.com","boscovs.com","blair.com","blinds.com","bloomingdales.com","blu.com","bodenusa.com","brooksbrothers.com","casper.com","cheapoair.com","chegg.com","chewy.com","containerstore.com","dell.com","dickblick.com","dickssportinggoods.com","dollskill.com","dressbarn.com","eastbay.com","eddiebauer.com","eventbrite.com","eyebuydirect.com","famousfootwear.com","fanatics.com","fingerhut.com","finishline.com","fullbeauty.com","gamestop.com","gnc.com","godaddy.com","guitarcenter.com","harborfreight.com","hertz.com","hm.com","hp.com","hobbylobby.com","horchow.com","hottopic.com","hsn.com","jcrew.com","joann.com","katespade.com","kingsize.com","kmart.com","landsend.com","lastcall.com","lanebryant.com","lenovo.com","levi.com","lifeextension.com","llbean.com","loft.com","lordandtaylor.com","lulus.com","madewell.com","maurices.com","monoprice.com","neimanmarcus.com","newbalance.com","newegg.com","nordstrom.com","norton.com","nyandcompany.com","orientaltrading.com","panerabread.com","papamurphys.com","partycity.com","payless.com","petco.com","pier1.com","prettylittlething.us","puritan.com","ralphlauren.com","quill.com","qvc.com","redbubble.com","rockauto.com","saksoff5th.com","scrubsandbeyond.com","shoes.com","shopdisney.com","sierra.com","skinstore.com","soccer.com","snapfish.com","talbots.com","thredup.com","thriftbooks.com","tillys.com","tjx.com","torrid.com","ubereats.com","uniqlo.com","us.romwe.com","venus.com","verizonwireless.com","victoriassecret.com","vimeo.com","vitaminshoppe.com","walmart.com","way.com","womanwithin.com","zales.com","zazzle.com","zennioptical.com","zoro.com"]);function a(e){return n.has(e)}}});